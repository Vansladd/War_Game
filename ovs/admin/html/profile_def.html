<html>
	<!-- $Id: profile_def.html,v 1.1 2011/10/04 12:41:14 xbourgui Exp $ -->
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
		<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
		<script language="JavaScript">
			var orderArray = [##TP_LOOP idx {[tpGetVar num_active]}####TP_TCL {if {[tpGetVar idx] == 0} {tpBufWrite [tpGetVar idx]} else {tpBufWrite ", [tpGetVar idx]"}}####TP_ENDLOOP##]

			function fs(b,t)
			{
				b.disabled = true;
				b.value = "Busy...";
				b.form.SubmitName.value = t;
				b.form.submit();
				return true;
			}

			function reOrder(b, pos, new_order)
			{
				var old_order = orderArray[pos];

				for (var i = 0; i < orderArray.length; i++) {

					if (orderArray[i] == new_order) {
						orderArray[i] = old_order;
					}
				}
				orderArray[pos] = new_order;

				var cells = b.form.elements;
				var j = 0;
				var k = 0;
				for (var i = 0; i < cells.length; i++) {
					cell = cells[i];
					if (cell.name.match("check_no_") && cell.type == "radio") {
						if (orderArray[j] == k) {
							cell.checked = true;
						} else {
							cell.checked = false;
						}
						k++;
						if (k == orderArray.length) {
							k = 0;
							j++;
						}
					}
				}
			}
		</script>
		##TP_PLAY JS_WriteSelect.html##
	</head>
	<body>
		##TP_PLAY error_rpt.html##
		##TP_PLAY msg_rpt.html##
		<form action="##TP_CGI_URL##" method="post">
			<input type="hidden" name="SubmitName">
			<input type="hidden" name="action"         value="ADMIN::VERIFICATION::DoProfileDef">
			<input type="hidden" name="profile_def_id" value="##TP_profile_def_id##">
			<table cellspacing="0" cellpadding="2" border="0">
				<tr>
					<th colspan="2" class="title">##TP_IF {[tpGetVar new 0]}##Create##TP_ELSE##Edit##TP_ENDIF## Verification Profile: ##TP_desc##</th>
				</tr>
				<tr>
					<td class="caption">Status</td>
					<td>##TP_status##</td>
				</tr>
				<tr>
					<td class="caption">Description (mandatory)</td>
					<td><input name="desc" value="##TP_desc##" size="40" maxlength="80"></td>
				</tr>
				<tr>
					<td class="caption">Code (mandatory)</td>
					<td><input name="code" value="##TP_code##" size="8" ##TP_IF {![op_allowed VrfUpdProfileDef]}## DISABLED ##TP_ENDIF## maxlength="8"></td>
				</tr>
				<tr>
					<td class="caption">Blurb</td>
					<td><textarea name="blurb" cols="40" rows="4">##TP_blurb##</textarea></td>
				</tr>
				##TP_IF {![tpGetVar new 0]}##
				<tr>
					<td class="caption">Creation Date</td>
					<td>##TP_cr_date##</td>
				</tr>
				##TP_ENDIF##
				<tr>
					<td class="caption">Channels</td>
					<td>
					##TP_PLAY chan_sel.html##
					</td>
				</tr>
				##TP_IF {![tpGetVar new 0]}##
				<tr>
					<td class="caption">Countries</td>
					<td>##TP_countries##</td>
				</tr>
				##TP_ENDIF##
				<tr>
					<th colspan="2" class="buttons">
						##TP_IF {[tpGetVar new 0]}##
						<input type="button" value="Create"    onClick="return fs(this,'AddProfile')">
						##TP_ELSE##
						<input type="button" value="Update"    onClick="return fs(this,'UpdProfile')"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
						<input type="button" value="Profile Models" onClick="return fs(this,'PrflModel')"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
						##TP_IF {[tpGetVar status 1]}##
						<input type="button" value="Suspend"   onClick="return fs(this,'SusProfile')">
						##TP_ELSE##
						<input type="button" value="Activate"  onClick="return fs(this,'ActProfile')">
						##TP_ENDIF##
						##TP_ENDIF##
						<input type="button" value="Back"      onClick="return fs(this,'Back')">
					</th>
				</tr>
			</table>
			##TP_IF {![tpGetVar new 0]}##
			<br>

			<table cellspacing="0" cellpadding="2" border="0">
				<tr>
					<th colspan="3" class="title">Verification Actions</th>
				</tr>
				<tr>
					<th class="colhead" colspan="2">Action</th>
					<th class="colhead">Delete</th>
				</tr>
				##TP_IF {[tpGetVar act_count]}##
				##TP_LOOP idx {[tpGetVar act_count]}##
				<tr>
					##TP_IF {[tpGetVar idx] == 0}##
					<td>
						Default then account is
						<input type="hidden" name="high_score_##TP_action_id##" value="">
					</td>
					<td>
						<select name="action_##TP_action_id##"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
							<script>write_select("##TP_action##", "P", "Restricted", "S", "Suspended", "N", "Nothing", "A", "Activated")</script>
						</select>
					</td>
					##TP_ELSE##
					<td>
						If more than
						<input type="text" size="5" maxlength="5" name="high_score_##TP_action_id##" value="##TP_action_score##"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
						then account is
					</td>
					<td>
						<select name="action_##TP_action_id##"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
							<script>write_select("##TP_action##", "P", "Restricted", "S", "Suspended", "N", "Nothing", "A", "Activated")</script>
						</select>
					</td>
					##TP_ENDIF##
					<td>
						<input type="checkbox" name="delete_##TP_action_id##"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
					</td>
				</tr>
				##TP_ENDLOOP##
				##TP_ELSE##
				<tr>
					<td colspan="3">No Actions assigned (default action is do Nothing)</td>
				</tr>
				##TP_ENDIF##
				<tr>
					<th colspan="3" class="buttons">
						<input type="button" value="Add"    onClick="return fs(this,'AddAction')"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
						<input type="button" value="Update" onClick="return fs(this,'UpdAction')"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
					</th>
				</tr>
			</table>

			<table cellspacing="0" cellpadding="2" border="0">
				<tr>
					<th colspan="3" class="title">Verification Exceptions</th>
				</tr>
				<tr>
					<th class="colhead" colspan="2">Action</th>
					<th class="colhead">Delete</th>
				</tr>
				##TP_IF {[tpGetVar ex_act_count]}##
				##TP_LOOP ex_idx {[tpGetVar ex_act_count]}##
				<tr>
					##TP_IF {[tpGetVar idx] == 0}##
					<td>
						Default then account is
						<input type="hidden" name="score_##TP_ex_action_id##" value="">
					</td>
					<td>
						<select name="action_##TP_ex_action_id##"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
							<script>write_select("##TP_ex_action##", "P", "Restricted", "S", "Suspended", "N", "Nothing", "A", "Activated")</script>
						</select>
					</td>
					##TP_ELSE##
					<td>
						If equal to
						<input type="text" size="5" maxlength="5" name="score_##TP_ex_action_id##" value="##TP_ex_action_score##"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##> 
						then account is
					</td>
					<td>
						<select name="action_##TP_ex_action_id##"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
							<script>write_select("##TP_ex_action##", "P", "Restricted", "S", "Suspended", "N", "Nothing", "A", "Activated")</script>
						</select>
					</td>
					##TP_ENDIF##
					<td>
						<input type="checkbox" name="delete_##TP_ex_action_id##"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
					</td>
				</tr>
				##TP_ENDLOOP##
				##TP_ELSE##
				<tr>
					<td colspan="3">No Actions assigned (default action is do Nothing)</td>
				</tr>
				##TP_ENDIF##
				<tr>
					<th colspan="3" class="buttons">
						<input type="button" value="Add"    onClick="return fs(this,'AddExAction')"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
						<input type="button" value="Update" onClick="return fs(this,'UpdExAction')"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
					</th>
				</tr>
			</table>

			<br>
			<table cellspacing="0" cellpadding="2" border="0">
				<tr>
					<th colspan="##TP_TCL {tpBufWrite [expr {[tpGetVar num_active] + 4}]}##" class="title">Verification Checks</th>
				</tr>
				<tr>
					<th class="colhead">Check</th>
					<th class="colhead">Channels</th>
					<th class="colhead" colspan="##TP_num_active##">Check Order</th>
				</tr>
				##TP_IF {[tpGetVar chk_count]}##
				<tr>
					<th class="colhead" colspan="2"></th>
					##TP_LOOP idx {[tpGetVar num_active]}##
					<th class="colhead">##TP_TCL {tpBufWrite [expr {[tpGetVar idx] + 1}]}##</th>
					##TP_ENDLOOP##
				</tr>
				##TP_LOOP idx {[tpGetVar chk_count]}##
				<tr>
					##TP_IF {[tpGetVar status 1]}##
					<td><a href="##TP_CGI_URL##?action=ADMIN::VERIFICATION::GoCheckDef&profile_def_id=##TP_profile_def_id##&check_def_id=##TP_check_def_id##">##TP_check_name##</a></td>
					##TP_ELSE##
					<td>##TP_check_name##</td>
					##TP_ENDIF##
					<td>##TP_check_channels##</td>
					##TP_IF {[tpGetVar idx] < [tpGetVar num_active]}##
					##TP_LOOP idx2 {[tpGetVar num_active]}##
					<td>
						<input type="radio" name="check_no_##TP_check_def_id##" onClick="return reOrder(this, ##TP_TCL {tpBufWrite [tpGetVar idx]}##, ##TP_TCL {tpBufWrite [tpGetVar idx2]}##)" value="##TP_TCL {tpBufWrite [tpGetVar idx2]}##"##TP_IF {[tpGetVar idx] == [tpGetVar idx2]}## checked##TP_ENDIF####TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
					</td>
					##TP_ENDLOOP##
					##TP_ELSE##
					<td colspan="##TP_num_active##">
						<input type="hidden" name="check_no_##TP_check_def_id##" value="##TP_TCL {tpBufWrite [tpGetVar idx]}##">Suspended
					</td>
					##TP_ENDIF##
				</tr>
				##TP_ENDLOOP##
				##TP_ELSE##
				<tr>
					<td colspan="4">No Checks assigned</td>
				</tr>
				##TP_ENDIF##
				<tr>
					<th colspan="##TP_TCL {tpBufWrite [expr {[tpGetVar num_active] + 4}]}##" class="buttons">
						<input type="button" value="Add"    onClick="return fs(this,'AddCheck')"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
						<input type="button" value="Update" onClick="return fs(this,'UpdOrder')"##TP_IF {![tpGetVar status 1]}## disabled##TP_ENDIF##>
					</th>
				</tr>
			</table>
		</form>
		##TP_ENDIF##
	</body>
</html>

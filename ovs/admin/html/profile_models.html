<html>
	<!-- $Id: profile_models.html,v 1.1 2011/10/04 12:41:14 xbourgui Exp $ -->
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
		<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
		<script language="JavaScript">
			function doAudit(audit, b) {
				b.form.AuditInfo.value = audit;
				return fs(b, "GoAudit");
			}


			function fs(b, t)
			{
				b.value = "Busy...";
				b.form.SubmitName.value = t;
				b.form.submit();
				return true;
			}
		</script>
		##TP_PLAY JS_WriteSelect.html##
	</head>
	<body>
		##TP_PLAY error_rpt.html##
		##TP_PLAY msg_rpt.html##


		<form action="##TP_CGI_URL##" method="post">
			<input type="hidden" name="SubmitName">
			<input type="hidden" name="action"         value="ADMIN::VERIFICATION::DoProfileModel">
			<input type="hidden" name="profile_def_id" value="##TP_profile_def_id##">
			<input type="hidden" name="pay_mthd"       value="##TP_cur_pay_mthd##">
			<input type="hidden" name="type"           value="##TP_cur_type##">
			<input type="hidden" name="AuditInfo"      value="">

			<!-- country map -->
			<table cellspacing="0" cellpadding="2" border="0">
				<tr>
					<th colspan="6" class="title">Payment Country Mapping</th>
				</tr>
				<tr>
					<th class="colhead" colspan="6">Payment Method</th>
				</tr>
				<tr>
					<td>
						<select name="payMthd">
							<script>
								write_select("##TP_PayMthd##"
								##TP_LOOP idx {[tpGetVar pay_count]}##
									,"##TP_pay_mthd##", "##TP_desc##"
								##TP_ENDLOOP##
								)
							</script>
						</select>
						<input type="button" onclick="return fs(this,'UpdPmtType')" value="Change Payment Type">
					</td>
				</tr>
				<tr>
					<th class="colhead">Country</th>
					<th class="colhead">Trigger Point</th>
					<th class="colhead">Action</th>
					<th class="colhead">Start Status</th>
					<th class="colhead">Grace</th>
				</tr>
				##TP_IF {[tpGetVar cty_count]}##
				##TP_LOOP idx {[tpGetVar cty_count]}##
				<tr>
					<div id="##TP_cty_code##" class="chkCtyAction">
						<td>##TP_cty_name##</td>
						<td>
							<select onChange='updForm({type:"ID", value:"##TP_cty_code##"})' id="pmt_sort_##TP_cty_code##" name="pmt_sort_##TP_cty_code##">
								<script>write_select("##TP_model_pmt_sort##", "N", "N/A", "D", "Deposit", "W", "Withdrawal")</script>
							</select>
						</td>
						<td>
							<select id="action_##TP_cty_code##" name="action_##TP_cty_code##">
								<script>write_select("##TP_model_action##","C","Check", "S", "Status")</script>
							</select>
						</td>
						<td>
							<select id="status_##TP_cty_code##" name="status_##TP_cty_code##">
								<script>write_select("##TP_model_status##", "P", "Restricted", "A", "Active", "S", "Suspended")</script>
							</select>
						</td>
						<td><input type="text" name="grace_days_##TP_cty_code##" value="##TP_model_grace_days##"/></td>
					</div>
				</tr>
				##TP_ENDLOOP##
				##TP_ELSE##
				<tr>
					<td colspan="3">No Countries assigned</td>
				</tr>
				##TP_ENDIF##
				<tr>
					<th colspan="3" class="buttons">
						<input type="button" value="Update" onClick="return fs(this,'UpdPrflModel')">
						<input type="button" value="Back"   onClick="return fs(this,'Back')">
						<input type="button" value="View Audit History" onClick="return doAudit('VrfPrflModel', this)">
					</th>
				</tr>
			</table>
		</form>
	<script>

		function getElementByClass(theClass) {
			var objs = new Array();

			//Create Array of All HTML Tags
			var all=document.getElementsByTagName("*");

			//Loop through all tags using a for loop
			for (i=0; i<all.length; i++) {
				if (all[i].className==theClass) {
					objs[objs.length] = all[i]
				}
			}

			return objs;
		}

		function updForm(opts) {
			items = new Array();
			if (opts.type == "CLASS") {
				items = getElementByClass(opts.value);
			} else if (opts.type == "ID") {
				items.push(document.getElementById(opts.value));
			}

			for (var ai in items) {
				cty=items[ai].id

				if (document.getElementById("pmt_sort_"+cty).value == "N") {
					document.getElementById("action_"+cty).disabled = true;
					document.getElementById("status_"+cty).disabled = true;
				} else {
					document.getElementById("action_"+cty).disabled = false;
					document.getElementById("status_"+cty).disabled = false;
				}
			}
		}

		updForm({type: "CLASS", value: "chkCtyAction"});
	</script>
	</body>
</html>

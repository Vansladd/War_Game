
<!-- $Id: bf_market.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ -->

<input type=hidden name="MktBFMonitorId" value="##TP_MktBFMonitorId##">

##TP_IF {[tpGetVar ColNam 0]==1}##
	##TP_IF {[tpBindGet MktBFDefMapId] != ""}##
		<th class=colhead style="text-align: center">Betfair<br>Back</th>
		<th class=colhead style="text-align: center">Betfair<br>Lay</th>
		<th class=colhead style="text-align: center">Back<br>Liquidity</th>
		<th class=colhead style="text-align: center">Betfair<br>Price</th>
		<th class=colhead style="text-align: center">Ignore Liquidity Check</th>
		##TP_IF {[op_allowed BFAutoPriceChange] && [OT_CfgGet BF_SELN_APC 0]}##
			<th class=colhead style="text-align: center">Selection APC</th>
			<th class=colhead style="text-align: center">Price Adjustment</th>
		##TP_ENDIF##
		##TP_IF {[op_allowed BFAutoLayBack] && [OT_CfgGet BF_SELN_REDUCE_RISK 0]}##
			<th class=colhead style="text-align: center">Reduce Risk</th>
		##TP_ENDIF##
		##TP_IF {[op_allowed BFAutoLayBack] && [OT_CfgGet BF_SELN_AUTO_LAY 0]}##
			<th class=colhead style="text-align: center">Auto Lay</th>
		##TP_ENDIF##
	##TP_ENDIF##
	##TP_TCL {tpSetVar ColNam 0}##
##TP_ENDIF##

##TP_IF {[tpGetVar BfMktDep 0]==1}##
	##TP_IF {[tpBindGet MktBFDefMapId] != ""}##
		<td><a href='javascript:go_bf_mkt_depth_popup(##TP_BFExchId##, ##TP_BFEvMktId##, ##TP_BFEvOcId##, ##TP_BFAsianId##, "##TP_OcDesc##")'>##TP_BFBack##</a></td>
		<td><a href='javascript:go_bf_mkt_depth_popup(##TP_BFExchId##, ##TP_BFEvMktId##, ##TP_BFEvOcId##, ##TP_BFAsianId##, "##TP_OcDesc##")'>##TP_BFLay##</a></td>
		<td>##TP_BFBackLiquid##</td>
		<td>##TP_BFPrice##</td>
		##TP_IF {[tpBindGet BFOcMapId] != ""}##
			<td colspan=1><input type=checkbox id="BFLiquidity_##TP_OcId##" ##TP_BFLiquidityChecked##></td>
			##TP_IF {[op_allowed BFAutoPriceChange] && [OT_CfgGet BF_SELN_APC 0]}##
			<td colspan=1>
				<select name="BFOCAPC_##TP_OcId##">
					<option value="-">Unset</option>
					<script>
						write_select('##TP_BFOCAPC##','Y','Yes','N','No')
					</script>
				</select>
			</td>
			<td colspan=1>
				<select name="BFOCPrcAdjFac_##TP_OcId##">
					<option value="">Unset</option>
					<script>
						write_select_margin('##TP_BFOCPrcAdjFac##')
					</script>
				</select>
			</td>
			##TP_ELSE##
			<input type=hidden name="BFOCAPC_##TP_OcId##" value="##TP_BFOCAPC##">
			<input type=hidden name="BFOCPrcAdjFac_##TP_OcId##" value="##TP_BFOCPrcAdjFac##">
			##TP_ENDIF##
			##TP_IF {[op_allowed BFAutoLayBack] && [OT_CfgGet BF_SELN_REDUCE_RISK 0]}##
			<td colspan=1>
				<select name="BFOCReduceRisk_##TP_OcId##">
						<option value="-">Unset</option>
						<script>
							write_select('##TP_BFOCReduceRisk##','Y','Yes','N','No')
						</script>
				</select>
			</td>
			##TP_ELSE##
				<input type=hidden name="BFOCReduceRisk_##TP_OcId##" value="##TP_BFOCReduceRisk##">
			##TP_ENDIF##
			##TP_IF {[op_allowed BFAutoLayBack] && [OT_CfgGet BF_SELN_AUTO_LAY 0]}##
			<td colspan=1>
				<select name="BFOCAutoLay_##TP_OcId##">
						<option value="-">Unset</option>
						<script>
							write_select('##TP_BFOCAutoLay##','Y','Yes','N','No')
						</script>
				</select>
			</td>
			##TP_ELSE##
				<input type=hidden name="BFOCAutoLay_##TP_OcId##" value="##TP_BFOCAutoLay##">
			##TP_ENDIF##
			<input type=hidden name="old_BFOCPrcAdjFac_##TP_OcId##" value="##TP_BFOCPrcAdjFac##">
			<input type=hidden name="old_BFOCAPC_##TP_OcId##" value="##TP_BFOCAPC##">
			<input type=hidden name="BFLiquidityVal_##TP_OcId##" id="BFLiquidityVal_##TP_OcId##" value="">
			<input type=hidden name="old_BFLiquidityVal_##TP_OcId##" value="##TP_BFLiquidity##">
			<input type=hidden name="BFOCEvItemsId_##TP_OcId##" value="##TP_BFOCEvItemsId##">
			<input type=hidden name="old_BFOCReduceRisk_##TP_OcId##" value="##TP_BFOCReduceRisk##">
			<input type=hidden name="old_BFOCAutoLay_##TP_OcId##" value="##TP_BFOCAutoLay##">
		##TP_ELSE##
			<td/>
			##TP_IF {[op_allowed BFAutoPriceChange] && [OT_CfgGet BF_SELN_APC 0]}##<td/><td/>##TP_ENDIF##
			##TP_IF {[op_allowed BFAutoLayBack] && [OT_CfgGet BF_SELN_REDUCE_RISK 0]}##<td/>##TP_ENDIF##
			##TP_IF {[op_allowed BFAutoLayBack] && [OT_CfgGet BF_SELN_AUTO_LAY 0]}##<td/>##TP_ENDIF##
		##TP_ENDIF##
	##TP_ENDIF##
	##TP_TCL {tpSetVar BfMktDep 0}##
##TP_ENDIF##


##TP_IF {[tpGetVar BfMktMap 0]==1}##
	##TP_IF {[tpBindGet MktBFDefMapId] != ""}##
		<td class=ra><b>##TP_BFMktMargin##%</b></td>
		<td>&nbsp;</td>
		<td>&nbsp;</td>
	##TP_ENDIF##
    ##TP_TCL {tpSetVar BfMktMap 0}##
##TP_ENDIF##

##TP_IF {[tpGetVar ColNamOrd 0]==1}##
	##TP_IF {[tpBindGet MktBFDefMapId] != ""}##
		<th class=colhead style="text-align: center">Betfair<br>Back</th>
		<th class=colhead style="text-align: center">Betfair<br>Lay</th>
	##TP_ENDIF##
    ##TP_TCL {tpSetVar ColNamOrd 0}##
##TP_ENDIF##

##TP_IF {[tpGetVar BtnOrd 0]==1}##
	##TP_IF {[tpBindGet MktBFDefMapId] != ""}##
		##TP_IF {[tpBindGet BFEvOcId] != ""}##
			<td><input type=button value="Back" onClick="return go_bf_place_order('##TP_OcId##', '##TP_BFJSOcDesc##', '##TP_BFExchId##', '##TP_BFEvMktId##', '##TP_BFEvOcId##', '##TP_BFAsianId##', 'B' ,##TP_ClassId##)"></td>
			<td><input type=button value="Lay" onClick="return go_bf_place_order('##TP_OcId##', '##TP_BFJSOcDesc##', '##TP_BFExchId##', '##TP_BFEvMktId##', '##TP_BFEvOcId##', '##TP_BFAsianId##', 'L' ,##TP_ClassId##)"></td>
		##TP_ELSE##
			<td colspan="2">Unmapped</td>
		##TP_ENDIF##
	##TP_ENDIF##
	##TP_TCL {tpSetVar BtnOrd 0}##
##TP_ENDIF##

##TP_IF {[tpGetVar BtnBFLiq 0]==1 || [tpGetVar BtnOCAPC 0]==1 || [tpGetVar BtnOCAuto 0]==1}##
	##TP_IF {[tpBindGet MktBFDefMapId] != ""}##
		&nbsp;&nbsp;&nbsp;
		<input type=button class="btn_def" value="Update BF Seln Info" onClick="return bf_upd_seln(this)">
		<input type=hidden name="EvMkt" value="##TP_MktId##">
	##TP_ENDIF##
	##TP_TCL {tpSetVar BtnBFLiq 0}##
##TP_ENDIF##

##TP_IF {[tpGetVar OrdDet 0]==1}##
	##TP_IF {[tpBindGet MktBFDefMapId] != "" }##
		##TP_IF {[tpBindGet BFNumOrdersT] != ""}##
		<td colspan=8>##TP_OcDesc## - Number of Betfair Orders: (<a href="javascript:go_bf_orders_popup('##TP_OcId##')">##TP_BFNumOrdersT##</a>) (##TP_IF {[tpBindGet BFNumOrdersB] != ""}##Back Orders: ##TP_BFNumOrdersB## ##TP_ENDIF####TP_IF {[tpBindGet BFNumOrdersL] != ""}##Lay Orders: ##TP_BFNumOrdersL####TP_ENDIF##)</td>
		##TP_ELSE##
		<td colspan=8>No Betfair Orders</td>
		##TP_ENDIF##
	##TP_ENDIF##
	##TP_TCL {tpSetVar OrdDet 0}##
##TP_ENDIF##

##TP_IF {[tpGetVar Ord 0]==1}##
	##TP_IF {[tpBindGet MktBFDefMapId] != ""}##
		<td>&nbsp;</td>
		<td>&nbsp;</td>
	##TP_ENDIF##
##TP_TCL {tpSetVar Ord 0}##
##TP_ENDIF##


##TP_IF {[tpGetVar BfMoni 0]==1}##

	<input type=hidden name="BFMapId" value="##TP_MktBFDefMapId##">
	<input type=hidden name="hidden_BFEvItemsId" value="##TP_MktBFDefEvItemsId##">

 	<!-- Betfair monitor info -->
	<tr>
		<td class=caption>Betfair Monitor</td>
		<td>
			<select name="BFMonStatus">
				<script>
						write_select('##TP_MktBFStatus##','S','Suspended','A','Active');
				</script>
			</select>
			&nbsp;
			<b>Poll Freq</b>
			<select name="BFPollTime">
				<script>
					write_select('##TP_MktBFPollTime##','5000','5 Seconds',
												'15000','15 Seconds',
												'30000','30 Seconds',
												'60000','1 Minute',
												'300000','5 Minutes',
												'600000','10 Minutes',
												'1800000','30 Minutes')
				</script>
			</select>
		</td>
  </tr>

 <!-- Betfair market match -->
 <tr>
		<td class=caption>Betfair Market Match</td>
		<td>
			##TP_IF {[OT_CfgGet BF_MANUAL_MATCH 0] && [op_allowed BFMatch]}##
				<select name="BFEvItemsId">
					<option value="">Unmatched</option>
					<script>
						write_select('##TP_MktBFDefEvItemsId##'
							##TP_LOOP bf_mkt_idx {[tpGetVar BFNumMkts 0]}##
							,"##TP_BFMktIds##","##TP_BFMktDesc##"
							##TP_ENDLOOP##
						);
					</script>
				</select>
			##TP_ELSE##
				##TP_IF {[tpBindGet MktBFDefMapId] == ""}## - ##TP_ELSE ## ##TP_MktBFDefDesc## ##TP_ENDIF##
				 <input type=hidden name="BFEvItemsId" value="##TP_MktBFDefEvItemsId##">
			##TP_ENDIF##
		</td>
  </tr>

  <!-- Betfair price/polling logic -->
  ##TP_IF {[op_allowed BFAutoPriceChange]}##
	<tr>
		<td class=caption>Betfair Price</td>
		<td>
			<b>APC</b>
				<select name="BFAutoPrcChng">
					<option value="-">Unset</option>
					<script>
						write_select('##TP_MktBFAutoPrcChng##','Y','Yes','N','No')
					</script>
				</select>
			&nbsp;
			<b>Price Adjustment</b>
			<select name="BFPriceAdjFac">
				<option value="">Unset</option>
				<script>
					write_select_margin('##TP_MktBFPrcAdjFac##');
				</script>
			</select>
			##TP_IF {[tpGetVar NumSelns 0]==3}##
				&nbsp;
				<b>3 Runner Market Book %</b>
				<select name="BFMktBKPer">
					<option value="-">Unset</option>
					<script>
							write_select('##TP_MktBFMktBKPer##',
														'100','100%',
														'101','101%',
														'102','102%',
														'103','103%',
														'104','104%',
														'105','105%',
														'106','106%',
														'107','107%',
														'108','108%',
														'109','109%',
														'110','110%',
														'111','111%',
														'112','112%',
														'113','113%',
														'114','114%',
														'115','115%',
														'116','116%',
														'117','117%',
														'118','118%',
														'119','119%',
														'120','120%',
														'121','121%',
														'122','122%',
														'123','123%',
														'124','124%',
														'125','125%',
														'126','126%',
														'127','127%',
														'128','128%',
														'129','129%',
														'130','130%',
														'131','131%',
														'132','132%',
														'133','133%',
														'134','134%',
														'135','135%',
														'136','136%',
														'137','137%',
														'138','138%',
														'139','139%',
														'140','140%',
														'141','141%',
														'142','142%',
														'143','143%',
														'144','144%',
														'145','145%',
														'146','146%',
														'147','147%',
														'148','148%',
														'149','149%',
														'150','150%',
														'151','151%',
														'152','152%',
														'153','153%',
														'154','154%',
														'155','155%',
														'156','156%',
														'157','157%',
														'158','158%',
														'159','159%',
														'160','160%',
														'161','161%',
														'162','162%',
														'163','163%',
														'164','164%',
														'165','165%',
														'166','166%',
														'167','167%',
														'168','168%',
														'169','169%',
														'170','170%',
														'171','171%',
														'172','172%',
														'173','173%',
														'174','174%',
														'175','175%',
														'176','176%',
														'177','177%',
														'178','178%',
														'179','179%',
														'180','180%',
														'181','181%',
														'182','182%',
														'183','183%',
														'184','184%',
														'185','185%',
														'186','186%',
														'187','187%',
														'188','188%',
														'189','189%',
														'190','190%',
														'191','191%',
														'192','192%',
														'193','193%',
														'194','194%',
														'195','195%',
														'196','196%',
														'197','197%',
														'198','198%',
														'199','199%',
														'200','200%')
							</script>
				</select>
			##TP_ELSE##
				<input type=hidden name="BFMktBKPer" value="##TP_MktBFMktBKPer##">
			##TP_ENDIF##
		</td>
	</tr>
	##TP_ELSE##
		<input type=hidden name="BFAutoPrcChng" value="##TP_MktBFAutoPrcChng##">
		<input type=hidden name="BFPriceAdjFac" value="##TP_MktBFPrcAdjFac##">
		<input type=hidden name="OriginalBFAutoLay" value="##TP_MktBFAutoLay##">
		<input type=hidden name="BFMktBKPer" value="##TP_MktBFMktBKPer##">
	##TP_ENDIF##

	<!-- Betfair auto risk/lay/passthrough -->
	##TP_IF {[op_allowed BFAutoLayBack]}##
	<tr>
		<td class=caption>
			Betfair Auto Place Order
		</td>
		<td>
			##TP_IF {[op_allowed BFAutoLayBack]}##
				<b>Reduce Risk</b>
				<select name="BFReduceRisk">
					<option value="-">Unset</option>
					<script>
						write_select('##TP_MktBFReduceRisk##','Y','Yes','N','No')
					</script>
				</select>
			##TP_ELSE##
				<input type=hidden name="BFReduceRisk" value="##TP_MktBFReduceRisk##">
			##TP_ENDIF##

			##TP_IF {[op_allowed BFAutoLayBack] && [OT_CfgGet BF_AUTO_LAY]}##
				&nbsp;
				<b>Auto Lay</b>
				<select name="BFAutoLay">
					<option value="-">Unset</option>
					<script>
						write_select('##TP_MktBFAutoLay##','Y','Yes','N','No')
					</script>
				</select>
				(Set to N will cancel all Auto-Layed orders on market)
			##TP_ELSE##
				<input type=hidden name="BFAutoLay" value="##TP_MktBFAutoLay##">
			##TP_ENDIF##
		</td>
	</tr>
	##TP_ELSE##
		<input type=hidden name="BFReduceRisk" value="##TP_MktBFReduceRisk##">
		<input type=hidden name="BFAutoLay" value="##TP_MktBFAutoLay##">
	##TP_ENDIF##

	<!-- Betfair auto risk/lay/passthrough -->
	##TP_IF {[op_allowed BFAutoPassThru] && [OT_CfgGet BF_AUTO_PASSTHRU]}##
	<tr>
		<td class=caption>
			Betfair Auto Order Pass
		</td>
		<td>
			##TP_IF {[op_allowed BFAutoPassThru] && [OT_CfgGet BF_AUTO_PASSTHRU]}##
				<select name="BFAutoPass">
					<option value="-">Unset</option>
					<script>
						write_select('##TP_MktBFAutoPass##','Y','Yes','N','No')
					</script>
				</select>
			##TP_ELSE##
				<input type=hidden name="BFAutoPass" value="##TP_MktBFAutoPass##">
			##TP_ENDIF##
		</td>
	</tr>
	##TP_ELSE##
		<input type=hidden name="BFAutoPass" value="##TP_MktBFAutoPass##">
	##TP_ENDIF##


 <!-- Betfair other fields -->
  <tr>
		<td class=caption>Minimum Back Liquidity per Selection</td>
		<td><input type=text name="BFMinVWAPVol" value="##TP_MktBFMinVWAPVol##"></td>
  </tr>
	<tr>
		<td class=caption>In-Running Market Activation Delay</td>
			<td>
				<select name="BFMktBIRDelay">
					<script>
						write_select('##TP_MktBFBIRDelay##',
												'0','0s',
												'10','10s',
												'20','20s',
												'30','30s',
												'40','40s',
												'50','50s',
												'60','60s',
												'70','70s',
												'80','80s',
												'90','90s',
												'100','100s')
					</script>
				</select>
			</td>
	</tr>

##TP_TCL {tpSetVar BfMoni 0}##
##TP_ENDIF##

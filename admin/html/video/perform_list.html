<html>
<!-- $Header: /cvsroot-openbet/training/admin/html/video/perform_list.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>OpenBet Administration</title>

<script type="text/javascript" src="##TP_OFFICE_STATIC_URL##/js/base.js"></script>

<script>

var mapWindow = "";
document.performIndex = "";

##TP_PLAY dynamic_text.js##


function tr_class(map_status) {
	if (map_status == 'Y') {
		document.write('<tr class=active>');
	} else {
		document.write('<tr class=suspended>');
	}
}

function fs(b,t) {
	switch (b.form.perftype.value) {
		case (b.form.perftype.value = "PERFORM") :
			switch (t) {
				case (t = "Back"):
					b.form.action.value="ADMIN::PERFORM::GoMapPerformStreams";
					break
				case (t = "Map"):
					b.form.action.value="ADMIN::PERFORM::DoMapStreamRequest";
					break
				case (t = "Delete"):
					b.form.action.value="ADMIN::PERFORM::DoDeleteStreamRequest";
					if (confirm("Are you sure you wish to DELETE these mappings?") == 0) {
						return;
					}
					break
				case (t = ""):
					break
			}
			break
		case (b.form.perftype.value = "PERFVOD") :
			switch (t) {
				case (t = "Back"):
					b.form.action.value="ADMIN::PERFORM::GoMapPerformStreams";
					break
				case (t = "Map"):
					b.form.action.value="ADMIN::PERFORM::DoMapStreamRequest";
					break
				case (t = "Delete"):
					b.form.action.value="ADMIN::PERFORM::DoDeleteStreamRequest";
					if (confirm("Are you sure you wish to DELETE these mappings?") == 0) {
						return;
					}
					break
				case (t = ""):
					break
			}
			break
	}

	b.disabled = true;
	b.value = "Busy...";
	b.form.SubmitName.value=t;
	b.form.submit();
	return true;
}

function mapPopup(performId) {
	document.performIndex = performId;
	mapWindow = window.open("##TP_CGI_URL##?action=ADMIN::POPUP_DD::GoDD&selectable_levels=EVENT",
		"popup",
		"toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,height=600,width=600");
	mapWindow.focus();
}

function set_vals(level, id, name) {

	var index = document.performIndex;

	eval("document.performForm.MAP_LEVEL_"+index).value = level;
	eval("document.performForm.MAP_NAME_"+index).value  = name;


	//eval("document.performForm.MAP_ID_"+index).value    = id;
	var l = eval("document.performForm.MAP_ID_"+index).value;

	if (l == '') {
		eval("document.performForm.MAP_ID_"+index).value = id;
	}
	else {
		eval("document.performForm.MAP_ID_"+index).value = l + '|' + id;
	}

	changeHTML("LINK_TEXT_"+index,"Add Mapping");
	//changeHTML("LINK_INFO_"+index,"Set Mapping");

	var _n = getObject("LINK_INFO_"+index),
		_o = getNodeText(_n),
		_t = _o + '  ***' + name + '***  ';
	addText(_n, _t , 1);

	return true;
}

</script>
</head>
<body>
##TP_PLAY msg_rpt.html##
##TP_PLAY error_rpt.html##
<form name="performForm" method="post" action="##TP_CGI_URL##">
<input type="hidden" name="SubmitName" value="" />
<input type="hidden" name="action"     value="" />
<input type="hidden" name="days"       value="##TP_days##" />
<input type="hidden" name="dateEnd"    value="##TP_dateEnd##" />
<input type="hidden" name="dateStart"  value="##TP_dateStart##" />
<input type="hidden" name="dateRange"  value="##TP_dateRange##" />
<input type="hidden" name="dateType"   value="##TP_dateType##" />
<input type="hidden" name="mapped"     value="##TP_mapped##" />
<input type="hidden" name="perftype"   value="##TP_perftype##" />


<table cellspacing="0" cellpadding="2" border="0" width="100%">
<tr><th colspan="10" class="title">Perform Video Stream Mapping</th></tr>
<tr>
	<th class="colhead">Perform ID</th>
	<th class="colhead">Content ID</th>
	<th class="colhead">Start Time</th>
	<th class="colhead">End Time</th>
	<th class="colhead">Description</th>
	##TP_IF {[tpGetVar hide_chargable] != 1}##
		<th class="colhead">Chargeable?</th>
	##TP_ENDIF##
	##TP_IF {[tpGetVar hide_blocked_countries] != 1}##
	<th class="colhead">Blocked Country Codes</th>
	##TP_ENDIF##
	<th class="colhead">Openbet Event</th>
	<th class="colhead">&nbsp;</th>
	<th class="colhead">Delete Mapping</th>
</tr>
##TP_IF {$PERFORM(nrows) > 0}##
	##TP_LOOP perform_idx $PERFORM(nrows)##

		<!-- ##TP_MAP_STATUS## -->

		##TP_IF {[reqGetArg mapped] == "Y" && [tpBindGet MAP_STATUS] != "Y"}##
			##TP_CONTINUE##
		##TP_ENDIF##

		##TP_IF {[reqGetArg mapped] == "N" && [tpBindGet MAP_STATUS] == "Y"}##
			##TP_CONTINUE##
		##TP_ENDIF##

		<input type="hidden" name="MAP_LEVEL_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"           value="" />
		<input type="hidden" name="MAP_NAME_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"            value="" />
		<input type="hidden" name="MAP_ID_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"              value="" />
		<input type="hidden" name="PERFORM_ID_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"          value="##TP_ID##" />
		<input type="hidden" name="SUB_PROVIDER_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"        value="##TP_SUBPROVIDER##" />
		<input type="hidden" name="CONTENTTYPEID_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"       value="##TP_CONTENTTYPEID##" />
		<input type="hidden" name="STARTDATETIME_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"       value="##TP_STARTDATETIME##" />
		<input type="hidden" name="ENDDATETIME_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"         value="##TP_ENDDATETIME##" />
		<input type="hidden" name="DESCRIPTION_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"         value="##TP_DESCRIPTION##" />
		<input type="hidden" name="CHARGEABLE_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"          value="##TP_CHARGEABLE##" />
		<input type="hidden" name="BLOCKEDCOUNTRYCODES_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##" value="##TP_BLOCKEDCOUNTRYCODES##" />
		<input type="hidden" name="STARTSEC3_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##" value="##TP_STARTSEC3##" />
		<input type="hidden" name="ENDSEC3_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##" value="##TP_ENDSEC3##" />
		<input type="hidden" name="STARTSEC4_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##" value="##TP_STARTSEC4##" />
		<input type="hidden" name="ENDSEC4_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##" value="##TP_ENDSEC4##" />
		<input type="hidden" name="EXTERNALPATH3_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##" value="##TP_EXTERNALPATH3##" />
		<input type="hidden" name="EXTERNALPATH4_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##" value="##TP_EXTERNALPATH4##" />
		<input type="hidden" name="DELETE_ID_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"           value="##TP_CONTENT_LINK_ID##" />
		<script>tr_class ('##TP_MAP_STATUS##')</script>
		<td>##TP_ID##</td>
		<td>##TP_CONTENTTYPEID##</td>
		<td>##TP_STARTDATETIME##</td>
		<td>##TP_ENDDATETIME##</td>
		<td title="##TP_DESCRIPTION##">##TP_SHORT_DESC##</td>
		##TP_IF {[tpGetVar hide_chargable] != 1}##
			<td>##TP_CHARGEABLE##</td>
		##TP_ENDIF##
		##TP_IF {[tpGetVar hide_blocked_countries] != 1}##
			<td title="##TP_BLOCKEDCOUNTRYCODES##">##TP_SHORTBLKDCNTRYS##</td>
		##TP_ENDIF##
		##TP_IF {$PERFORM([tpGetVar perform_idx],map_status) == "Y" && $PERFORM([tpGetVar perform_idx],ob_event_desc) != ""}##
			<td>##TP_OB_TYPE_NAME##&nbsp;<a href="##TP_CGI_URL##?action=ADMIN::##TP_OB_LINK##">##TP_OB_EVENT_DESC##</a></td>
			<td>
				<a href="javascript:mapPopup(##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##);"><span id="LINK_TEXT_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##">Map Event</span></a>
				<span class="newsInfobold" id="LINK_INFO_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"></span>
			</td>
			<td align="center"><input type="checkbox" name="DELETE_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"></td>
		##TP_ELSE##
			<td width="200">
				<a href="javascript:mapPopup(##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##);"><span id="LINK_TEXT_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##">Map Event</span></a>
				<span class="newsInfobold" id="LINK_INFO_##TP_TCL {tpBufWrite [tpGetVar perform_idx]}##"></span>
			</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		##TP_ENDIF##
		</tr>
	##TP_ENDLOOP##
##TP_ELSE##
	<tr><td colspan="9">No events matched the search criteria.</td></tr>
##TP_ENDIF##
<tr>
	<th class="buttons" colspan="9">
		<input type="button" value="Back"            onClick="return fs(this,'Back')">
		<input type="button" value="Delete Mappings" onClick="return fs(this,'Delete')">
		<input type="button" value="Set Mappings"    onClick="return fs(this,'Map')">
	</th>
</tr>
</table>
</form>
</body>
</html>

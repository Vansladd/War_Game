<html>
<!-- $Id: teamplayer.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>Select player ...</title>
<script type="text/javascript" language="JavaScript">
<!--

self.focus();

var players = new Array();

##TP_LOOP c_idx {$PLAYERS(nrows)}##
players[##TP_TCL {tpBufWrite [tpGetVar c_idx]}##] = new Array("##TP_teamPlayerID##", "##TP_playerTeamCode##", "##TP_playerFirstName##", "##TP_playerLastName##", "##TP_playerSide##");##TP_ENDLOOP##

function listPlayers() {
	for(var i = 0; i < players.length; i++)
	{
		if(players[i][2] != "") {
			playerName = players[i][2] + " " + players[i][3];
		}
		else {
			playerName = players[i][3];
		}
		option = new Option(players[i][1] + " | " + playerName, players[i][0]);
		document.player.playerList.options[i] = option;
	}
	document.player.playerList.selectedIndex = 0;
	document.player.playerList.focus();
}

function myApply() {
	index = document.player.playerList.selectedIndex;

	if(players[index][2] != "") {
		playerName = players[index][2] + " " + players[index][3];
	}
	else {
		playerName = players[index][3];
	}
    opener.document.DoSel.OcDesc.value = playerName;
    opener.document.DoSel.OcExtId.value = players[index][0];

	selList = opener.document.DoSel.OcFlag;
	for(i = 0; i < selList.length; i++) {
		if(selList.options[i].value == players[index][4]) {
			selList.selectedIndex = i;
			break;
		}
	}
	self.close();
}

function myCancel() {
	self.close();
}

//-->
</script>
</head>
<body onload="listPlayers()">
<form name="player" action="##TP_CGI_URL##" method=get>
<center>
<table border="0" cellpadding="3" cellspacing="0" width="100%" height="100%">
<tr>
	<th class="title">
	Players
	</th>
</tr>
<tr>
	<td valign="top" align="center">
	<select width="240" size="12" name="playerList" ondblclick="myApply()">
	</select>
	</td>
</tr>
<tr>
	<td align="center">
	<input type="button" class="btn_def" value="Apply" onclick="myApply()">&nbsp;&nbsp;
	<input type="button" class="btn_def" value="Cancel" onclick="myCancel()">
	</td>
</tr>
</table>
</center>
</form>

</body>
</html>

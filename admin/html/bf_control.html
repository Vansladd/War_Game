<html>
<!-- $Id: bf_control.html,v 1.1.1.1 2011/10/04 10:54:25 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>Betfair Control Information</title>
##TP_PLAY JS_WriteSelect.html##
<script language=JavaScript>

var errorList = "";

function add_err(e_str)
{
  if (errorList.length > 0) {
    errorList += "\n";
  }
  errorList += e_str;
}

function fs(b,t)
{

	b.disabled = true;
	b.value = "Busy...";
	b.form.SubmitName.value=t;
	b.form.submit();
	return true;
}

function write_select_n(sel, n, d)
{
	var i;
	var j;

	for (i = 0; i <= n; i++) {
		j = i/d;
		if (j == sel) {
		  document.writeln
			('<option value="' + j + '" selected>' + j + '</option>');
		} else {
		  document.writeln
			('<option value="' + j + '">' + j + '</option>');
		}
	}
}

</script>

</head>
<body>
##TP_PLAY error_rpt.html##
##TP_IF {[tpGetVar BFControlUpd 0]}##
        <h3><font color=green>Betfair Control Information Updated</font></h3>
##TP_ENDIF##
<table border=0 cellspacing=0 cellpadding=3>
<form action="##TP_CGI_URL##" method=get>
<tr>
  <th colspan=2 class=title>
  Betfair Control Information
  </th>
</tr>

<tr>
	<td class=caption>Allow Price Daemon</td>
	<td>
	<select name="APCAllowed">
	<script>
	write_select('##TP_APCAllowed##', 'Y','Yes','N','No')
	</script>
	</select>
	</td>
</tr>
<tr>
	<td class=caption>Price Daemon Timeout Action</td>
	<td>
	<select name="PriceTimeoutSuspend">
	<script>
	write_select('##TP_PriceTimeoutSuspend##', 'Y','Suspend Market','N','Leave Market Active')
	</script>
	</select>
	</td>
</tr>
<tr>
	<td class=caption>Allow Feed Daemon Data Pull Mode</td>
	<td>
	<select name="FeedAllowed">
	<script>
	write_select('##TP_FeedAllowed##','Y','Yes','N','No')
	</script>
	</select>
	</td>
</tr>
<tr>
  <td class=caption>Allow Order Daemon</td>
  <td>
  <select name="OrderAllowed">
  <script>
  write_select('##TP_OrderAllowed##','Y','Yes','N','No')
  </script>
  </select>
  </td>
</tr>
<tr>
  <td class=caption>Allow Settler Daemon</td>
  <td>
  <select name="StlAllowed">
  <script>
  write_select('##TP_StlAllowed##','Y','Yes','N','No')
  </script>
  </select>
  </td>
</tr>
<tr>
  <td class=caption>Allow Risk Daemon (Auto Back)</td>
  <td>
  <select name="RiskAllowed">
  <script>
  write_select('##TP_RiskAllowed##','Y','Yes','N','No')
  </script>
  </select>
  </td>
</tr>
<tr>
  <td class=caption>Allow Hierarchy Cleanser</td>
  <td>
  <select name="CleanserAllowed">
  <script>
  write_select('##TP_CleanserAllowed##','Y','Yes','N','No')
  </script>
  </select>
  </td>
</tr>
##TP_IF {[OT_CfgGet BF_AUTO_LAY 0] ==1}##
	<tr>
		<td class=caption>Allow Trade Daemon (Auto Lay)</td>
		<td>
		<select name="TradeAllowed">
		<script>
		write_select('##TP_TradeAllowed##', 'Y','Yes','N','No')
		</script>
		</select>
		</td>
	</tr>
	<tr>
		<td class=caption>Trading Scale (Auto Lay)</td>
		<td>
		<select name="OrderScale">
		<script>
		write_select_n('##TP_OrderScale##', 100, 100)
		</script>
		</select>
		</td>
	</tr>
	<tr>
		<td class=caption>Trading Liability Market Pct (Auto Lay)</td>
		<td>
		<select name="TradeLiabPct">
		<script>
		write_select_n('##TP_TradeLiabPct##', 100, 1)
		</script>
		</select>
		</td>
	</tr>
##TP_ELSE##
	<input type=hidden name="OrderScale" value="##TP_OrderScale##">
	<input type=hidden name="TradeAllowed" value="##TP_TradeAllowed##">
	<input type=hidden name="TradeLiabPct" value="##TP_TradeLiabPct##">
##TP_ENDIF##

##TP_IF {[OT_CfgGet BF_SHOW_APC_RUNNERS_DEDUCTION 0] ==1}##
<tr>
  <td class=caption>Auto Price Change Deduction 2 Runners</td>
  <td>
  <select name="PriceAdjFac2">
  <script>
  write_select('##TP_PriceAdjFac2##','10','10%','20','20%')
  </script>
  </select>
  </td>
</tr>
<tr>
  <td class=caption>Auto Price Change Deduction 3 Runners</td>
  <td>
  <select name="PriceAdjFac3">
  <script>
  write_select('##TP_PriceAdjFac3##','10','10%','20','20%')
  </script>
  </select>
  </td>
</tr>
<tr>
  <td class=caption>Auto Price Change Deduction 4+ Runners</td>
  <td>
  <select name="PriceAdjFacN">
  <script>
  write_select('##TP_PriceAdjFacN##','15','15%','20','20%')
  </script>
  </select>
  </td>
</tr>
##TP_ELSE##
	<input type=hidden name="PriceAdjFac2" value="##TP_PriceAdjFac2##">
	<input type=hidden name="PriceAdjFac3" value="##TP_PriceAdjFac3##">
	<input type=hidden name="PriceAdjFacN" value="##TP_PriceAdjFacN##">
##TP_ENDIF##

<tr>
  <td class=caption>Betfair Price Change Threshold</td>
  <td>
  <select name="PriceChngThold">
  <script>
  write_select_n('##TP_PriceChngThold##', 100, 100)
  </script>
  </select>
  </td>
</tr>
<tr>
	<td class=caption>Minimum Percentage Change for OpenBet prices</td>
	<td>
	<select name="PriceMinChange">
	<script>
	write_select_n('##TP_PriceMinChange##', 100, 10)
	</script>
	</select>
	</td>
</tr>
##TP_IF {[OT_CfgGet BF_AUTO_PASSTHRU N] == Y}##
	<tr>
		<td class=caption>Passthrough Liquidity Percentage</td>
		<td>
		<select name="PassLiquidity">
		<script>
		write_select_n('##TP_PassLiquidity##', 100, 1)
		</script>
		</select>
		</td>
	</tr>
	<tr>
		<td class=caption>Orders Pass Threshold</td>
		<td>
		<select name="OrderThold">
		<script>
		write_select_n('##TP_OrderThold##', 100, 100)
		</script>
		</select>
		</td>
	</tr>
##TP_ELSE##
	<input type=hidden name="PassLiquidity" value="##TP_PassLiquidity##">
	<input type=hidden name="OrderThold" value="##TP_OrderThold##">
##TP_ENDIF##
<tr>
  <td class=caption>Global Betfair Account</td>
  <td>
  ##TP_IF {[op_allowed BFEditBFAccount]}##
	  <select name= "Global_BF_Account">
		##TP_LOOP bf_acct_idx {[tpGetVar AcctRows]}##
			##TP_IF {[tpBindGet status] == "A"}##
				<option value = "##TP_id##" ##TP_IF {[tpBindGet GlobalBFAcctId] == [tpBindGet id]}## selected ##TP_ENDIF##>
					##TP_Name##
				</option>
			##TP_ENDIF##
		##TP_ENDLOOP##
	  </select>
   ##TP_ELSE##
   	##TP_GlobalBFAcctName##
	<input type="hidden" name="GlobalBFAcctName" value="##TP_GlobalBFAcctName##">
	<input type="hidden" name="Global_BF_Account" value="##TP_GlobalBFAcctId##">
   ##TP_ENDIF##

  </td>

</tr>

<tr>
  <th class="buttons" colspan="2">
    <input type="button" value="Update" onClick="return fs(this,'UpdateBFControl')">
  </th>
</tr>
<input type="hidden" name="SubmitName" value="">
<input type="hidden" name="action" value="ADMIN::BETFAIR::DoBFControl">
</form>
</table>
<br><br>
<table border=0 cellspacing=0 cellpadding=3>
<form name="bf_accts" action="##TP_CGI_URL##" method=post>
<tr>
  <th colspan=2 class=title>
  Betfair Accounts
  </th>
</tr>
<tr>
	<th> Username </th>
	<th> Status </th>
</tr>
##TP_LOOP bf_acct_idx {[tpGetVar AcctRows]}##
<tr>
	<td>
  	##TP_IF {[op_allowed BFEditBFAccount] && ([tpBindGet GlobalBFAcctId] != [tpBindGet id])}##
  		<a href="##TP_CGI_URL##?action=ADMIN::BETFAIR_ACCT::GoBFAccount&SubmitName=EditAcct&Name=##TP_Name##" >##TP_Name##</a>
	##TP_ELSE##
		##TP_Name##
	##TP_ENDIF##
	</td>
	<td>
	##TP_IF {[tpBindGet status] == "A"}## Active
	##TP_ELSE## Suspended
	##TP_ENDIF##
	</td>
</tr>
##TP_ENDLOOP##

##TP_IF {[op_allowed BFEditBFAccount]}##
<tr>
  <th class="buttons" colspan="2">
    <input type="button" value="Add Betfair-Account" onClick="return fs(this,'AddAcct')">
  </th>
</tr>
##TP_ENDIF##
</tr>
<input type="hidden" name="SubmitName" value="">
<input type="hidden" name="action" value="ADMIN::BETFAIR_ACCT::GoBFAccount">
</form>
</table>
</body>
</html>

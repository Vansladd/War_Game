<html>
<!-- $Id: ix_market.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>Add Index Market</title>
##TP_PLAY JS_WriteSelect.html##
<script language=JavaScript>
var errorList = "";
function add_err(e_str)
{
	if (errorList.length > 0) {
		errorList += "\n";
	}
	errorList += e_str;
}

function validate(f)
{
	return true;
}

function go_dbv()
{
	var url = "##TP_TCL {OT_CfgGet DBV_URL}##?action=go_market_ix&ix_mkt_id="
		+ "##TP_IxMktId##";
	window.open(
		url,
		"Liabiity_monitor",
		"toolbar=no,location=no,directories=no,menubar=no,resizable=yes,scrollbars=yes,width=600,height=500"
	);

	return false;
}

function fs(b,t)
{
	if (t == "DBV") {
		return go_dbv();
	}
	b.disabled = true;
	b.value = "Busy...";
	b.form.SubmitName.value=t;
	b.form.submit();
	return true;
}

</script>
</head>

<body>
##TP_PLAY error_rpt.html##
##TP_PLAY msg_rpt.html##

##TP_IF {[tpGetVar opAdd 0]}##
	##TP_TCL {tpSetVar Settled 0}##
##TP_ENDIF##

<table border=0 cellspacing=0 cellpadding=2>
<form name="NewEvIxMkt" method=get action="##TP_CGI_URL##" onSubmit="return validate(this);">
<tr>
	<th class=title colspan=2>
	##TP_EvDesc## index market
	</th>
</tr>
<tr class=infoyes>
	<th colspan=2 align=center>
	<font color=white>
	##TP_IxMktName##
	</font>
	<input type=hidden name="IxMktGrpId" value="##TP_IxMktGrpId##">
	<input type=hidden name="IxMktSort"  value="##TP_IxMktSort##">
	</th>
</tr>
<tr>
	<td class=caption>Name ##TP_TCL {tpBufWrite [tpGetVar IxMktStatus]}##</td>
	<td>
	<input type=text name="IxMktName" value="##TP_IxMktName##" SIZE=40>
	</td>
</tr>
<tr>
<tr>
	<td class=caption>Code</td>
	<td>
	<input type=text name="IxMktCode" value="##TP_IxMktCode##" SIZE=40>
	</td>
</tr>
<tr>
	<td class=caption>Status</td>
	<td>
	##TP_IF {![tpGetVar Settled 0]}##
		<select name="IxMktStatus">
				##TP_IF {[tpGetVar IxMktStatus]=="C"}##
			  <script>
				write_select('##TP_IxMktStatus##','C','Configure','A','Active','S','Suspended')
			  </script>
			</select>
			  ##TP_ELSE##
			  <script>
				write_select('##TP_IxMktStatus##','A','Active','S','Suspended')
			  </script>
			</select>
			  ##TP_ENDIF##
	##TP_ELSE##
		<script>
		write_which('##TP_IxMktStatus##','A','Active','S','Suspended')
		</script>
		<input type=hidden name=IxMktStatus value="##TP_IxMktStatus##">
	##TP_ENDIF##
	</td>
</tr>
<tr>
	<td class=caption>Display order</td>
	<td>
	<input name="IxMktDisporder" TYPE="text" size="6" value="##TP_IxMktDisporder##">
	&nbsp;&nbsp;&nbsp;
	<font size="+0"><b>Displayed</b></font>
	&nbsp;
	<select name="IxMktDisplayed">
	<script>
	write_select('##TP_IxMktDisplayed##','Y','Yes','N','No')
	</script>
	</select>
</tr>
<tr>
	<td class=caption>Blurb</td>
	<td>
	<textarea cols=60 rows=6 wrap=virtual name="IxMktBlurb">##TP_IxMktBlurb##</textarea>
	</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td><i>(Only 250 characters are stored)</i></td>
</tr>

##TP_IF {[tpGetVar IxMktStatus]=="C"}##
<!-- Index range and step -->
<tr>
	<td class=caption>Index</td>
	<td>
	<b>Min:</b>&nbsp;
	<input type=text name=IxMktIndexMin value="##TP_IxMktIndexMin##" size=7>
	&nbsp;&nbsp;&nbsp;
	<b>Max:</b>&nbsp;
	<input type=text name=IxMktIndexMax value="##TP_IxMktIndexMax##" size=7>
	&nbsp;&nbsp;&nbsp;
	<b>Step:</b>
	<input type=text name=IxMktIndexStep value="##TP_IxMktIndexStep##" size=5>
	</td>
</tr>
<tr>
	<td class=caption>Makeup step</td>
	<td>
	<input type=text name=IxMktMakeupStep value="##TP_IxMktMakeupStep##" size=7>
	</td>
</tr>
<tr>
	<td class=caption>End of day</td>
	<td>
	<input type=text name=IxMktEndOfDay value="##TP_IxMktEndOfDay##" size=9>		
	</td>
</tr>
<tr>
	<td class=caption>Point price</td>
	<td>
	<input type=text name=IxMktPointPrice value="##TP_IxMktPointPrice##" size=5>
	</td>
</tr>
<tr>
	<td class=caption>Commission</td>
	<td>
	<input type=text name=IxMktCommission value="##TP_IxMktCommission##" size=5>
	</td>
</tr>
##TP_ELSE##
<!-- Index range and step -->
<tr>
	<td class=caption>Index</td>
	<td>
	<b>Min:</b>&nbsp;
	##TP_IxMktIndexMin##
	&nbsp;&nbsp;&nbsp;
	<b>Max:</b>&nbsp;
	##TP_IxMktIndexMax##
	&nbsp;&nbsp;&nbsp;
	<b>Step:</b>
	##TP_IxMktIndexStep##
	</td>
</tr>
<tr>
	<td class=caption>Makeup step</td>
	<td>
	##TP_IxMktMakeupStep##
	</td>
</tr>
<tr>
	<td class=caption>End of day</td>
	<td>
	##TP_IxMktEndOfDay##
	</td>
</tr>
<tr>
	<td class=caption>Point price</td>
	<td>
	##TP_IxMktPointPrice##
	</td>
</tr>
<tr>
	<td class=caption>Commission</td>
	<td>
	##TP_IxMktCommission##
	</td>
</tr>
<input type=hidden name=IxMktIndexMin value="##TP_IxMktIndexMin##" size=7>
<input type=hidden name=IxMktIndexMax value="##TP_IxMktIndexMax##" size=7>
<input type=hidden name=IxMktIndexStep value="##TP_IxMktIndexStep##" size=5>
<input type=hidden name=IxMktMakeupStep value="##TP_IxMktMakeupStep##" size=7>
<input type=hidden name=IxMktEndOfDay value="##TP_IxMktEndOfDay##" size=9>		
<input type=hidden name=IxMktPointPrice value="##TP_IxMktPointPrice##" size=5>
<input type=hidden name=IxMktCommission value="##TP_IxMktCommission##" size=5>
##TP_ENDIF##
##TP_IF {[OT_CfgGet FUNC_CHANNELS 0]}##
	<tr>
		<td class=caption>Channels</td>
		<td align=left valign=center>
		##TP_PLAY chan_sel.html##
		</td>
	</tr>
##TP_ENDIF##

<tr>
	<th class=buttons colspan=2>
	<table border=0 cellspacing=0 cellpadding=0 width=100%>
	<tr>
		<input type="hidden" name="TypeId"  value="##TP_TypeId##">
		<input type="hidden" name="EvId"    value="##TP_EvId##">
		<input type="hidden" name="IxMktId" value="##TP_IxMktId##">
		<th width=75% class=buttons>
		##TP_IF {[op_allowed IxMkt]}##
			##TP_IF {[tpGetVar opAdd 0]}##
				##TP_IF {[tpGetVar AllowDDCreation 0]}##
				<input type=button class="btn_def" value="Add Ix" onClick="return fs(this,'IxMktAdd')">
				##TP_ENDIF##
			##TP_ELSE##
				<input type=button class="btn_def" value="Modify Index" onClick="return fs(this,'IxMktMod')">
				##TP_IF {[tpGetVar AllowDDDeletion 0]}##
				<input type=button class="btn_def" value="Delete Index" onClick="return fs(this,'IxMktDel')">
				##TP_ENDIF##
				##TP_IF {![tpGetVar Settled 0] && [OT_CfgGet DBV_URL ""]!=""}##
					<input type=button class="btn_def" value="Orders/Trades" onClick="return fs(this,'DBV')">
				##TP_ENDIF##
				<input type=button class="btn_def" value="Clear Working" onClick="return fs(this,'IxMktClear')">
			##TP_ENDIF##
		##TP_ENDIF##
		<input type=button class="btn_def" value="Back" onClick="return fs(this,'Back')">
		</th></tr><tr>
		##TP_IF {![tpGetVar opAdd 0]}##
			##TP_IF {[tpGetVar PERM_ViewAudit 0]}##
				<th class=goaudit width=25%>
				<input type=button class="btn_def" value="Audit History" onClick="return fs(this,'GoAudit')">
				<input type=hidden name=AuditInfo value="EvIxMkt">
				</th>
			##TP_ENDIF##
		##TP_ENDIF##
	</tr>
	</table>
	</th>
</tr>
<input type=hidden name=SubmitName value="">
<input type=hidden name=action value=ADMIN::IXMARKET::DoIxMkt>
</form>
</table>

##TP_IF {[tpGetVar AfterEventStart 0]}##
	<br>
	<table border=0 cellspacing=0 cellpadding=2>
	<form name="NewEvIxMkt" method=get action="##TP_CGI_URL##" onSubmit="return validate(this);">
	<tr>
		<th class=title colspan=2>
		Result/Settlement
		</th>
	</tr>
	<tr class=infono>
		<th colspan=2 align=center>
		<font color=white>
		Index results
		</font>
		</th>
	</tr>
	<tr>
		<td class=caption>Result</td>
		##TP_IF {[op_allowed SetResults] && (![tpGetVar Confirmed] || ![tpGetVar ResultSet 0])}##
			<td>
			<input type="hidden" name="IxMktResult" value="M">
			<input type=text name=IxMktMakeup value="##TP_IxMktMakeup##" size=7>&nbsp;
			(<i>makeup value</i>)
			</td>
		##TP_ELSEIF {[tpGetVar ResultSet 0]}##
			<td>
			<script>write_which("##TP_IxMktResult##",
				"-","",
				"M","Makeup is ##TP_IxMktMakeup##")</script>
			</script>
			</td>
		##TP_ELSE##
			<td><i>No result set</i></td>
		##TP_ENDIF##
	</tr>

	##TP_IF {[tpGetVar Settled 0]}##
		<tr class=settled>
			<th colspan=2 align=left>
			<font color=white>
			This index has been settled
			</font>
			</th>
		</tr>
	##TP_ELSE##
		<tr>
			<th class=buttons colspan=2>
			##TP_IF {[op_allowed SetResults] && (![tpGetVar ResultSet 0] || ![tpGetVar Confirmed 0])}##
				<input type=button class="btn_def" value="Set Results" onClick="return fs(this,'IxMktSetRes')">
			##TP_ENDIF##
			##TP_IF {[op_allowed ConfirmResults] && (![tpGetVar Confirmed 0] && [tpGetVar ResultSet 0])}##
				<input type=button class="btn_def" value="Confirm Results" onClick="return fs(this,'IxMktConf')">
			##TP_ENDIF##
			##TP_IF {[op_allowed ConfirmResults] && [tpGetVar Confirmed 0]}##
				<input type=button class="btn_def" value="Unconfirm Results" onClick="return fs(this,'IxMktUnConf')">
			##TP_ENDIF##
			##TP_IF {[op_allowed Settle] && [tpGetVar Confirmed 0]}##
				<input type=button class="btn_def" value="Settle Index" onClick="return fs(this,'IxMktStl')">
				<input type=hidden name=DoSettle value=Y>
			##TP_ENDIF##
			<input type=button class="btn_def" value="Back" onClick="return fs(this,'Back')">
			</th>
		</tr>
	##TP_ENDIF## <!-- Settled -->
	<input type="hidden" name="TypeId" value="##TP_TypeId##">
	<input type="hidden" name="EvId" value="##TP_EvId##">
	<input type="hidden" name="IxMktId" value="##TP_IxMktId##">
	<input type=hidden name=SubmitName value="">
	<input type=hidden name=action value=ADMIN::IXMARKET::DoIxMkt>
	</form>
	</table>
##TP_ENDIF## <!-- AfterEventStart -->
</body>
</html>

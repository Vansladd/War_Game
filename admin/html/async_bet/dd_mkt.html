##TP_COMMENT $Id: dd_mkt.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $##
##TP_COMMENT Copyright (c) 2005 Orbis Technology Ltd. All rights reserved.##

<!-- Drill-Down Market -->
<tr id="mkt_##TP_leg_leg_no##_##TP_leg_part_no##" style="display:none">
	##TP_IF {$ASYNC(leg,[tpGetVar leg_idx],mkt_update)}##
		<form action="##TP_CGI_URL##" name="mkt_##TP_leg_leg_no##_##TP_leg_part_no##" method="get">
		<input type="hidden" name="action" value="ADMIN::ASYNC_BET::DoUpdDDMkt">
		<input type="hidden" name="ev_mkt_id" value="##TP_leg_ev_mkt_id##">
		<input type="hidden" name="bet_id" value="##TP_bet_id##">
		<input type="hidden" name="bet_group_id" value="##TP_bet_group_id##">
		<input type="hidden" name="selected_leg" value="">
		<input type="hidden" name="selected_dd" value="">
	##TP_ENDIF##

	<td colspan="5" class="bordered_col">

		<table cellspacing="0" cellpadding="2" class="bordered_table" width="96%">

			##TP_IF {$ASYNC(leg,[tpGetVar leg_idx],ev_mkt_id) == [tpGetVar DD_EV_MKT_ID ""]}##
				##TP_IF {[tpGetVar IsError 0]}##
					<tr id="dd_update_msg_mkt_##TP_leg_leg_no##_##TP_leg_part_no##">
						<th class="subcaption" colspan="2" style="color: red">
							Error: while updating ##TP_leg_mkt_name## Event Market Details
							<br>##TP_ErrMsg## ##TP_ERROR## ##TP_ErrorSite##
						</td>
					</tr>
				##TP_ELSE##
					<tr id="dd_update_msg_mkt_##TP_leg_leg_no##_##TP_leg_part_no##">
						<th class="subcaption" colspan="2" style="color: green">
							Successfully updated ##TP_leg_mkt_name## Event Market Details
						</td>
					</tr>
				##TP_ENDIF##
			##TP_ENDIF##
			<tr id="dd_caption_mkt_##TP_leg_leg_no##_##TP_leg_part_no##" ##TP_IF {$ASYNC(leg,[tpGetVar leg_idx],ev_mkt_id) == [tpGetVar DD_EV_MKT_ID ""]}##style="display:none"##TP_ENDIF##>
				<th class="subtitle" colspan="2">
					##TP_leg_mkt_name## Event Market Details
				</td>
			</tr>

			<tr>
				<td class="caption">Status</td>
				<td>
					##TP_IF {$ASYNC(leg,[tpGetVar leg_idx],mkt_update)}##
						<select name="status">
							<script>
								write_select('##TP_leg_mkt_status##','A','Active','S','Suspended')
							</script>
						</select>
					##TP_ELSEIF {$ASYNC(leg,[tpGetVar leg_idx],mkt_settled) == "Y"}##
						Settled
					##TP_ELSE##
						Result Confirmed
					##TP_ENDIF##
				</td>
			</tr>

			##TP_IF {$ASYNC(leg,[tpGetVar leg_idx],mkt_update)}##
				<tr>
					<td class="caption">Displayed</td>
					<td>
						<select name="displayed">
							<script>
								write_select('##TP_leg_mkt_displayed##', 'Y','Yes','N','No');
							</script>
						</select>
					</td>
				</tr>

				<!-- Accumulator settings (not for Asian Handicap, Scorecast or Spread Bet) -->
				##TP_IF {[string first $ASYNC(leg,[tpGetVar leg_idx],mkt_type) "ASC"] < 0}##
					<tr>
						<td class="caption">Accumulators</td>
						<td>
							Min:&nbsp;<input type="text" name="acc_min" value="##TP_leg_mkt_acc_min##" size="2">
							&nbsp;Max:&nbsp;<input type="text" name="acc_max" value="##TP_leg_mkt_acc_max##" size="2">
							##TP_IF {[string first XMUL [OT_CfgGet FUNC_MKT_FIELDS ""]] >= 0}##
								&nbsp;and:&nbsp;
								<select name="xmul">
									<script>
										write_select("##TP_leg_mkt_xmul##",
											"-", "Unrestricted",
											"C", "This class only",
											"T", "This type only")
									</script>
								</select>
							##TP_ENDIF XMUL##
						</td>
					</tr>
				##TP_ELSE##
					<input type="hidden" name="acc_min" value="1">
					<input type="hidden" name="acc_max" value="1">
				##TP_ENDIF MktType##

				##TP_IF {[string first $ASYNC(leg,[tpGetVar leg_idx],mkt_type) "N"] >= 0}##
					<tr>
						<td class="caption">BIR index</td>
						<td>
							<input type="text" name="bir_index" value="##TP_leg_mkt_bir_index##" size="4">
						</td>
					</tr>
				##TP_ELSE##
					<input type="hidden" name="bir_index" value="##TP_leg_mkt_bir_index##">
				##TP_ENDIF##

				##TP_IF {[OT_CfgGet FUNC_BIR_DELAY 0]} ##
					<tr>
						<td class="caption">BIR delay</td>
						<td>
							<input type=text name="bir_delay" value="##TP_leg_mkt_bir_delay##" size="4">&nbsp;(sec)
							&nbsp;<b>BIR</b>
							<select name="bet_in_run">
								<script>
									write_select('##TP_leg_mkt_bet_in_run##','Y','Yes','N','No')
								</script>
							</select>
						</td>
					</tr>
				##TP_ENDIF##

				##TP_IF {[string first $ASYNC(leg,[tpGetVar leg_idx],mkt_type) "AHULlSC"] < 0 ||
									[OT_CfgGet FUNC_HCAP_LIAB 0]}##
					<tr>
						<td class=caption>Liability limit</td>
						<td>
							<input type="text" name="liab_limit" id="mkt_liab_limit" class="canonicalMoney" size="10" value="##TP_TCL {tpBufWrite [comma_num_str [tpBindGet leg_mkt_liab_limit]]}##" onblur="ensureInputElemCanonical(this);"/> 
							<i>(selection suspends when this limit is reached)</i>
						</td>
					</tr>
				##TP_ELSE##
					<input type="hidden" name="liab_limit" value="##TP_mkt_liab_limit##">
				##TP_ENDIF##

				<tr>
					<td class=caption>Betting</td>
					<td>
						Min Bet:&nbsp;<input name="min_bet" id="mkt_min_bet" class="canonicalMoney" type="text" size="12" value="##TP_leg_mkt_min_bet##" onblur="ensureInputElemCanonical(this);" >
						&nbsp;
						##TP_IF {[OT_CfgGet FUNC_VARIABLE_MAX_STAKES_BY_TIME 0] && ([lsearch [OT_CfgGet VAR_MAX_STAKE_CLASSES ""] $ASYNC(leg,[tpGetVar leg_idx],ev_class_id)] != -1)}##Standard ##TP_ENDIF##Max Bet:&nbsp;
						<input name="max_bet" id="mkt_max_bet" class="canonicalMoney" type="text" size="12" value="##TP_TCL {tpBufWrite [comma_num_str [tpBindGet leg_mkt_max_bet]]}##" onblur="ensureInputElemCanonical(this);">
						&nbsp;
						##TP_IF {[OT_CfgGet FUNC_MAX_WIN_MULTIPLES 0]}##
						Max Multiple Bet:&nbsp;<input name="max_mult_bet" id="mkt_max_mult_bet" class="canonicalMoney" type="text" size="12" value="##TP_leg_mkt_max_mult_bet##" onblur="ensureInputElemCanonical(this);" />
						##TP_ELSE##
						<input type="hidden" name="max_mult_bet" class="canonicalMoney" value="##TP_leg_mkt_max_mult_bet##" />
						##TP_ENDIF##
					</td>
				</tr>
				##TP_IF {[OT_CfgGet FUNC_LAY_TO_LOSE 0]}##
				<tr>
					<td class="caption" rowspan="3">Lay to Lose</td>
					<td>
						Win LP:&nbsp;<input name="win_lp" id="mkt_win_lp" class="canonicalMoney" type="text" size="12" value="##TP_leg_mkt_win_lp##" onblur="ensureInputElemCanonical(this);" />
						&nbsp;<i>(##TP_leg_type_win_lp##)</i>
						Place LP:&nbsp;<input name="place_lp" id="mkt_place_lp" class="canonicalMoney" type="text" size="12" value="##TP_leg_mkt_place_lp##" onblur="ensureInputElemCanonical(this);" />
						&nbsp;<i>(##TP_leg_type_place_lp##)</i>
					</td>
				</tr>
				<tr>
					<td>
						Win SP:&nbsp;<input name="win_sp" id="mkt_win_sp" class="canonicalMoney" type="text" size="12" value="##TP_leg_mkt_win_sp##" onblur="ensureInputElemCanonical(this);" />
						&nbsp;<i>(##TP_leg_type_win_sp##)</i>
						Place SP:&nbsp;<input name="place_sp" id="mkt_place_sp" class="canonicalMoney" type="text" size="12" value="##TP_leg_mkt_place_sp##" onblur="ensureInputElemCanonical(this);" />
						&nbsp;<i>(##TP_leg_type_place_sp##)</i>
					</td>
				</tr>
				##TP_IF { [lsearch [OT_CfgGet EP_AVAILABLE_CLASSES "GREYHOUNDS HORSE_RACING"] [tpBindGet leg_category]] != -1}##
				<tr>
					<td>
						Win EP:&nbsp;<input name ="win_ep" id="mkt_win_ep" class="canonicalMoney" type="text" size="12" value="##TP_leg_mkt_win_ep##" onblur="ensureInputElemCanonical(this);" />
						&nbsp;<i>(##TP_leg_type_win_ep##)</i>
                                                Place EP:&nbsp;<input name="place_ep" id="mkt_place_ep" class="canonicalMoney" type="text" size="12" value="##TP_leg_mkt_place_ep##" onblur="ensureInputElemCanonical(this);" />
                                                &nbsp;<i>(##TP_leg_type_place_ep##)</i>
					</td>
				</tr>
				##TP_ELSE##
				<tr>
					<td>
						<input type="hidden" name="win_ep" value="##TP_leg_mkt_win_ep##" />
						<input type="hidden" name="place_ep" value="##TP_leg_mkt_place_ep##" />
					</td>
				</tr>	
				##TP_ENDIF##
				##TP_ELSE##
					<input type="hidden" name="win_lp" value="##TP_leg_mkt_win_lp##" />
					<input type="hidden" name="win_sp" value="##TP_leg_mkt_win_sp##" />
					<input type="hidden" name="win_ep" value="##TP_leg_mkt_win_ep##" />
					<input type="hidden" name="place_lp" value="##TP_leg_mkt_place_lp##" />
					<input type="hidden" name="place_sp" value="##TP_leg_mkt_place_sp##" />
                                        <input type="hidden" name="place_ep" value="##TP_leg_mkt_place_ep##" />
				##TP_ENDIF##
					<!-- Addition Lay to Lose hidden information -->
					<input type="hidden" name="t_win_lp" value="##TP_leg_type_win_lp##" />
					<input type="hidden" name="t_place_lp" value="##TP_leg_type_place_lp##" />
					<input type="hidden" name="t_win_sp" value="##TP_leg_type_win_sp##" />
					<input type="hidden" name="t_place_sp" value="##TP_leg_type_place_sp##" />
					<input type="hidden" name="t_win_ep" value="##TP_leg_type_win_ep##" />
                                        <input type="hidden" name="t_place_ep" value="##TP_leg_type_place_ep##" />
					<input type="hidden" name="InfMB" value="##TP_leg_mkt_inf_bet##" />
					<input type="hidden" name="SupMB" value="##TP_leg_mkt_sup_bet##" />
			##TP_ENDIF mkt_update##

			##TP_IF {[op_allowed ManageEvMkt] && $ASYNC(leg,[tpGetVar leg_idx],mkt_update)}##
			<tr>
				<th class="buttons" colspan="2">
						<input type="button" class="btn_def" value="Update" onclick="updDDMkt(this, 'mkt_##TP_leg_leg_no##_##TP_leg_part_no##')">&nbsp;&nbsp;&nbsp;&nbsp;
				</th>
			</tr>
			##TP_ENDIF##

		</table>

	</td>

	##TP_IF {$ASYNC(leg,[tpGetVar leg_idx],mkt_update)}##
		</form>
	##TP_ENDIF##

</tr>
<!-- End of Drill-Down Market -->

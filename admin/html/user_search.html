<html>
<!-- $Id: user_search.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ -->
<!-- $Name: RC_Training $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>Users</title>
##TP_PLAY JS_WriteSelect.html##
<script>
function write_user(user_id,username,fname,lname,status,position,desc,login,login_time,login_loc,override_code)
{
  if (status == 'S') {
    document.write('<tr class=suspended>');
  } else {
    document.write('<tr class=active>');
  }
  document.write('<td>');
  if(status == 'A' || status == 'S') {
    // store both the user_id and status in a TCL list format, so we can compare to
    // the ones that should be active when the form is submitted
    document.write('<input type=hidden name=user_id_status value="'+user_id+' '+status+'">');
    document.write('<input type=checkbox name=active_user_id value='+user_id+' '+(status=='A'?'checked':'')+'>');
  } else {
    document.write('&nbsp;');
  }
  document.write('</td>\n');
  document.write('<td>');
##TP_IF {[OT_CfgGet FUNC_ADM_USER_UNSUSP 1]}##
  document.write('<a href="##TP_CGI_URL##?action=ADMIN::USERS::GoUser&UserId='
    +user_id+'">'+username+'</a>');
##TP_ELSE##
  if (status == 'A') {
    document.write('<a href="##TP_CGI_URL##?action=ADMIN::USERS::GoUser&UserId='
      +user_id+'">'+username+'</a>');
  } else {
    document.write(username);
  }
##TP_ENDIF##
  document.write('</td>\n');
  document.write('<td>');
  document.write(status=="A"?'active':status=="L"?'locked':status="X"?'deleted':'suspended');
  document.write('</td>\n');
  document.write('<td>');
  document.write(fname+'&'+'nbsp;');
  document.write('</td>\n');
  document.write('<td>');
  document.write(lname+'&'+'nbsp;');
  document.write('</td>\n');
  document.write('<td>');
  document.write(position+'&'+'nbsp;');
  document.write('</td>\n');
  document.write('<td>');
  document.write(desc+'&'+'nbsp;');
  document.write('</td>\n');
  document.write('<td>');
  document.write(login+'&'+'nbsp;');
  document.write('</td>\n');
  document.write('<td>');
  document.write(login_time+'&'+'nbsp;');
  document.write('</td>\n');
  document.write('<td>');
  document.write(login_loc+'&'+'nbsp;');
  document.write('</td>\n');
  document.write('<td>');
  document.write(override_code+'&'+'nbsp;');
  document.write('</td>\n');
  document.write('</tr>\n');
}
function fs(b,t)
{
	b.disabled = true;
	b.value = "Busy...";
	b.form.SubmitName.value=t;
	b.form.submit();
	return true;
}
</script>
</head>
<body>
##TP_PLAY msg_rpt.html##
##TP_PLAY error_rpt.html##

<table border="0" cellspacing="0" cellpadding="3">
<tr>
  <th colspan="12" class=title>
  Administration Users
  </th>
</tr>
##TP_IF {[tpGetVar hasRights 0]==1}##
  <form method="get" action="##TP_CGI_URL##">
  <tr>
    <th colspan="12" class=buttons>
    <input type=button class="btn_def" value="Add New Adminstration User" onClick="window.location='##TP_CGI_URL##?action=ADMIN::USERS::GoUser&SubmitName=Adduser'">
    </th>
  </tr>
  <input type=hidden name=SubmitName value="">
  <input type=hidden name=action value="ADMIN::USERS::GoUser">
  </form>
##TP_ENDIF##
<tr>
  <th class="colhead">&nbsp;</th>
  <th class="colhead">Username &nbsp;</th>
  <th class="colhead">Status &nbsp;</th>
  <th class="colhead">First Name &nbsp;</th>
  <th class="colhead">Last Name &nbsp;</th>
  <th class="colhead">##TP_IF {[OT_CfgGet FUNC_ADMIN_HIERARCHY 0]}##Position##TP_ENDIF##</th>
  <th class="colhead">Desc &nbsp;</th>
  <th class="colhead">Logged in &nbsp;</th>
  <th class="colhead">Login time &nbsp;</th>
  <th class="colhead">Login loc &nbsp;</th>
  ##TP_IF {[OT_CfgGet OVERRIDE_CODES 0]}##
	<th class="colhead">Override Code</th>
  ##TP_ENDIF##
</tr>

<form action="##TP_CGI_URL##" method="post">
<input type="hidden" name="action" value="ADMIN::USERS::DoActivateSuspendUsers">
##TP_LOOP user_idx {[tpGetVar NumUsers]}##
  <script>
    write_user('##TP_UserId##',"##TP_Username##",
      "##TP_Fname##", "##TP_Lname##",
      "##TP_Status##", "##TP_Position##", "##TP_Desc##",
      "##TP_LoggedIn##","##TP_LoginTime##","##TP_LoginLoc##","##TP_OverrideCode##");
  </script>
##TP_ENDLOOP##
    <tr>
      <th colspan="12" class=buttons>
      <input type="submit" class="btn_def" value="Activate/Suspend Users" title="Click to update the user's status">
      <input type=button class="btn_def" value="Back" onClick="window.location='##TP_CGI_URL##?action=ADMIN::USERS::GoUsers'">
    </form>
</td>
    </tr>
</table>
<br/>
##TP_PLAY "user_search_box.html"##
</body>
</html>

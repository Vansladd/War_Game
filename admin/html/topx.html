<html>
<!-- $Id: topx.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>Modify Top X Bets/HMDYWTW Settings</title>
##TP_PLAY JS_WriteSelect.html##
<script language=JavaScript>
function validate(f)
{
	return true;
}

function isInt(x) {
	var y=parseInt(x);
	if (isNaN(y)) return false;
	return x==y && x.toString()==y.toString();
}

function validate(f,t) {
	if (f.name == "form" && t == "TopxUpdate") {
		// Check radio group "settings" value
		var settings = "";
		for (i=0; i < f.settings.length; i++) {
			if (f.settings[i].checked == true) { settings = f.settings[i].value; break; }
		}


		if (settings == "copy") {
			if (f.view.value == f.copy_view.value) {
				alert("Cannot copy a view to itself");
				return false;
			} else {
				return confirm("Copying settings from another view will erase any current settings. Are you sure you want to continue?");
			}
		}

		if (f.BsCanvasBets.value == ""
		  || !isInt(f.BsCanvasBets.value)
		  || parseInt(f.BsCanvasBets.value) < 1
		  || parseInt(f.BsCanvasBets.value) > 7) {
			alert("Canvas Bet Count should be between 1 and 7");
			return false;
		}

		if (f.BsTeaserBets.value == ""
		  || !isInt(f.BsTeaserBets.value)
		  || parseInt(f.BsTeaserBets.value) < 1
		  || parseInt(f.BsTeaserBets.value) > 7) {
			alert("Teaser Bet Count should be between 1 and 7");
			return false;
		}

		if (f.MinStartTime.value != "" &&
			(!isInt(f.MinStartTime.value)
			 || parseInt(f.MinStartTime.value) < 0)) {
			alert("Min time before event must blank or a positive integer");
			return false;
		}

		if (f.MaxEventEnd.value != "" &&
			(!isInt(f.MaxEventEnd.value)
			 || parseInt(f.MaxEventEnd.value) < 0)) {
			alert("Max time before event end must be blank or a positive integer");
			return false;
		}


	}

	return true;
}

function fs(b,t)
{
	if (validate(b.form,t)) {
		b.disabled = true;
		b.value = "Busy...";
		b.form.SubmitName.value=t;
		b.form.submit();
		return true;
	} else {
		return false;
	}
}

function onchange_submit(e,t) {
	e.form.SubmitName.value = t;
	e.form.submit();
}


function SubmitWeight(b,t,ev_oc_id) {

	b.form.ev_oc_id.value = ev_oc_id;
	return fs(b,t);
}

function toggleAll(e) {
	var form = e.form;
	var checked = e.checked;
	if (checked) {
		for (var i=0; i<form.elements.length; i++) {
			if (form.elements[i].name.match("SP_.*")) form.elements[i].checked = true;
		}
	} else {
		for (var i=0; i<form.elements.length; i++) {
			if (form.elements[i].name.match("SP_.*")) form.elements[i].checked = false;
		}
	}
}

function disableForm(c) {
	toggleElements(c.form, true);
}

function enableForm(c) {
	toggleElements(c.form, false);
}

function toggleElements(form, value) {
	for (var i=0; i<form.elements.length; i++) {
		var e = form.elements[i];
		if (e.type=="checkbox" || e.type=="text" || e.name=="BsTeaserExpanded") {
			e.disabled = value;
		}

		if (e.name=="copy_view") {
			e.disabled = !value;
		}
	}
}

function checkToleranceLimit(id, value, max_value, o_value, message) {

	if (value > max_value || value < 0){
		alert(message);
		var holder = document.getElementById(id);
		holder.value = o_value;	
	}

}

</script>
</head>
<body>
##TP_PLAY error_rpt.html##
##TP_PLAY msg_rpt.html##

<form name="form" ACTION="##TP_CGI_URL##" method=post onSubmit="return validate(this);">
<input type="hidden" name="SubmitName" value="" />
<input type="hidden" name="action" value="ADMIN::TOPX::DoTopx" />
<input type="hidden" name="ev_oc_id" value="" />

<table>
	<tr>
		<th class="title">
			View
		</th>
	</tr>
	<tr>
		<td>
			<b>View</b>
			<select name="view" onChange="onchange_submit(this,'ChangeView')">
			##TP_LOOP view_idx {[tpGetVar NumViews]}##
				<option value="##TP_ViewValue##"
				##TP_IF {[tpBindGet View] == [tpBindGet ViewValue]}##
				selected="selected"
				##TP_ENDIF##
				>##TP_ViewName##</option>
			##TP_ENDLOOP##
			</select>
		</td>
	</tr>
</table>

<table style="margin-top:20px;">
	<tr>
		<th class="title">
			Settings
		</th>
	</tr>
	<td>
		<input type="radio" onClick="enableForm(this)" name="settings" checked="checked" value="config"> Use Settings Below

		<input type="radio" onClick="disableForm(this)" name="settings" value="copy">
		Use settings from <select name="copy_view" disabled="disabled">
		##TP_LOOP view_idx {[tpGetVar NumViews]}##
			##TP_IF {[tpBindGet View] != [tpBindGet ViewValue]}##
				<option value="##TP_ViewValue##">##TP_ViewName##</option>
			##TP_ENDIF##
		##TP_ENDLOOP##
		</select>
	</td>
</table>


##TP_COMMENT ----------------------------------------------------------------##
##TP_COMMENT                                           Sport Config Settings ##
##TP_COMMENT ----------------------------------------------------------------##
<table border=0 cellspacing=0 cellpadding=3 style="margin-top:20px;">
<tr>
	<th colspan=4 class=title>
	Sports to be Included in suggestions
	</th>
</tr>
<tr>
<td>
	##TP_TCL {tpSetVar _ColCount [expr ([tpGetVar NumSports] / 3) + 1]}##

	##TP_LOOP sport_idx {[tpGetVar NumSports]}##
		##TP_IF {[tpGetVar sport_idx] != 0 && [expr {[tpGetVar sport_idx] % [tpGetVar _ColCount]}] == 0}##
		</td><td>
		##TP_ENDIF##

		<input type="checkbox" name="SP_##TP_SportId##" value="Y"
		##TP_IF {[tpBindGet SportView] != ""}##
		checked="checked"
		##TP_ENDIF##
		/>
		##TP_SportName##
		<br />
	##TP_ENDLOOP##
</td>
</tr>
<tr>
<td colspan="3">
	<hr />
	<input type="checkbox" onClick="toggleAll(this)" /> Select / Deselect All
</td>
</tr>
</table>

##TP_COMMENT ----------------------------------------------------------------##
##TP_COMMENT                                                  Betslip Teaser ##
##TP_COMMENT ----------------------------------------------------------------##
<table border=0 cellspacing=0 cellpadding=3 style="width:98%;margin-top:20px;">
<tr>
	<th colspan=3 class=title>
	Betslip Teaser Settings
	</th>
</tr>
<tr>
	<td style="width:30%">
		<input ##TP_IF {[tpBindGet BS_TEASER_STATUS] == Y}##checked="checked"##TP_ENDIF##
			type="checkbox" name="BsTeaserStatus" value="Y"> Betslip Teaser Active
	</td>
	<td>
		Default Status:
		<select name="BsTeaserExpanded">
			<option value="Y"
				##TP_IF {[tpBindGet BS_TEASER_EXPANDED]==Y}##selected="selected"##TP_ENDIF##
			>Expanded</option>
			<option value="N"
				##TP_IF {[tpBindGet BS_TEASER_EXPANDED]==N}##selected="selected"##TP_ENDIF##
			>Collapsed</option>
		</select>
	</td>
	<td>
		Number of Top Bets:
		<input type="text" name="BsTeaserBets" size="2" value="##TP_BS_TEASER_BETS##" />
	</td>
</tr>
</table>


##TP_COMMENT ----------------------------------------------------------------##
##TP_COMMENT                                                   Banner Teaser ##
##TP_COMMENT ----------------------------------------------------------------##
<table border=0 cellspacing=0 cellpadding=3 style="width:98%;margin-top:20px;">
<tr>
	<th class=title>
	Banner Canvas Teaser Settings
	</th>
</tr>
<tr><td>
	Number of Top Bets:
	<input type="text" name="BsCanvasBets" size="2" value="##TP_BS_CANVAS_BETS##" />
</td>
</tr>
</table>


##TP_COMMENT ----------------------------------------------------------------##
##TP_COMMENT                                                   Misc Settings ##
##TP_COMMENT ----------------------------------------------------------------##
<table border=0 cellspacing=0 cellpadding=3 style="width:98%;margin-top:20px;">
<tr>
	<th colspan="2" class=title>
	Misc. Settings
	</th>
</tr>
<tr>
	<td>
		Min. time before event starts:
		<input type="text" name="MinStartTime" size="2" value="##TP_MIN_START_TIME_MINS##" /> minutes
	</td>
	<td>
		Max time until event starts:
		<input type="text" name="MaxEventEnd" size="2" value="##TP_MAX_EVENT_END_HOURS##" /> hours
	</td>
</tr>
</table>


<div style="text-align:center;padding:20px;">
	<input type="button" class="btn_def" onClick="fs(this,'TopxUpdate')" value="Update" />
</div>

<hr />


##TP_COMMENT ----------------------------------------------------------------##
##TP_COMMENT                                                      Top X Bets ##
##TP_COMMENT ----------------------------------------------------------------##
<table border=0 cellspacing=0 cellpadding=3 style="width:98%;margin-top:20px;">
<tr>
	<th colspan="11" class=title>
	<span style="float:right;">
		<input type="button" class="btn_def" onClick="fs(this,'GoHierarchy')"
			value="Update Alternate Selection" />
	</span>
	Top ##TP_NumTopX## Spots
	</th>
</tr>
<tr>
	<td class="colhead"></td>
	<td class="colhead">Category</td>
	<td class="colhead">Class</td>
	<td class="colhead">Event Type</td>
	<td class="colhead">Event</td>
	<td class="colhead">Market</td>
	<td class="colhead">Selection</td>
	<td class="colhead"><a href="?action=ADMIN::TOPX::GoTopx&sort=spots&view=##TP_View##">Act. Spots</a></td>
	<td class="colhead"><a href="?action=ADMIN::TOPX::GoTopx&sort=weight&view=##TP_View##">Man. Inc.</a></td>
	<td class="colhead"><a href="?action=ADMIN::TOPX::GoTopx&sort=total&view=##TP_View##">Total</a></td>
	<td class="colhead"></td>
</tr>

##TP_LOOP topx_idx {[tpGetVar NumTopX]}##
<tr>
	<td>##TP_TCL {expr {[tpGetVar topx_idx] + 1}}##.</td>
	<td>##TP_TopxCategory##</td>
	<td>##TP_TopxClass##</td>
	<td>##TP_TopxType##</td>
	<td>##TP_TopxEvent##</td>
	<td><a href="?action=ADMIN::TOPX::Select&market=##TP_TopxMarketId##&view=##TP_View##">##TP_TopxMarket##</a></td>
	<td>##TP_TopxSelection##</td>
	<td>##TP_TopxSpots##</td>
	<td><input type="text" size="5" name="weight_##TP_TopxOcId##" value="##TP_TopxWeight##" /></td>
	<td>##TP_TopxTotal##</td>
	<td><input type="button" class="btn_def" onClick="SubmitWeight(this,'UpdateWeight',##TP_TopxOcId##)" value="Update" /></td>
</tr>
##TP_ENDLOOP##

<tr>
<td colspan="11" class="buttons">
	<span style="float:right;">
		<input type="button" class="btn_def" onClick="fs(this,'GoHierarchy')"
			value="Update Alternate Selection" />
	</span>
</td>
</tr>

</table>

<br/>

##TP_COMMENT ----------------------------------------------------------------##
##TP_COMMENT                                      Search Tolerances Settings ##
##TP_COMMENT ----------------------------------------------------------------##

##TP_IF {[tpGetVar show_search_tolerance 0] == 1}##
<table width="300">
<tr>
	<th colspan="11" class=title>Search Tolerances</th>
</tr>
<tr>
	<td class="colhead"></td>
	<td class="colhead">Name</td>
	<td class="colhead">Value</td>
</tr>
<tr>
	<td colspan="3" class="colhead">Tolerances</td>
</tr>
<tr>
	<td></td>
	<td>Init</td>
	<td><input id="tolerance_init" name="tolerance_init" type="text" size="3" value="##TP_TOLERANCE_INIT##" onChange="checkToleranceLimit(this.id, this.value, ##TP_ToleranceLimit##, ##TP_TOLERANCE_INIT##, 'Value must be a number between 0 and ##TP_ToleranceLimit##')"</input></td>
</tr>
<tr>
	<td></td>
	<td>Narrow</td>
	<td><input id="tolerance_narrow" name="tolerance_narrow" type="text" size="3" value="##TP_TOLERANCE_NARROW##" onChange="checkToleranceLimit(this.id, this.value, ##TP_ToleranceLimit##, ##TP_TOLERANCE_NARROW##, 'Value must be a number between 0 and ##TP_ToleranceLimit##')"</input></td>
</tr>
<tr>
	<td></td>
	<td>Wide</td>
	<td><input id="tolerance_wide" name="tolerance_wide" type="text" size="3" value="##TP_TOLERANCE_WIDE##" onChange="checkToleranceLimit(this.id, this.value, ##TP_ToleranceLimit##, ##TP_TOLERANCE_WIDE##, 'Value must be a number between 0 and ##TP_ToleranceLimit##')"</input></td>
</tr>
<tr>
	<td colspan="3" class="colhead">Popularity</td>
</tr>
<tr>
	<td></td>
	<td>Init</td>
	<td><input id="popularity_init" name="popularity_init" type="text" size="3" value="##TP_POPULARITY_INIT##" onChange="checkToleranceLimit(this.id, this.value, ##TP_PopularityLimit##, ##TP_POPULARITY_INIT##, 'Value must be a number between 0 and ##TP_PopularityLimit##')"</input></td>
</tr>
<tr>
	<td></td>
	<td>Narrow</td>
	<td><input id="popularity_narrow" name="popularity_narrow" type="text" size="3" value="##TP_POPULARITY_NARROW##" onChange="checkToleranceLimit(this.id, this.value, ##TP_PopularityLimit##, ##TP_POPULARITY_NARROW##, 'Value must be a number between 0 and ##TP_PopularityLimit##')"</input></td>
</tr>
<tr>
	<td></td>
	<td>Wide</td>
	<td><input id="popularity_wide" name="popularity_wide" type="text" size="3" value="##TP_POPULARITY_WIDE##" onChange="checkToleranceLimit(this.id, this.value, ##TP_PopularityLimit##, ##TP_POPULARITY_WIDE##, 'Value must be a number between 0 and ##TP_PopularityLimit##')"</input></td>
</tr>
<tr>
	<td colspan="3">
		<span style="float:right;">
			<input type="button" class="btn_def" onClick="fs(this,'UpdateTopXConf')" value="Update Values" />
		</span>
	</td>
</tr>
</table>
##TP_ENDIF##

</form>
</body>
</html>

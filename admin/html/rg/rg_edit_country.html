<html>
<!-- $Id: rg_edit_country.html -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>OpenBet Administration</title>
<script language="Javascript">

// Look after older browser which use JScript instead of DOM
if (document.all && !document.getElementById) {
  document.getElementById = function(id) {
  return document.all[id];
  }
}


function add(from, to)
{
	var selectFrom = this.document.getElementById(from);
	var selectTo = this.document.getElementById(to);
	var selectedList = new Array();
	var leftoverList = new Array();

	// build list of selected items
	var selectedListIndex = 0;
	var oldListIndex = 0;
	for (var i = 0; i < selectFrom.options.length; i++) {
		if (selectFrom.options[i].selected) {
	    selectedList[selectedListIndex++] = selectFrom.options[i].value;
		}
	  else {
	    leftoverList[oldListIndex++] = selectFrom.options[i].value;
	  }
	}

	if (selectTo.options.length == 0) {
	  // empty list, we can add the items as we like...
	  for (var i = 0; i < selectedListIndex; i++) {
	    selectTo.options[i] = new Option(selectedList[i], selectedList[i], false, false);
	  }
	}
	else
	{
	  // existing list, need to find where to add new entry/entries
	  for (var k = 0; k < selectedList.length; k++) {
  	  for (var i = 0; i < selectTo.options.length; i++) {
	      if (selectTo.options[i].value > selectedList[k]) {
	        // need to move down the rest of the list to fit entry in here
	        var oldValue = "";
	        var nextOldValue = "";
	        var oldSelectToLength = selectTo.options.length;
	        for (var j = i + 1; j < oldSelectToLength + 1; j++) {
	          if (nextOldValue == "") {
  	          oldValue = selectTo.options[j - 1].value;
	          }
	          else
	          {
	            oldValue = nextOldValue;
	          }
	          if (j > selectTo.options.length - 1) {
  	          nextOldValue = "";
	          }
	          else
	          {
	            nextOldValue = selectTo.options[j].value;
	          }
	          selectTo.options[j] = new Option(oldValue, oldValue, false, false);
	        }
 	        // now insert the new selection
       	  selectTo.options[i] = new Option(selectedList[k], selectedList[k], false, false);
	        break;
	      }
	      if (i == selectTo.options.length - 1) {
	        // got as far as last position without finding somewhere to insert the
	        // new entry so just add it at the bottom
	        selectTo.options.length++;
	        selectTo.options[i + 1] = new Option(selectedList[k], selectedList[k], false, false);
	        break;
	      }
	    }
	  }
	}

	// create new list of left behind items
	selectFrom.options.length = oldListIndex;
	for (var i = 0; i < selectFrom.options.length; i++) {
		selectFrom.options[i] = new Option(leftoverList[i], leftoverList[i], false, false);
	}

	return true;
}

function remove(from, to)
{
	add(to, from);
	return true;
}

function save(b, to)
{
	var selectTo = this.document.getElementById(to);

	// make all the options in the 'selected' side selected.
	for (var i = 0; i < selectTo.options.length; i++) {
	  selectTo.options[i].selected = true;
	}

	b.form.action.value = "ADMIN::RISKGUARDIAN::GoInsertCondition";
	b.form.type.value = "country";
	b.form.submit();

	return true;
}
</script>
</head>
<body>
##TP_PLAY error_rpt.html##
##TP_PLAY msg_rpt.html##
<table cellspacing=0 cellpadding=2 border=0>
<form method="get" name="countryForm" action="##TP_CGI_URL##">
<input type="hidden" name="action" value="">
<input type="hidden" name="type" value="">
<tr>
	<th colspan="3" class="title">
	Risk Guardian Country Condition
	</th>
</tr>
<tr>
	<th>Deselected Countries</th>
	<th>&nbsp;</th>
	<th>Selected Countries</th>
</tr>
<tr>
	<td>
	  <select id="from" multiple name="from" size="15">
	  ##TP_LOOP availCountry_idx {[tpGetVar numAvailCountries]}##
	    <option value="##TP_availCountry##">##TP_availCountry##</option>
	  ##TP_ENDLOOP##
	  </select>
  </td>
	<td>
	  <table>
	    <tr>
	      <td align="center"><input type="button" value="add ->" onClick="return add('from','to');"></td>
	    </tr>
	    <tr>
	      <td align="center"><input type="button" value="<- remove" onClick="return remove('from','to');"></td>
	    </tr>
	  </table>
	</td>
  <td>
	  <select id="to" multiple name="to" size="15">
	  ##TP_LOOP selCountry_idx {[tpGetVar numSelectedCountries]}##
	    <option value="##TP_selectedCountry##">##TP_selectedCountry##</option>
	  ##TP_ENDLOOP##
	  </select>
	</td>
</tr>
<tr>
	<td colspan="3" align="center"><input type="button" value="Submit Changes" onClick="return save(this,'to');"></td>
</tr>
</form>
</table>
</body>
</html>


<html>
<!-- $Id: jockeytrainer.html,v 1.1.1.1 2011/10/04 10:54:25 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>Jockeys/Trainers</title>

##TP_PLAY header_cal.html##

##TP_PLAY JS_WriteSelect.html##
<script>

function date_fs(b,t)
{
	document.forms.dateform.SubmitName.value=t;
	document.forms.dateform.submit();
	return true;
}

##TP_IF {[op_allowed ManageEv]}##
	function fs(b,t)
	{
		b.form.SubmitName.value=t;
		b.form.submit();
		return true;
	}
##TP_ENDIF##

function displayCalendars() {
	new Calendar(document.forms.dateform.event_date,null,false,"lo")
}
</script>

</head>
<body onload="displayCalendars()">
<h1>Key Jockeys/Trainers</h1>
<p>Please select the races date:</p>
##TP_PLAY msg_rpt.html##

<form name="dateform" action="##TP_CGI_URL##" method="post">
	<input type="text" size=12 name="event_date" value="##TP_event_date##">
	<input type="hidden" name="SubmitName" value="" />
	<input type="hidden" name="action" value="ADMIN::JOCKEYTRAINER::goJockeyTrainer" />
	<input type="button" class="btn_def" value="Select date" onClick="return date_fs(this,'goJockeyTrainer') " />
</form>

##TP_IF {[tpGetVar num_jocks] > 0}##
	<form action="##TP_CGI_URL##" method="post">
		<table border=0 cellspacing=0 cellpadding=3>
		<tr>
			<th colspan=6 class=title>
			Jockeys
			</th>
		</tr>
		<tr>
			<th class=colhead>Name</th>
			<th class=colhead>Is key Jockey</th>
			<th class=colhead>Name</th>
			<th class=colhead>Is key Jockey</th>
			<th class=colhead>Name</th>
			<th class=colhead>Is key Jockey</th>
		</tr>

		##TP_FOREACH row {[bucketise_jockeys $JOCKEYS(nrows)]}##
		<tr>
			##TP_TCL {tpSetVar cellCnt 0}##
			##TP_FOREACH j_idx {[tpGetVar row]}##
				##TP_IF {[tpBindGet j_name] != ""}##
					##TP_TCL {tpSetVar cellCnt [expr {[tpGetVar cellCnt]+1}]}##
					<td>##TP_j_name##</td>
					<td><input type="checkbox" value="Y" name="KEY_JOCK_##TP_j_name##" ##TP_key_jockey## /></td>
				##TP_ELSE##
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				##TP_ENDIF##
			##TP_ENDFOREACH##

			##TP_IF {[expr [tpGetVar cellCnt]%3]}##
				##TP_TCL {tpSetVar emptyCells [expr {3-([tpGetVar cellCnt]%3)}]}##
				##TP_LOOP loop_iter {[tpGetVar emptyCells]}##
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				##TP_ENDLOOP##
			##TP_ENDIF##
		</tr>
		##TP_ENDFOREACH##

		</table>

		##TP_IF {[op_allowed ManageEv]}##
			<input type="hidden" name="event_date" value="##TP_event_date##">
			<input type="hidden" name="key_jockey_list" value="##TP_key_jockey_list##" />
			<input type="hidden" name="SubmitName" value="" />
			<input type="hidden" name="action" value="ADMIN::JOCKEYTRAINER::doJockey" />
			<input type="button" class="btn_def" value="Update Jockeys" onClick="return fs(this,'doJockey') " />
		##TP_ENDIF##
	</form>
##TP_ELSE##
	<p>Sorry, there are no jockeys for this date</p>
##TP_ENDIF##

<br />

##TP_IF {[tpGetVar num_trains] > 0}##
<form action="##TP_CGI_URL##" method="post">
	<table border=0 cellspacing=0 cellpadding=3>
	<tr>
		<th colspan=6 class=title>
		Trainers
		</th>
	</tr>
	<tr>
		<th class=colhead>Name</th>
		<th class=colhead>Is key Trainer</th>
		<th class=colhead>Name</th>
		<th class=colhead>Is key Trainer</th>
		<th class=colhead>Name</th>
		<th class=colhead>Is key Trainer</th>
	</tr>
		##TP_FOREACH row {[bucketise_jockeys $TRAINERS(nrows)]}##
		<tr>
			##TP_TCL {tpSetVar cellCnt 0}##
			##TP_FOREACH t_idx {[tpGetVar row]}##
				##TP_IF {[tpBindGet t_name] != ""}##
					##TP_TCL {tpSetVar cellCnt [expr {[tpGetVar cellCnt]+1}]}##
					<td>##TP_t_name##</td>
					<td><input type="checkbox" value="Y" name="KEY_TRAIN_##TP_t_name##" ##TP_key_trainer## /></td>
				##TP_ELSE##
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				##TP_ENDIF##
			##TP_ENDFOREACH##

			##TP_IF {[expr [tpGetVar cellCnt]%3]}##
				##TP_TCL {tpSetVar emptyCells [expr {3-([tpGetVar cellCnt]%3)}]}##
				##TP_LOOP loop_iter {[tpGetVar emptyCells]}##
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				##TP_ENDLOOP##
			##TP_ENDIF##
		</tr>
		##TP_ENDFOREACH##
	</table>
	##TP_IF {[op_allowed ManageEv]}##
		<input type="hidden" name="event_date" value="##TP_event_date##">
		<input type="hidden" name="key_trainer_list" value="##TP_key_trainer_list##" />
		<input type="hidden" name="SubmitName" value="" />
		<input type="hidden" name="action" value="ADMIN::JOCKEYTRAINER::doTrainer" />
		<input type="button" class="btn_def" value="Update Trainers" onClick="return fs(this,'doTrainer') " />
	##TP_ENDIF##
</form>
##TP_ELSE##
	<p>Sorry, there are no trainers for this date</p>
##TP_ENDIF##
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- $Id: event.html,v 1.1.1.1 2011/10/04 10:54:25 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>Update Event</title>
##TP_PLAY header_cal.html##
##TP_PLAY JS_WriteSelect.html##

<script language=JavaScript>

var errorList = "";

function add_err(e_str)
{
	if (errorList.length > 0) {
		errorList += "\n";
	}
	errorList += e_str;
}

function write_tr(settled,result_conf,status,displayed)
{
	if (settled == 'Y') {
		document.write('<tr class=settled>');
	} else if (result_conf == 'Y') {
		document.write('<tr class=confirmed>');
	} else if (status == 'S') {
		document.write('<tr class=suspended>');
	} else if (status == 'C') {
		document.write('<tr class=configure>');
	} else if (displayed == 'N') {
		document.write('<tr class=hidden>');
	} else {
		document.write('<tr class=active>');
	}
}
function displayCalendars() {
	new Calendar(document.forms.DoEvent.EvStartTime,null,true,"lo")
	new Calendar(document.forms.DoEvent.EvEstStartTime,null,true,"lo")
	new Calendar(document.forms.DoEvent.EvSuspendAt,null,true,"lo")
	new Calendar(document.forms.DoEvent.EvSettleAtSPFrom,null,true,"lo")
	new Calendar(document.forms.DoEvent.EvSettleAtSPTo,null,true,"lo")
}

function displayRow(name){
	var row = document.getElementById(name);
	if (row.style.display == '') row.style.display = 'none';

	else row.style.display = '';
}


function validate(f)
{
	var desc       = strTrim(f.EventDesc.value, " ");
	var country    = f.EventCountry.value;
	var venue      = f.EventVenue.value;
//	var start_time = f.StartTime.value;
	var least_max_bet = f.LeastMaxBet.value;
	var most_max_bet  = f.MostMaxBet.value;
	var lay_to_lose   = f.LayToLose.value;
##TP_IF {![tpGetVar Confirmed 0]}##
	var min_bet    = f.MinBet.value;
	var max_bet    = f.MaxBet.value;
	var bet_cutoff = f.BetCutoff.value;
##TP_ENDIF##

	errorList = "";

	if (desc.length == 0) {
		add_err("description cannot be empty");
	}
//	if (!isDateTime(start_time)) {
//		add_err("start time is invalid - must be YYYY-MM-DD HH:MM:SS");
//	}
##TP_IF {![tpGetVar Confirmed 0]}##
	if ((min_bet.length > 0) && (!isMoney(min_bet, false))) {
		add_err("min bet is invalid - must be a money quantity");
	}
	if ((max_bet.length > 0) && (!isMoney(max_bet, false))) {
		add_err("max bet is invalid - must be a money quantity");
	}
	if ((min_bet.length > 0) && (max_bet.length > 0)) {
		if (isMoney(min_bet, false) && isMoney(max_bet, false)) {
			if (parseFloat(min_bet) > parseFloat(max_bet)) {
				add_err("min bet is bigger than max bet");
			}
		}
	}
	if ((bet_cutoff.length > 0) && (!isHMSinterval(bet_cutoff))) {
		add_err("bet cutoff is invalid - must be HH:MM:SS");
	}
##TP_ENDIF##

	if (errorList != "") {
		alert("There are some errors in the form:\n\n" + errorList);
		return false;
	}
	return true;
}

function write_mkt_ew(allowed,places,num,den)
{
	document.write(allowed);

	if (allowed == "Y") {
		document.write(" ["+places+" places, "+num+"/"+den+" win odds]");
	}
}


##TP_IF {[OT_CfgGetTrue FUNC_CONF_CRIT_EV_CHNG]}##
var need_admin_conf = 1;
var init_EvStartTime = "##TP_EvStartTime##";
var init_EvStatus    = "##TP_EvStatus##"
##TP_ELSE##
var need_admin_conf = 0;
##TP_ENDIF##

var ev_form;

function set_aux_conf(u,p,l)
{
	ev_form.AuxAdminName.value = u;
	ev_form.AuxAdminPwd.value  = p;
	ev_form.AuxLoginUID.value  = l;

	ev_form.SubmitName.value="EvMod";
	ev_form.submit();
	return true;
}

function fs(b,t)
{
	var get_conf = 0;

	ev_form = b.form;

	if (need_admin_conf == 1 && t == "EvMod") {
		var cur_EvStartTime = ev_form.EvStartTime.value;
		var cur_EvStatus;

		if (ev_form.EvStatus.type == "hidden") {
			cur_EvStatus = ev_form.EvStatus.value;
		} else {
			cur_EvStatus = ev_form.EvStatus.options[ev_form.EvStatus.selectedIndex].value;
		}

		if ((cur_EvStartTime != init_EvStartTime) ||
			(cur_EvStatus == "A" && init_EvStatus == "S")) {
			get_conf = 1;
		}
	}

	##TP_IF {[OT_CfgGet FUNC_AMALCO 0]}##
	if (t == "SendIncident") {
		document.getElementById("action").value = "ADMIN::AMALCO::go_incidents";
	}
	##TP_ENDIF##

	if (get_conf) {
		window.open
			("##TP_CGI_URL##?action=ADMIN::EVENT::GoCritEvConf",
			 "additional_confirmation",
			 "toolbar=false,location=false,directories=false,menubar=false,resizable=true,width=300,height=150");
		return false;
	}

	##TP_IF {[OT_CfgGet FUNC_MBS 0]}##
		var mbs = mbs_check();
		if (mbs == false) {
			return false;
		}
	##TP_ENDIF##

	b.disabled = true;
	b.value = "Busy...";
	if (t == "Back") {
		history.back();
	} else {
		b.form.SubmitName.value=t;
		b.form.submit();
	}
	return true;
}
function showMSBlist(EvId)
{
window.location="##TP_CGI_URL##?action=ADMIN::MARKET::DispMktMBS&EvId=" + EvId;
}

function TeamEventPopup()
{
	window.open("##TP_CGI_URL##?action=ADMIN::TEAMPLAYER::GoTeamEvent",
		"teams",
		"toolbar=no,location=no,directories=no,menubar=no,resizable=yes,width=450,height=300");
}



function EventResults()
{
	window.open("##TP_CGI_URL##?action=ADMIN::EVENT::GoShowEvResults&ClassSort=##TP_ClassSort##&EvId=##TP_EvId##&EvDesc=##TP_ESC esc_js####TP_EvDesc####TP_ESC##&StartTime=##TP_EvStartTime##",
		"results_window",
		"toolbar=yes,status=yes,scrollbars=yes,resizable=yes,width=600,height=400");
}

function blurb_popup (id, sort) {
	if (id == "") {
		alert("No Id specified, does the "+sort+" exist.\n"+
			"You must create it before you can add a blurb");
		return;
	}

	window.open("##TP_CGI_URL##?action=ADMIN::BLURB::do_blurb&ref_id="+id+"&sort="+sort,
		"Blurb",
		"toolbar=no,location=no,directories=no,menubar=no,resizable=yes,width=600,height=200");
}

function CheckClear(b)
{

	##TP_COMMENT Add a confirmation popup if the event has not started yet##
	##TP_IF {![tpGetVar AfterEventStart 0]}##
	var r = confirm("Warning : This event is has not started yet.\n\nAre you sure you want to attempt to clear?");
	if (r == false) {
		return false;
	}
	##TP_ENDIF##

	return fs(b,'DoClearEv');

}
function clearcommentary() {
	var answer = confirm("Are you sure you want to attempt to clear the commentary?")
	if (answer){
		window.location = "##TP_CGI_URL##?action=ADMIN::COMM::ClearCommentary&EvId=##TP_EvId##&ClassId=##TP_ClassId##&settled=##TP_settled##&type_id=##TP_type_id##";
	}
}
function go_form_feed ()
{
	var form_provider_id = document.DoEvent.form_provider_id.value;

	if (form_provider_id == "") {
		return false;
	}

	document.location.href = '##TP_CGI_URL##?action=ADMIN::FORM::GoRace&EvId=##TP_EvId##&FormProviderId=' + form_provider_id;
}

function clear_home_and_away_id ()
{
	document.DoEvent.EvHomeTeamId.value = "";
	document.DoEvent.EvAwayTeamId.value = "";
}

function check_name_length()
{
	var ev_name = document.getElementById('EvDesc').value;
	if (ev_name.length > 80) {
		alert('An event name cannot be longer than 80 characters long.\nYour event name has been truncated to 80 characters.');
		document.getElementById('EvDesc').value = ev_name.substr(0,80);
	}
}

// display alert if we will be changing late bet tolerance value
function check_isoff_change() {
	##TP_IF {[OT_CfgGet FUNC_OFF_FLAG_UPDATES_LBT 0] && [tpGetVar AfterEventStart 0]}##
		var is_off_old = document.DoEvent.EvIsOffOldValue.value;
		var is_off_new = document.DoEvent.EvIsOff.value;

		if (is_off_old == "N" && is_off_new == "Y") {
			alert('The late bet tolerance value will be amended to allow any bets placed until now to be automatically settled.');
		}
	##TP_ENDIF##

	return;
}

##TP_IF {[string first DISP_ORDER [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##

var event_form = document.DoEvent;

function ViewDispPopup(id,name)
{
	window.open("##TP_CGI_URL##?action=ADMIN::VIEWS::GoViewDisporders&id="+id+"&sort=EVENT&name="+name,
		"Views",
		"toolbar=no,location=no,directories=no,menubar=no,scrollbars=yes,resizable=yes,width=300,height=300");
}

##TP_ENDIF##
##TP_IF {[OT_CfgGet FUNC_MBS 0]}##

	function mbs_check()
	{
		// Show warning if a langauge hasn't been selected when the money back checkbox is checked

		var langs = new Array();

		##TP_LOOP lang_idx {[tpGetVar NumLangs]}##
			langs[##TP_TCL {tpBufWrite [tpGetVar lang_idx]}##] = "##TP_LangCode##";
		##TP_ENDLOOP##

		var mbs_checked = document.getElementById('MBS').checked;
		var mbs_lang_checked = false;

		for(i = 0, l = langs.length; i < l; i++) {
			if (document.getElementById('MBS_LANG_' + langs[i]).checked == true)
			{
				mbs_lang_checked = true;
			}
		}

		if (mbs_checked==true && mbs_lang_checked!=true)
		{
			var is_ok  = confirm("##TP_XL {Admin.Event.MBS_ERROR}##");
			return is_ok;
		} else
		{
			return true;
		}

	}

##TP_ENDIF##

</script>

</head>
<body onload="displayCalendars()">

##TP_IF {[tpGetVar EvAdded 0]}##
	<h3><font color=green>New Event Added</font></h3>
##TP_ENDIF##

##TP_IF {[tpGetVar EvUpdated 0]}##
	<h3><font color=green>Event Updated</font></h3>
##TP_ENDIF##

##TP_IF {[tpGetVar opAdd 0]}##
	##TP_TCL {tpSetVar Confirmed 0}##
	##TP_TCL {tpSetVar AfterEventStart 0}##
##TP_ENDIF##

##TP_PLAY msg_rpt.html##
##TP_PLAY error_rpt.html##
##TP_PLAY msg_rpt.html##

<table cellspacing=0 cellpadding=2 border=0>
<form name=DoEvent method=get action="##TP_CGI_URL##" onSubmit="return validate(this);">
<input type="hidden" name="EvHomeTeamId" value="##TP_EvHomeTeamId##">
<input type="hidden" name="EvAwayTeamId" value="##TP_EvAwayTeamId##">
<input type="hidden" name="EvMaxLayToLose" value="##TP_EvMaxLayToLose##">
<tr>
	<th class=title colspan=2>
	##TP_ClassName##,&nbsp;##TP_TypeName##
	</th>
</tr>
##TP_IF {[tpGetVar FuncShowDDId 0] && ![tpGetVar opAdd 0]}##
	<tr>
		<td class="caption">Event Identifier</td>
		<td>##TP_EvId##</td>
	</tr>
##TP_ENDIF##
<tr>
	<td class=caption>Name</td>
	<td>
	<input type=text name=EvDesc id=EvDesc value="##TP_EvDesc##" size=50 onchange="clear_home_and_away_id();check_name_length();"> <i>(maximum of 80 characters)</i>
	##TP_IF {[tpGetVar opAdd 0]}##
		##TP_IF {[OT_CfgGet FUNC_TEAM_PLAYER 0]}##
			##TP_IF {[string first [tpGetVar ClassSort] "HR/GR"] < 0}##
				<input type=button class="btn_def" value="Teams ..." onclick="TeamEventPopup()">
			##TP_ENDIF##
		##TP_ENDIF##
	##TP_ENDIF##
	</td>
</tr>
##TP_IF {[string first DISP_ORDER [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
<tr>
	<td class=caption>Display Orders</td>
	<td>
		<input type=button class="btn_def" value="Set View Disporders" onclick="ViewDispPopup('##TP_EvId##','##TP_EvDesc##')">
	</td>

</tr>
##TP_ENDIF##
##TP_IF {![tpGetVar opAdd 0] && [OT_CfgGet FUNC_GEN_EV_CODE 0]}##
	<tr>
		<td class=caption>Event Code</td>
		<td>
			<input type=text name=EvCode value="##TP_EvCode##" size=4>
		</td>
	</tr>
##TP_ENDIF##


##TP_IF {[OT_CfgGet SHOW_HIDE_TV_CHANNELS_OPTION 0]}##
<tr>
	<td class=caption></td>
	<td><input type="button" onclick="displayRow('channels')" value="Show/Hide TV Channels" /></td>
</tr>
##TP_ENDIF##

<tr>
	<td class=caption>Auto Traded</td>
	<td><script>write_which('##TP_EvAutoTraded##','Y','Yes','N','No');</script></td>
</tr>

##TP_IF {[OT_CfgGetTrue FUNC_TVCHANNELS]}##
##TP_IF {[tpGetVar NumEvTVChans 0] > 0}##
	<tr id="channels" ##TP_IF {[OT_CfgGet SHOW_HIDE_TV_CHANNELS_OPTION 0]}## style="display:none" ##TP_ENDIF##>
		<td class=caption>TV Channel</td>
		<td>
		<table cellspacing=0 cellpadding=0 border=0>
		##TP_LOOP ev_tvchan_idx {[expr {4*(([tpGetVar NumEvTVChans]+3)/4)}]}##
			##TP_IF {[tpGetVar ev_tvchan_idx]%4 == 0}##
				<tr>
			##TP_ENDIF##
			##TP_IF {[tpGetVar ev_tvchan_idx]<[tpGetVar NumEvTVChans]}##
				<td>
				<input type=checkbox name="CHANNELTAG_##TP_EvTVChanId##" ##TP_EvTVChanSelected##>
				##TP_EvTVChanDesc##
				</td>
			##TP_ELSE##
				<td>&nbsp;</td>
			##TP_ENDIF##
			##TP_IF {([tpGetVar ev_tvchan_idx]+1)%4 == 0}##
				</tr>
			##TP_ENDIF##
		##TP_ENDLOOP##
		</table>
		</td>
	</tr>
##TP_ENDIF##
##TP_ENDIF##

##TP_IF {[OT_CfgGet SHOW_HIDE_STATIONS_OPTION 0]}##
<tr>
	<td class=caption></td>
	<td><input type="button" onclick="displayRow('stations')" value="Show/Hide TV Stations" /></td>
</tr>
##TP_ENDIF##
##TP_IF {[OT_CfgGetTrue FUNC_STATIONS]}##
	<tr id="stations" ##TP_IF {[OT_CfgGet SHOW_HIDE_STATIONS_OPTION 0]}## style="display:none" ##TP_ENDIF##>
		<td class="caption">TV Stations</td>
		<td>
		##TP_PLAY station_sel.html##
		</td>
	</tr>
##TP_ENDIF##
##TP_IF {[string first SHORTCUT [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
	<tr>
		<td class=caption>Event Shortcut</td>
	   	<td>
			<input type=text name=EvShortcut value="##TP_EvShortcut##" size=2>
		</td>
	</tr>
##TP_ENDIF##
##TP_IF {[string first VENUE [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
	<tr>
		<td class=caption>Venue</td>
		<td>
		<input type=text name=EvVenue value="##TP_EvVenue##" size=60>
		</td>
	</tr>
##TP_ENDIF##
##TP_IF {[string first COUNTRY [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
	<tr>
		<td class=caption>Country</td>
		<td>
		<input type=text name=EvCountry value="##TP_EvCountry##" size=60>
		</td>
	</tr>
##TP_ENDIF##
##TP_IF {[string first RESULT [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
	##TP_IF {[tpGetVar AfterEventStart 0] || [tpGetVar Confirmed]}##
		<tr>
			<td class=caption>Result</td>
			<td>
			<input type=text name=EvResult value="##TP_EvResult##" size=40>
			</td>
		</tr>
	##TP_ENDIF##
##TP_ENDIF##
##TP_IF {[tpGetVar ClassSort]=="FB" && ![tpGetVar opAdd 0]}##
	<tr>
		<td class=caption>Home Team</td>
		<td>##TP_EvHomeTeam##</td>
	</tr>
	<tr>
		<td class="caption">Away Team
		<td>##TP_EvAwayTeam##</td>
	</tr>
##TP_ENDIF##
<tr>
	<td class=caption>Sort</td>
	<td>
	<select name=EvSort>
	<script>
	write_select('##TP_EvSort##'
		,'MTCH','Match'
		,'TNMT','Tournament'
		##TP_LOOP ev_sort_idx {[tpGetVar NumEvSorts]}##
			,'##TP_EvSortCode##','##TP_EvSortName##'
		##TP_ENDLOOP##
	)
	</script>
	</select>
	##TP_IF {[tpGetVar ClassSort]=="FB"}##
		##TP_IF {[tpGetVar NumDomains 0] > 1}##
			&nbsp;&nbsp;
			<b>Domain</b>
			<select name=EvFBDomain>
			<script>
				write_select('##TP_EvFBDomain##'
					,'-','unset'
					##TP_LOOP domain_idx {[tpGetVar NumDomains]}##
						,"##TP_DomainFlag##","##TP_DomainName##"
					##TP_ENDLOOP##
					)
			</script>
			</select>
		##TP_ELSE##
			##TP_TCL -quiet {tpSetVar domain_idx 0}##
			<input type=hidden name=EvFBDomain value="##TP_DomainFlag##">
		##TP_ENDIF##
	##TP_ELSE##
		<input type=hidden name=EvFBRiskCat value="-">
		<input type=hidden name=EvFBDomain  value="-">
	##TP_ENDIF##
	</td>
</tr>
##TP_IF {[string first MULTKEY [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
	<tr>
		<td class=caption>Multiples key</td>
		<td>

		<input name=EvMultKey type=text size=8 value="##TP_EvMultKey##">

		##TP_IF {[string first EXTKEY [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
			&nbsp;&nbsp;&nbsp;
			<b>External link key</b>
			<input name=EvExtKey type=text size=10 maxlength=10 value="##TP_EvExtKey##">
		##TP_ENDIF##
		</td>
	</tr>
##TP_ELSEIF {[string first EXTKEY [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
	<tr>
		<td class=caption>External link key</td>
		<td><input name=EvExtKey type=text size=10 maxlength=10 value="##TP_EvExtKey##"></td>
	</tr>
##TP_ENDIF##

##TP_IF {[tpGetVar NumEvTags 0]>0}##
	<tr>
		<td class=caption>Flags</td>
		<td class="table">
		<table cellspacing=0 cellpadding=0 border=0>
		##TP_LOOP ev_tag_idx {[expr {4*(([tpGetVar NumEvTags]+3)/4)}]}##
			##TP_IF {[tpGetVar ev_tag_idx]%4 == 0}##
				<tr>
			##TP_ENDIF##
			##TP_IF {[tpGetVar ev_tag_idx]<[tpGetVar NumEvTags]}##
				<td>
				<input type=checkbox name="EVTAG_##TP_EvTagCode##" ##TP_EvTagSel##>
				##TP_EvTagName##
				</td>
			##TP_ELSE##
				<td>&nbsp;</td>
			##TP_ENDIF##
			##TP_IF {([tpGetVar ev_tag_idx]+1)%4 == 0}##
				</tr>
			##TP_ENDIF##
		##TP_ENDLOOP##
		</table>
		</td>
	</tr>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_BIR_DELAY 0]}##
	<tr>
		<td class=caption>BIR delay</td>
		<td>
			<input type=text name="EvBirDelay" value="##TP_EvBirDelay##" size=4>&nbsp;(sec)&nbsp; ##TP_IF {[tpGetVar displayBIRHierarchy 0]}## (##TP_BIRHierarchyVal## sec from ##TP_BIRHierarchy##) ##TP_ENDIF##
		</td>
	</tr>
##TP_ENDIF##

<tr>
	<td class=caption>Displayed</td>
	<td>
		<select name=EvDisplayed>
			<script>
			write_select('##TP_EvDisplayed##','Y','Yes','N','No')
			</script>
		</select>

		&nbsp;&nbsp;&nbsp;<b>Feed updateable</b>
		<select name=EvFeedUpdateable>
			<script>
			write_select('##TP_EvFeedUpdateable##','-','N/A','Y','Yes','N','No','E','Event-Only (no EW)','P','No Price Update')
			</script>
		</select>
	</td>
</tr>

##TP_IF {[string first URL [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
	<tr>
		<td class=caption>Information URL</td>
		<td>
		<input type=text name=EvURL value="##TP_EvURL##" size=60 maxlength=120>
		</td>
	</tr>
##TP_ENDIF##
<tr>
	<td class=caption>Start Time</td>
	<td>
	##TP_IF {[tpGetVar Confirmed 0]}##
		##TP_EvStartTime##
		<input name=EvStartTime type=hidden value="##TP_EvStartTime##">
	##TP_ELSE##
		<input name=EvStartTime type=text size=19 value="##TP_EvStartTime##">
		##TP_IF {([OT_CfgGet IS_OFF_ALL_CLASSES "N"] == "Y") || ([string first [tpGetVar ClassSort] "HR/GR/PL"]>=0)}##
			&nbsp;&nbsp;&nbsp;<b>Off ?</b>
			<input name=EvIsOffOldValue type="hidden" value="##TP_EvIsOff##">
			<select name=EvIsOff onchange="return check_isoff_change();">
			<script>
				write_select('##TP_EvIsOff##','-','N/A','N','No','Y','Yes')
			</script>
			</select>
		##TP_ELSE##
			<input type=hidden name=EvIsOff value="-">
		##TP_ENDIF##
	##TP_ENDIF##
	##TP_IF {[OT_CfgGet FUNC_INDEX_TRADE 0]}##
		&nbsp;<b>Close at: </b>
		##TP_IF {[tpGetVar Confirmed 0]}##
			##TP_EvStartTime##
			<input name=EvCloseTime type=hidden value="##TP_EvCloseTime##">
		##TP_ELSE##
			<input name=EvCloseTime type=text size=19 value="##TP_EvCloseTime##">
		##TP_ENDIF##
	##TP_ENDIF##
	</td>
</tr>
<tr>
	<td class="caption">Estimated Start Time</td>
	<td>
		<input name="EvEstStartTime" type="text" size="19" value="##TP_EvEstStartTime##">
		&nbsp;
		Used for the At The Races (ATR) video feeds
	</td>
</tr>

##TP_IF { [ OT_CfgGet DISPLAY_OFFICIAL_OFF 0 ] }##
	<tr>
		<td class=caption>Official Off Time</td>
		<td>
			##TP_EvOfficialOff##
		</td>
	</tr>
##TP_ENDIF##

<!-- Grey Hound non-runner/SP settlement price-->
##TP_IF {[OT_CfgGet FUNC_DOGS_SETTLE_VOID_SP 0]}## ##TP_COMMENT LBR196: If a dog is voided, settle prior bets on event as SP##
<tr>
	<td class=caption>Settle at SP</td>
	<td>
	From <input name=EvSettleAtSPFrom type=text size=19 value="##TP_EvSettleAtSPFrom##">&nbsp;
	To <input name=EvSettleAtSPTo type=text size=19 value="##TP_EvSettleAtSPTo##">
	</td>
</tr>
##TP_ENDIF##

<tr>
	<td class=caption>Suspend at</td>
	<td>
	##TP_IF {[tpGetVar Confirmed 0]}##
		##TP_EvSuspendAt##
		<input name=EvSuspentAt type=hidden value="##TP_EvSuspendAt##">
	##TP_ELSE##
		<input name=EvSuspendAt type=text size=19 value="##TP_EvSuspendAt##">
	##TP_ENDIF##
	</td>
</tr>

##TP_IF {![tpGetVar Confirmed 0]}##
	##TP_IF { [ OT_CfgGet LATE_BET_TOLERANCE 0 ] }##
	<tr>
		<td class=caption>Late bet tolerance</td>
		<td>
			<input name=EvNoMoreBetTime type=text size=19 value="##TP_EvNoMoreBetTime##">
			&nbsp;
			On settlement, legs on bets placed after that will be :
			<select name=EvNoMoreBetTimeOp>
				<script>
					write_select('##TP_EvNoMoreBetTimeOp##','','N/A','P','Settled normally and bet Parked','V','Voided','B','Voided and bet parked')
				</script>
			</select>
		</td>
	</tr>
	##TP_ENDIF##
	<tr>
		<td class=caption>Status</td>
		<td>
		<select name=EvStatus>
		<script>
			write_select('##TP_EvStatus##','A','Active','S','Suspended')
		</script>
		</select>
		</td>
	</tr>
	##TP_IF {[tpGetVar PERM_AssignTrader 0]}##
	<tr>
		<td class=caption>Trader</td>
		<td>
			<select name=EvTrader>
				<script>
					write_select('##TP_EvTrader##','-1','unset'
						##TP_LOOP trader_idx {[tpGetVar NumTraders]}##
						,"##TP_TraderID##","##TP_TraderName##"
						##TP_ENDLOOP##
					)
				</script>
			</select>
		</td>
	</tr>
	##TP_ENDIF##
	##TP_IF {[string first TAX_RATE [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
		<tr>
			<td class=caption>Tax rate</td>
			<td>
			<input name=EvTaxRate type=text size=5 value="##TP_EvTaxRate##">
			</td>
		</tr>
	##TP_ELSE##
		<input type=hidden name=EvTaxRate value="0.0">
	##TP_ENDIF##
	##TP_IF {[OT_CfgGet FUNC_LAY_TO_LOSE 0] && [OT_CfgGet FUNC_LAY_TO_LOSE_EV 0]}##
		<tr>
			<td class=caption>Lay to Lose</td>
			<td>
			<font color=#006666><i>Least Max Bet</i></font>
			<input name=LeastMaxBet type=text size=12 value="##TP_LeastMaxBet##">
			&nbsp;&nbsp;&nbsp;
			<font color=#006666><i>Most Max Bet</i></font>
			<input name=MostMaxBet type=text size=12 value="##TP_MostMaxBet##">
			##TP_IF {[tpGetVar EvMaxBetAvail] == 0}##
			<i>(##TP_TypeMostMaxBet##)</i>
			##TP_ENDIF##
			&nbsp;&nbsp;&nbsp;
			<font color=#006666><i>Lay To Lose</i></font>
			<input name="LayToLose" type=text size=12 value="##TP_LayToLose##">
			&nbsp;&nbsp;&nbsp;
		</tr>
		##TP_IF {![tpGetVar opAdd 0]}##
		<tr>
			<td class=caption align=right>&nbsp;</td>
			<td>
				<input type=button value="Generate/Update BIR" onclick="return fs(this,'GenUpdBIR')">
				<input type=button value="Generate/Update Pre-Match" onclick="return fs(this,'GenUpdPRE')">
			</td>
		</tr>
		##TP_ENDIF##
		<tr>
			<td class=caption>Liability Limit</td>
			<td><input name=Liability type=text size=12 value="##TP_Liability##">
		</tr>
		##TP_IF {![tpGetVar opAdd 0]}##
		<tr>
			<td class=caption align=right>&nbsp;</td>
			<td><input type=button value="Update" onclick="return fs(this,'LiabUpd')"></td>
		</tr>
		##TP_ENDIF##
	##TP_ENDIF##
	<tr>
		<td class=caption>Betting</td>
		<td>
		<font color=#006666><i>Min Bet</i></font>
		<input name=EvMinBet type=text size=12 value="##TP_EvMinBet##">
		&nbsp;##TP_IF {[tpGetVar opAdd 0]}##(##TP_MinBet##)##TP_ENDIF##&nbsp;&nbsp;
		<font color=#006666><i>##TP_IF {[OT_CfgGet FUNC_VARIABLE_MAX_STAKES_BY_TIME 0] && ([lsearch [OT_CfgGet VAR_MAX_STAKE_CLASSES ""] [tpGetVar ClassId]] != -1)}##Standard ##TP_ENDIF##Max Bet</i></font>
		<input name=EvMaxBet type=text size=12 value="##TP_EvMaxBet##">
		&nbsp;##TP_IF {[tpGetVar opAdd 0]}##(##TP_MaxBet##)##TP_ENDIF##
		##TP_IF {[OT_CfgGet FUNC_MAX_WIN_MULTIPLES 0]}##
			<br />
			<font color=#006666><i>Max Multiple Bet</i></font>
			<input name="EvMaxMultipleBet" type="text" size=12 value="##TP_EvMaxMultipleBet##">&nbsp;<i>(##TP_FinalMaxMultipleBet##)</i>
		##TP_ELSE##
			<input name="EvMaxMultipleBet" type="hidden" value="##TP_EvMaxMultipleBet##">
		##TP_ENDIF##
		##TP_IF {[string first CUTOFF [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
			&nbsp;&nbsp;&nbsp;
			<font color=#006666><i>Bet Cutoff</i></font>
			<input name=EvBetCutoff type=text size=10 value="##TP_EvBetCutoff##">
			(hh:mm:ss)
		##TP_ENDIF##
		##TP_IF {[OT_CfgGet FUNC_VARIABLE_MAX_STAKES 0] && ([lsearch [OT_CfgGet VAR_MAX_STAKE_CLASSES ""] [tpGetVar ClassId]] != -1)}##
			<br />
			<font color=#006666><i>##TP_IF {[OT_CfgGet FUNC_VARIABLE_MAX_STAKES_BY_TIME 0]}##Standard ##TP_ENDIF##SP Max Bet</i></font>
			<input name="SpMaxBet" type="text" size="12" value="##TP_EvSpMaxBet##" />
			<br />
	    	##TP_IF {[OT_CfgGet FUNC_VARIABLE_MAX_STAKES_BY_TIME 0]}##
			   	NB: MAX STAKES FOR THIS EVENT WILL VARY ACCORDING TO TIME AND PRICE
		    	<br />
	    	##TP_ENDIF##
	    ##TP_ELSE##
			<input type="hidden" name="SpMaxBet" value="##TP_EvSpMaxBet##" />
		##TP_ENDIF##
		</td>
	</tr>
	##TP_IF {[OT_CfgGet EW_FACTOR 0]}##
	##TP_IF {[tpGetVar ClassSort] == "HR" || [tpGetVar ClassSort] == "GR"}##
	<tr>
		<td class=caption>E/W Factor</td>
		<td>
			 <input name=EvEachWayFactor type=text size=12 value="##TP_EvEachWayFactor##">
		</td>
	</tr>
	##TP_ENDIF##
	##TP_ELSE##
		<input name="EvEachWayFactor" type="hidden" value="##TP_EvEachWayFactor##" />
	##TP_ENDIF##
	##TP_IF {[OT_CfgGet FUNC_MAX_WIN 0]}##
	<tr>
		<td class=caption/>
		<td>
			<font color=#006666><i>Max Potential Win</i></font>
			<input name=EvMaxPotWin type=text size=12 value="##TP_EvMaxPotWin##">
		</td>
	</tr>
	##TP_ELSE##
	  <input name="EvMaxPotWin" type="hidden" value="##TP_EvMaxPotWin##" />
	##TP_ENDIF##
##TP_ELSE##
	<input type=hidden name="EvStatus" value="##TP_EvStatus##">
##TP_ENDIF##
##TP_IF {[string first BLURB [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
	<tr>
		<td class=caption>Blurb</td>
		<td>
		<textarea cols=60 rows=6 wrap=virtual name="EvBlurb">##TP_EvBlurb##</textarea><br>
		<i>(Only 250 characters are stored)</i>
		<br/>
		<a href='javascript:blurb_popup("##TP_EvId##", "EVENT")'>edit multi-lingual text</a>
		<span class="multiLingualMsg">(multi-lingual text will take precedence over the default text)</span>
		</td>
	</tr>
##TP_ENDIF##
##TP_IF {[OT_CfgGet FUNC_CHANNELS 0]}##
	<tr>
		<td class=caption>Channels</td>
		<td class="table">
		##TP_PLAY chan_sel.html##
		</td>
	</tr>

	##TP_IF {[string first FASTKEY [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
		<tr>
			<td class=caption>Fastkey</td>
			<td>
				<input type=text name=EvFastkey size=1 value="##TP_EvFastkey##">
			</td>
		</tr>
	##TP_ENDIF##

##TP_ENDIF##
##TP_IF {[OT_CfgGet FUNC_TEAM_TALK 0] && [tpGetVar ClassSort] == "HR" && ![tpGetVar opAdd 0]}##
	<tr>
		<td class=caption>Team Talk</td>
		<td><a href="##TP_CGI_URL##?action=ADMIN::TEAMTALK::GoRace&EvId=##TP_EvId##">Edit Race Information</a></td>
	</tr>
##TP_ENDIF##
##TP_IF {[OT_CfgGet FUNC_FORM_FEEDS 0] && [tpGetVar ClassSort] == "HR" && ![tpGetVar opAdd 0]}##
	<tr>
		<td class=caption>Form Feed Data</td>
		<td>
			<select name="form_provider_id">
				<script>
					write_select("",
						"","Select Form Feed provider"
						##TP_LOOP form_idx {[tpGetVar NumFormProviders]}##
						,"##TP_FORM_PROVIDER_ID##","##TP_FORM_PROVIDER_NAME##"
						##TP_ENDLOOP##
					);
				</script>
			</select>
			<input type="button" name="form_provider_button" value="Go" onClick="javascript:go_form_feed()">
		</td>
	</tr>
##TP_ENDIF##
##TP_IF {[OT_CfgGet OPENBET_CUST ""] == "BlueSQ"} ##
	<tr>
		<td class=caption>Calendar</td>
		<td><input type=checkbox name="Calendar" ##TP_CALENDAR##></td>
	</tr>
##TP_ENDIF##
##TP_IF {[string first NOTES [OT_CfgGet FUNC_EVENT_FIELDS ""]] >= 0}##
	<tr>
		<td class="caption">Event Team Notes</td>
		<td>
		<textarea cols="60" rows="2" wrap="virtual" name="EvNotes" style="overflow-y: scroll">##TP_EvNotes##</textarea>
		</td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td><i>(Only 250 characters are stored)</i></td>
	</tr>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_ALLOW_SETTLE 0]} ##
	<tr>
	<td class=caption>Allow Settle</td>

	##TP_IF {[op_allowed ModifyAllowStlFlg]} ##
		<td><input type=checkbox name="EvAllowStl" value="Y" ##TP_IF {[tpGetVar EvAllowSettle]=="Y"} ##checked##TP_ENDIF##></td>
	##TP_ELSE##
		<td>
			##TP_TCL {tpBufWrite [tpGetVar EvAllowSettle]} ##
			<input type=hidden name="EvAllowStl" value="##TP_TCL {tpBufWrite [tpGetVar EvAllowSettle]} ##">
		</td>
	##TP_ENDIF##

	</tr>
##TP_ELSE##
	<input type="hidden" name="EvAllowStl" value="Y">
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_TRAD_GUIDS 0]}##
	<tr>
		<td class="caption">Request GUID</td>
		##TP_IF {[tpBindGet ReqGUID] != ""}##
		<td>##TP_ReqGUID##</td>
		##TP_ELSE##
		<td>N/A</td>
		##TP_ENDIF##
	</tr>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_BIR_DELAY 0]} ##
	<tr>
	<td class=caption>Has BIR Markets?</td>
	<td>
		##TP_EvHasBIR####TP_IF {[OT_CfgGet FUNC_EVENT_UPD_BIR_DISP 0] && [tpBindGet EvHasBIR] == "Y"}##&nbsp;<input type=button value="Display BIR Markets" onclick="javascript:location.href='##TP_CGI_URL##?action=ADMIN::EVENT::UpdBIRDisplay&EvId=##TP_EvId##&Displayed=Y'">&nbsp;<input type=button value="Hide BIR Markets" onclick="javascript:location.href='##TP_CGI_URL##?action=ADMIN::EVENT::UpdBIRDisplay&EvId=##TP_EvId##&Displayed=N'">##TP_ENDIF##
	</td>
	</tr>
##TP_ENDIF##
##TP_IF {[OT_CfgGet FUNC_MBS 0]}##
	<tr>
		<td class="caption">&nbsp;Money Back Special?</td>
		<td>
			<input type="checkbox" id="MBS" name="MBS" value="1" ##TP_IF {[tpBindGet MBS]=="1"} ##checked##TP_ENDIF##>
			<input type="button" onclick='blurb_popup("##TP_EvId##", "MBSICON")' value="Edit Multilingual Text">
			##TP_IF {![tpGetVar opAdd 0]}##
			<input type=button value="View/Edit all market's MBS setting" onClick="showMSBlist('##TP_EvId##')">
			##TP_ENDIF##
		</td>
	</tr>

	<tr id="channels">
		<td class=caption>Money Back Special Langauge</td>
		<td>
		<table cellspacing=0 cellpadding=0 border=0>
		##TP_LOOP lang_idx {[expr {4*(([tpGetVar NumLangs]+3)/4)}]}##
			##TP_IF {[tpGetVar lang_idx]%4 == 0}##
				<tr>
			##TP_ENDIF##
			##TP_IF {[tpGetVar lang_idx]<[tpGetVar NumLangs]}##
				<td>
				<input type=checkbox id="MBS_LANG_##TP_LangCode##" name="MBS_LANG_##TP_LangCode##" ##TP_LangSel##>
				##TP_LangName##
				</td>
			##TP_ELSE##
				<td>&nbsp;</td>
			##TP_ENDIF##
			##TP_IF {([tpGetVar lang_idx]+1)%4 == 0}##
				</tr>
			##TP_ENDIF##
		##TP_ENDLOOP##
		</table>
		</td>
	</tr>
##TP_ENDIF##



##TP_IF {[OT_CfgGet FUNC_BIR_COMMENTARY 0]} ##
	<tr>
	  <td class=caption></td>
	  <td>
		<input type=button value="Add Commentary" onclick="javascript:location.href='##TP_CGI_URL##?action=ADMIN::COMM::GoCommentary&SubmitName=CommentAdd&sclass=##TP_ClassId##&stype=##TP_TypeId##&sevent=##TP_EvId##&ShowEvId=##TP_EvId##'">
		##TP_IF {[tpGetVar ShowClearButton] && [op_allowed ClearCommentary] }##
			<input type=button value="Clear Commentary" onClick="clearcommentary()">
		##TP_ENDIF##
	  </td>
	</tr>
##TP_ENDIF##

##TP_IF {![tpGetVar opAdd 0] && [OT_CfgGet BF_ACTIVE 0] && [OT_CfgGet BF_MANUAL_MATCH 0]}##
	##TP_TCL {tpSetVar BfHid 1}##
	##TP_PLAY bf_event.html##
##TP_ENDIF##

##TP_IF {[OT_CfgGet BF_ACTIVE 0]}##
	##TP_TCL {tpSetVar BfEvMatch 1}##
	##TP_PLAY bf_event.html##
##TP_ENDIF##


<tr>
	<th colspan=2 class=buttons>
	<table border=0 cellspacing=0 cellpadding=0 width=100%>
	<tr>
		<th width="75%" class=buttons>
		##TP_IF {[op_allowed ManageEv]}##
			##TP_IF {[tpGetVar opAdd 0]}##
				##TP_IF {[tpGetVar AllowDDCreation 0]}##
				<input type=button class="btn_def" value="Add Event" onClick="return fs(this,'EvAdd')">
				##TP_ENDIF##
			##TP_ELSE##
				<input type=button class="btn_def" value="Update Event" onClick="return fs(this,'EvMod')">
				##TP_IF {[tpGetVar AllowDDDeletion 0]}##
				<input type=button class="btn_def" value="Delete Event" onClick="return fs(this,'EvDel')">
				##TP_ENDIF##
			##TP_ENDIF##
		##TP_ENDIF##
		<input type=button class="btn_def" value="Back" onClick="return fs(this,'Back')">
		</th>
		##TP_IF {![tpGetVar opAdd 0]}##
			##TP_IF {[tpGetVar PERM_ViewAudit 0]}##
				<th class=goaudit width=25%>
				<input type=button class="btn_def" value="View Audit History" onClick="return fs(this,'GoAudit')">
				<input type=hidden name=AuditInfo value="Ev">
				</th>
			##TP_ELSE##
				<th class="buttons"></th>
			##TP_ENDIF##
		##TP_ENDIF##
	##TP_IF {[OT_CfgGet FUNC_CLEAR_EVENT 0] && [tpGetVar EvAllowSettle] == "Y"}##
	<th class="buttons"></th>
	<th class="buttons"><input type="button" class="btn_def" value="Clear Event" onClick="return CheckClear(this)"/></th>
	##TP_ENDIF##
	</tr>

	##TP_IF {[OT_CfgGet FUNC_AMALCO 0]}##
	##TP_IF {[tpBindGet EvHasBIR] == "Y"}##
	<tr>
		<th class="buttons"><input type="button" class="btn_def" value="Send Incident" onClick="return fs(this,'SendIncident')"></th>
	</tr>
	##TP_ENDIF##
	##TP_ENDIF##
	</table>
	</th>
</tr>
<input type=hidden name=ClassSort value="##TP_ClassSort##">
<input type=hidden name=TypeId value="##TP_TypeId##">
<input type=hidden name=EvId   value="##TP_EvId##">
<input type=hidden name=SubmitName value="">
<input type=hidden name=action id=action value=ADMIN::EVENT::DoEv>
<input type=hidden name=AuxLoginUID value="">
<input type=hidden name=AuxAdminName value="">
<input type=hidden name=AuxAdminPwd value="">

<input type=hidden name=ClassId     value="##TP_ClassId##">
<input type=hidden name=type_id     value="##TP_type_id##">
<input type=hidden name=date_range  value="##TP_date_range##">
<input type=hidden name=date_lo     value="##TP_date_lo##">
<input type=hidden name=date_hi     value="##TP_date_hi##">
<input type=hidden name=settled     value="##TP_settled##">
<input type=hidden name=result_conf value="##TP_result_conf##">
<input type=hidden name=status      value="##TP_status##">
<input type=hidden name=allow_stl   value="##TP_allow_stl##">

</form>

##TP_IF {![tpGetVar opAdd 0]}##
	##TP_IF {[tpGetVar AfterEventStart 0] || [tpGetVar Confirmed 0]}##
		<tr class=blank>
			<td colspan=2>&nbsp;</td>
		</tr>
		<!-- form to confirm or settle results -->
		<form method=get ACTION="##TP_CGI_URL##">
		<tr>
			<th colspan=2 class=buttons>
			<input type=hidden name=TypeId value="##TP_TypeId##">
			<input type=hidden name=EvId   value="##TP_EvId##">
			##TP_IF {![tpGetVar Confirmed 0]}##
				##TP_IF {[op_allowed ConfirmResults]}##
					##TP_IF {[tpGetVar NumSelnsNoRslt] == 0}##
						<input type=hidden name="CanConfHcaps" value="##TP_CanConfHcaps##">
						<input type=button class="btn_def" value="Confirm Results" onClick="return fs(this,'EvConf')">
					##TP_ELSE##
						##TP_NumSelnsNoRslt## selections with no result
					##TP_ENDIF##
				##TP_ELSE##
					<i>Results are not confirmed</i>
				##TP_ENDIF##
			##TP_ELSE##
				##TP_IF {![tpGetVar Settled 0]}##
					##TP_IF {![op_allowed ConfirmResults Settle]}##
						<i>Event is not settled</i>
					##TP_ELSE##
						##TP_IF {[op_allowed ConfirmResults]}##
							<input type=button class="btn_def" value="Unconfirm Results" onClick="return fs(this,'EvUnconf')">
						##TP_ENDIF##
						##TP_IF {[op_allowed Settle]}##
							##TP_IF {[tpGetVar EvAllowSettle]=="Y"} ##
								<input type=button class="btn_def" value="Settle Event" onClick="return fs(this,'EvStl')">
								<input type=hidden name=DoSettle value=Y>
							##TP_ENDIF##
						##TP_ENDIF##
					##TP_ENDIF##
				##TP_ELSE##
					<i>Event has been settled</i>
	                ##TP_IF {[op_allowed ReSettle]}##
						##TP_IF {[tpGetVar EvAllowSettle]=="Y"} ##
							<input type=button class="btn_def" value="Re-Settle Event" onClick="return fs(this,'EvReStl')">
							<input type=hidden name=DoSettle value=Y>
						##TP_ENDIF##
					##TP_ENDIF##
				##TP_ENDIF##
			##TP_ENDIF##
			<input type=button class="btn_def" value="Show Results" onclick="EventResults()">
			</th>
		</tr>
		<input type=hidden name=SubmitName value="">
		<input type=hidden name=action VALUE="ADMIN::EVENT::DoEvConf">
		</form>
	##TP_ENDIF##
##TP_ENDIF##
</table>
<br>
##TP_IF {![tpGetVar opAdd 0]}##
	<!-- List of Markets -->
	<form name=GoAddEvMkt method=get action="##TP_CGI_URL##" >
	<table border=0 cellspacing=1 cellpadding=1>
	<tr>
		<th class=title colspan=9>
		Fixed odds markets
		</th>
	</tr>
	##TP_IF {[tpGetVar NumMkts 0]>0}##
		<tr>
			<th class=colhead>Name</th>
			<th class=colhead>Status</th>
			<th class=colhead>Displayed</th>
			<th class=colhead>Disporder</th>
			<th class=colhead>LP?</th>
			<th class=colhead>SP?</th>
			<th class=colhead>EW?</th>
			<th class=colhead>Confirmed</th>
			<th class=colhead>Settled</th>
		</tr>
		##TP_LOOP mkt_idx {[tpGetVar NumMkts]}##
			<script>write_tr('##TP_MktSettled##','##TP_MktResultConf##','##TP_MktStatus##','##TP_MktDisplayed##')</script>
				<td><A HREF="##TP_CGI_URL##?action=ADMIN::MARKET::GoMkt&MktId=##TP_MktId##&ClassId=##TP_ClassId##&type_id=##TP_type_id##&date_range=##TP_date_range##&date_lo=##TP_date_lo##&date_hi=##TP_date_hi##&settled=##TP_settled##&result_conf=##TP_result_conf##&status=##TP_status##&allow_stl=##TP_allow_stl##">##TP_MktName##</A></td>
				<td>##TP_MktStatus##&nbsp;##TP_MktHcapStr##</td>
				<td>##TP_MktDisplayed##</td>
				<td>##TP_MktDisporder##</td>
				<td>##TP_MktLP##</td>
				<td>##TP_MktSP##</td>
				<td>
				<script>
				write_mkt_ew("##TP_MktEWAvail##","##TP_MktEWPlaces##","##TP_MktEW_N##","##TP_MktEW_D##");
				</script>
				</td>
				<td>##TP_MktResultConf##</td>
				<td>##TP_MktSettled##</td>
			</tr>
			##TP_ENDLOOP##
	##TP_ELSE##
		<tr>
			<td colspan=9>
			<I>No markets have been added to this event.</I>
			</td>
		</tr>
	##TP_ENDIF##
	##TP_IF {[op_allowed ManageEvMkt]}##
		##TP_IF {![tpGetVar AfterEventStart 0]}##
		##TP_IF {![tpGetVar Confirmed 0]}##
			<tr>
			<th colspan=9 class=buttons>
			<input type=hidden name=TypeId value="##TP_TypeId##">
			<input type=hidden name=EvId   value="##TP_EvId##">
			##TP_IF {[tpGetVar NumMktGrps 0]>0}##
				##TP_IF {[tpGetVar AllowDDCreation 0]}##
				<select name=MktGrpId>
				##TP_LOOP mkt_grp_idx {[tpGetVar NumMktGrps]}##
					<option value='##TP_MktGrpId##'>##TP_MktGrpName##</option>
				##TP_ENDLOOP##
				</select>
				&nbsp;
				<input type=button class="btn_def" value="Add Event Market" onClick="return fs(this,'EvMktAdd')">
				##TP_ENDIF##
			##TP_ELSE##
				No new markets to add to this event
			##TP_ENDIF##
			</th>
			</tr>
		##TP_ENDIF##
		##TP_ENDIF##
	##TP_ENDIF##
	</table>
	<input type=hidden name=SubmitName value="">
	<input type=hidden name=action value=ADMIN::MARKET::GoMkt>
	</form>
##TP_ENDIF##

##TP_IF {![tpGetVar opAdd 0] && [OT_CfgGet FUNC_INDEX_TRADE 0]}##
	<!-- List of Index Markets -->
	<form name=GoAddEvIxMkt method=get action="##TP_CGI_URL##" >
	<table border=0 cellspacing=1 cellpadding=1>
	<tr>
		<th class=title colspan=9>
		Index markets
		</th>
	</tr>
	##TP_IF {[tpGetVar NumIxMkts 0]>0}##
		<tr>
			<th class=colhead>Code</th>
			<th class=colhead>Status</th>
			<th class=colhead>Displayed</th>
			<th class=colhead>Disporder</th>
			<th class=colhead>Lo</th>
			<th class=colhead>Hi</th>
			<th class=colhead>Makeup</th>
			<th class=colhead>Confirmed</th>
			<th class=colhead>Settled</th>
		</tr>
		##TP_LOOP ixmkt_idx {[tpGetVar NumIxMkts 0]}##
			<script>write_tr('##TP_IxMktSettled##','##TP_IxMktResultConf##','##TP_IxMktStatus##','##TP_IxMktDisplayed##')</script>
				<td><A HREF="##TP_CGI_URL##?action=ADMIN::IXMARKET::GoIxMkt&IxMktId=##TP_IxMktId##">##TP_IxMktCode##</A></td>
				<td>##TP_IxMktStatus##</td>
				<td>##TP_IxMktDisplayed##</td>
				<td>##TP_IxMktDisporder##</td>
				<td>##TP_IxMktIndexMin##</td>
				<td>##TP_IxMktIndexMax##</td>
				<td>##TP_IxMktMakeup##</td>
				<td>##TP_IxMktResultConf##</td>
				<td>##TP_IxMktSettled##</td>
			</tr>
		##TP_ENDLOOP##
	##TP_ELSE##
		<tr>
			<td colspan=9>
			<I>No indexes have been added to this event.</I>
			</td>
		</tr>
	##TP_ENDIF##
	##TP_IF {[op_allowed IxMkt]}##
		##TP_IF {![tpGetVar Confirmed 0]}##
			<tr>
			<th colspan=9 class=buttons>
			<input type=hidden name=TypeId value="##TP_TypeId##">
			<input type=hidden name=EvId   value="##TP_EvId##">
			##TP_IF {[tpGetVar NumIxMktGrps 0]>0}##
				<select name=IxMktGrpId>
				##TP_LOOP ixmktgrp_idx {[tpGetVar NumIxMktGrps]}##
					<option value='##TP_IxMktGrpId##'>##TP_IxMktGrpName##</option>
				##TP_ENDLOOP##
				</select>
				&nbsp;
				##TP_IF {[tpGetVar AllowDDCreation 0]}##
				<input type=button class="btn_def" value="Add Index Market" onClick="return fs(this,'EvIxMktAdd')">
				##TP_ENDIF##
			##TP_ELSE##
				No new markets to add to this event
			##TP_ENDIF##
			</th>
		</tr>
		##TP_ENDIF##
	##TP_ENDIF##
	</table>
	<input type=hidden name=SubmitName value="">
	<input type=hidden name=action value=ADMIN::IXMARKET::GoIxMkt>
	</form>
##TP_ENDIF##
</body>
</html>

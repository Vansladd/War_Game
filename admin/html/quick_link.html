<!-- $Id: quick_link.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ -->

<script type="text/javascript">

	function fsQL(b) {

		b.disabled = true;
		b.value = "Busy...";
		b.form.submit();
		return true;
	}


	function setLevel() {
		var level_sel = document.quick_link_form.level_select;

		document.quick_link_form.level.value = level_sel.options[level_sel.selectedIndex].value;
	}

	function setId() {
		document.quick_link_form.id.value = document.quick_link_form._id.value;
	}

	function checkForm(b) {

		setLevel();
		setId();

		var error = 0;
		var msg   = '';
		var id    = document.quick_link_form.id.value;
		var level = document.quick_link_form.level.value;


		if (level == '') {
			error = 1;
			msg = msg + "Please select a heirarchy level";
		}

		if (/^[0-9]+$/.test(id) == false) {
			error = 1;
			msg = "Incorrect ID - must be a numeric value\n\n";
		}
		if (error == 1) {
			alert (msg);
			return false;
		} else {
			return fsQL(b);
		}
	}

	function checkEnter(b,e){ 
		var characterCode 
	
		if(e && e.which){ 
			e = e;
			characterCode = e.which;
		}
		else{
			e = event;
			characterCode = e.keyCode;
		}

		if(characterCode == 13){ 
			checkForm(b);
			return false;
		}
		else{
			return true;
		}

	}
</script>

<form name="quick_link_form" method="get" action="##TP_CGI_URL##">
	<input type="hidden" name="action" value="ADMIN::QUICK_LINK::DoQuickLink">
	<input type="hidden" name="SubmitName" value="">

	##TP_IF {[tpGetVar ERR]}##
		<b><font color="red">##TP_ERR_MSG##</font></b>
	##TP_ENDIF##

	<table border="0" cellspacing="0" cellpadding="2">
		<tr>
			<th class="title">
				Quick Link
			</th>
		</tr>
		<tr>
			<td><b>&nbsp;&nbsp;Quick Link to hierarchy level</b></td>
		</tr>
		<tr>
			<td>
				<select name="level_select" onChange="setLevel()">
					<option value="Category" ##TP_IF {[tpBindGet LEVEL] == "Category"}## selected ##TP_ENDIF##>Category</option>
					<option value="Class" ##TP_IF {[tpBindGet LEVEL] == "Class"}## selected ##TP_ENDIF##>Class</option>
					<option value="EvType" ##TP_IF {[tpBindGet LEVEL] == "EvType"}## selected ##TP_ENDIF##>Event Type</option>
					<option value="MktType" ##TP_IF {[tpBindGet LEVEL] == "MktType"}## selected ##TP_ENDIF##>Market Type</option>
					<option value="Event" ##TP_IF {[tpBindGet LEVEL] == "Event" || [tpBindGet LEVEL] == ""}## selected ##TP_ENDIF##>Event</option>
					<option value="Market" ##TP_IF {[tpBindGet LEVEL] == "Market"}## selected ##TP_ENDIF##>Market</option>
					<option value="Outcome" ##TP_IF {[tpBindGet LEVEL] == "Outcome"}## selected ##TP_ENDIF##>Selection</option>
				</select>
				<b>ID =</b> <input type="text" size="10" name="_id" value="##TP_ID##" onKeyPress="checkEnter(this,event)">
				<input type="hidden" name="level" value="">
				<input type="hidden" name="id" value="">
			</td>
		</tr>
		<tr>
			<th colspan="2" class="buttons">
				<input type="button" value="Go" onClick="return checkForm(this)">
			</td>
		</tr>
	</table>
</form>

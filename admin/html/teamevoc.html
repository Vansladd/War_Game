<html>
<head>
<!-- $Id: teamevoc.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ -->
<link rel="stylesheet" href="##TP_CGI_URL##?action=ADMIN::TEAMPLAYER::doCSS" type="text/css">
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<title>Select teams ...</title>
<script type="text/javascript" language="JavaScript">
<!--

var teams = new Array();

##TP_LOOP c_idx {$TEAMS(nrows)}##
teams[##TP_TCL {tpBufWrite [tpGetVar c_idx]}##] = new Array("##TP_teamID##", "##TP_teamCode##", "##TP_teamName##", "##TP_teamMenuName##");##TP_ENDLOOP##

function listTeams() {
	for(var i = 0; i < teams.length; i++) {
		option = new Option(teams[i][3], teams[i][0]);
		document.team.teamList.options[i] = option;
	}

	teamID = opener.document.DoSel.teamId.value;

	if(teamID.length > 0) {
		document.team.teamList.selectedIndex = findIndex(teamID);
	} else {
		document.team.teamList.selectedIndex = 0;
	}

	document.team.teamList.focus();
}

function findIndex(teamID) {
	for(var i = 0; i < teams.length; i++) {
		if(teams[i][0] == teamID) {
			return i;
		}
	}
	return 0;
}

function myApply() {
	teamIndex = document.team.teamList.selectedIndex;

	opener.document.DoSel.OcDesc.value = teams[teamIndex][2];
	opener.document.DoSel.teamId.value = teams[teamIndex][0];
	self.close();
}

function myCancel() {
	self.close();
}

//-->
</script>
</head>
<body class="popUp" onload="listTeams()">

<form name="team" action="##TP_CGI_URL##" method=get>
<center>
<table border="0" cellpadding="5" cellspacing="0" width="100%" height="100%">
<tr>
	<td class="tabBar" colspan="2">
		Team
	</td>
</tr>
<tr>
	<td valign="top">
		<select width="190" size="10" name="teamList">
		</select>
	</td>
</tr>
<tr>
    <td align="center" colspan="2">
		<input type="button" class="btn_def" value="Apply" onclick="myApply()">&nbsp;&nbsp;
		<input type="button" class="btn_def" value="Cancel" onclick="myCancel()">
	</td>
</tr>
</table>
</center>
</form>

</body>
</html>

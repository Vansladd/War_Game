<html>
<!-- $Id: news.html,v 1.1.1.1 2011/10/04 10:54:25 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
##TP_PLAY JS_WriteSelect.html##
<style type="text/css">
div.displayed {
	visibility:visible;
}
div.hidden {
	visibility:hidden;
}
</style>
##TP_PLAY header_cal.html##
<script>
function go_dd_popup() {
	popup = window.open("##TP_CGI_URL##?action=ADMIN::BESTBETS::go_bbet_dd",
		"popup",
		"toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,height=400,width=400");
	popup.focus();
}

function clear_bet_link() {
	f = document.News_Details;
	f.id_level.value = '';
	f.id_key.value = '';
	f.id_name.value = '';
}


function set_vals(level, id, name) {
	f = document.News_Details;
	if (!f) {
		alert("unable to find form");
		return;
	}
	f.id_level.value = level;
	f.id_key.value   = id;
	f.id_name.value  = name;
}
function fs(b,t)
{
	if (t=="Delete") {
		if (confirm("Are you sure you wish to DELETE this entry?") == 0) {return;}
	}
	b.disabled = true;
	b.value = "Busy...";
	b.form.SubmitName.value=t;
	b.form.submit();
	return true;
}
function doAudit(audit, b) {
	b.form.AuditInfo.value = audit;
	return fs(b, "GoAudit");
}

function ViewDispPopup(b,id,name)
{
	if (id == "") {id = 0;}
	main_form = b.form;

	window.open("##TP_CGI_URL##?action=ADMIN::VIEWS::GoViewDisporders&id="+id+"&sort=NEWS&name="+name,
		"Views",
		"toolbar=no,location=no,directories=no,menubar=no,scrollbar=yes,resizable=yes,width=450,height=300");
}
function blurb_popup (id, sort) {

	if (id == "") {
		alert("No Id specified, does the "+sort+" exist.\n"+
			"You must create it before you can add a blurb");
		return;
	}

	window.open("##TP_CGI_URL##?action=ADMIN::BLURB::do_blurb&ref_id="
	+id+"&sort="+sort,
	"Blurb",
	"toolbar=no,location=no,directories=no,menubar=no,resizable=yes,width=600,height=200");
}

function news_type_change() {
	##TP_IF {[OT_CfgGet FUNC_NEWS_TAGS 0]}##
	type_code = document.forms['News_Details'].news_type.value;
	display_tags_div(type_code);
	##TP_ENDIF##
}

##TP_IF {[OT_CfgGet FUNC_NEWS_TAGS 0]}##
function display_tags_div (code) {
	var sel = document.forms['News_Details'].news_type;
	var type_code = "";
	var el = null;

	for (var i=0; i<sel.length; i++) {
		type_code = sel.options[i].value;
		el = document.getElementById("news_type_"+type_code);
		if (el != null) el.className = "hidden";
	}

	el = document.getElementById("news_type_"+code);
	if (el != null) el.className = "displayed";

}
##TP_ENDIF##

function preload() {
	##TP_IF {[OT_CfgGet FUNC_NEWS_TAGS 0]}##
	news_type_change();
	##TP_ENDIF##
}

function displayCalendars() {
	new Calendar(document.forms.News_Details.fromDate,null,true,"lo")
	new Calendar(document.forms.News_Details.toDate,null,true,"lo")
}

</script>
</head>
<body onload="javascript:preload();displayCalendars();">
##TP_PLAY error_rpt.html##
<form name="News_Details" action="##TP_CGI_URL##" method="POST">
<input type=hidden name="action" value="ADMIN::NEWS::go_upd_news_highlight">
<input type=hidden name="news_id" value="##TP_news_id##">
<input type=hidden name="id_key" value="##TP_id_key##">
<input type="hidden" name="View" value="##TP_List_View##">
<input type="hidden" name="Type" value="##TP_List_Type##">
<table cellspacing="0" cellpadding="2" border="0">
<tr>
	<th colspan=4 class=title>News Details</th>
</tr>
<tr>
	<td class=caption>Name</td>
	<td colspan=3>
		<input type=text name=name size=60 maxlength=60 value="##TP_news_name##">
		&nbsp;(optional)
	</td>
</tr>
<tr>
	<td class=caption>Link Title</td>
	<td colspan=3>
		<input type=text name=link_title size=60 maxlength=60 value="##TP_link_title##">
		&nbsp;
		<a href='javascript:blurb_popup("##TP_news_id##", "NEWSNAME")'>
			edit multi-lingual title</a>
	</td>
</tr>
<tr>
	<td class=caption>News Text</td>
	<td colspan=3>
		<textarea name=news rows=4 cols=80 wrap=virtual>##TP_news##</textarea>
		##TP_IF {[string first BLURB [OT_CfgGet FUNC_NEWS_TEXT ""]] >= 0}##
			<br><a href='javascript:blurb_popup("##TP_news_id##", "NEWS")'>edit multi-lingual text</a>
			<span class="multiLingualMsg">
			(multi-lingual text will take precedence over the default text)</span>
		##TP_ENDIF##
	</td>
</tr>
<tr>
	<td class=caption>News Type</td>
	<td colspan="3">
	<select name="news_type" onChange="javascript:news_type_change();">
		<script>
		write_select('##TP_Type##'
			##TP_LOOP t_idx {$TYPEARRAY(entries)}##
				,'##TP_TYPE_CODE##',"##TP_TYPE_DESC##"
			##TP_ENDLOOP##);
		</script>
	</select>
	</td>
</tr>

<tr>
	<td class=caption>Small Image</td>
	<td><input type=text name=small_image size=25 maxlength=125 value="##TP_small_image##"></td>
    <td class="caption">Large Image</td>
	<td><input type=text name=large_image size=25 maxlength=125 value="##TP_large_image##"></td>
</tr>
<tr>

	##TP_IF {[OT_CfgGet FUNC_NEWS_TAGS 0]}##
	<td class="caption">Tags</td>
	<!-- Maintain old data in tag field -->
	<input type="hidden" name="tag" value="##TP_tag##">
	<td>
	##TP_LOOP news_type_idx {[tpGetVar NumNewsTypes 0]}##
		<div id="news_type_##TP_tagTypeCode##" class="hidden">
		<table>
		##TP_LOOP news_tag_idx {$::NEWS_TAGS([tpGetVar news_type_idx],num_tags)}##
			##TP_IF {[tpGetVar news_tag_idx 0] % 2 == 0}##<tr>##TP_ENDIF##
			<td><input type="checkbox" name="newstag_##TP_tagTagId##" value="on" ##TP_tagSelected##></td>
			<td>##TP_tagDesc##</td>
			##TP_IF {[tpGetVar news_tag_idx 0] % 2 == 1}##</tr>##TP_ENDIF##
		##TP_ENDLOOP##
		</table>
		</div>
	##TP_ENDLOOP##
	</td>
	##TP_ELSE##

	##TP_IF {[OT_CfgGet FUNC_PBET_NEWS 0]==0}##
    <td class=caption>Tag</td>
	<td><input type=text name=tag size=16 maxlength=16 value="##TP_tag##"></td>
	##TP_ELSE##
	<td></td>
	<td></td>
	##TP_ENDIF FUNC_PBET_NEWS##

	##TP_ENDIF FUNC_NEWS_TAGS##
	<td class="caption">Large Image alignment</td>
	<td>
		<select name="image_align">
		<script>write_select('##TP_image_align##','L','Left','R','Right');</script>
		</select>
	</td>
</tr>
<tr>
    <td class="caption">Disporder</td>
    <td><input type=text name=disporder size=6 maxlength=6 value="##TP_disporder##"></td>
	<td class="caption">Displayed</td>
	<td>
		<select name="displayed">
		<script>write_select('##TP_displayed##','Y','Yes','N','No');</script>
		</select>
	</td>
</tr>
##TP_IF {[tpGetVar FuncNewsLocation 0]}##
<tr>
	##TP_IF {[OT_CfgGet FUNC_PBET_NEWS 0]}##
	<td class="caption">Location</td>
        <td>
    ##TP_PLAY news_locations_drp.html##
        </td>
	##TP_ELSE##
    <td colspan="4"></td>
	##TP_ENDIF##
</tr>
##TP_ENDIF##
<tr>
    ##TP_IF {[OT_CfgGet FUNC_NEWS_GRPS 0]}##
    <td colspan="2"></td>
    <td class="caption">Group</td>
	##TP_TCL {global NEWS_GRPS}##
    <td>
	  <select name="grp_id">
	  <option name="no_group" value="">-- No Group --</option>
	  ##TP_LOOP grp_idx {$::NEWS_GRPS(num_grps)}##
	  <option name="grp_##TP_TCL {tpBufWrite [tpGetVar grp_idx]}##"
			  value="##TP_grp_id##"##TP_IF {[tpGetVar grp_id] == $::NEWS_GRPS([tpGetVar grp_idx],grp_id)}## selected="selected"##TP_ENDIF##>
		  ##TP_grp_title##</option>
	  ##TP_ENDLOOP##
	  </select>
    </td>
    ##TP_ELSE##
    <td colspan="4"></td>
    ##TP_ENDIF##
</tr>



##TP_IF {[tpGetVar FuncNewsLocation 0]}##
<tr class=subtitle>	<th colspan=4 align=left>Positioning</th></tr>
<tr>
	<td class=caption>Locations</td>
	<td colspan="3" class="table">
	##TP_PLAY news_locations_sel.html##
	</td>
</tr>
<tr>
	<td class="caption">Item position</td>
	<td>
		<select name="item_pos">
		<script>write_select('##TP_item_pos##','T','Top','B','Bottom');</script>
		</select>
	</td>
	<td></td>
    <td></td>
</tr>
##TP_ELSE##
	<input type=hidden name="item_pos" value="B">
##TP_ENDIF##
<tr class=subtitle>	<th colspan=4 align=left>Link Information</th></tr>
<tr>
	<td class=caption>URL Type</td>
	<td>
	<select name="url_type">
	##TP_IF {[OT_CfgGet NEWS_URL_TYPE ""] == ""}##
	<script>write_select('##TP_url_type##','U','URL','A','Action','F','File','H','Help File');</script>
	##TP_ELSE##
	<script>write_select('##TP_url_type##',##TP_TCL {tpBufWrite [OT_CfgGet NEWS_URL_TYPE]}##);</script>
	##TP_ENDIF##
	</select>
	</td>
	<td><b>New Window?</b></td>
	<td>
		<select name="link_new_window">
		<script>write_select('##TP_link_new_window##','N','No','Y','Yes');</script>
		</select>
	</td>
</tr>

<tr>
	<td class="caption">URL</td>
	<td><input type=text name=info_url size=32 maxlength=128 value="##TP_info_url##">&nbsp;&nbsp;OR</td>
	<td><b>Resizable</b></td>
	<td>
		<input type="checkbox" name="win_resizable" ##TP_win_resizable##>
	</td>
</tr>

<tr>
	<td class="caption">Link to</td>
	<td><input type=text name=id_level size=10 onFocus='document.News_Details.disporder.focus()' value="##TP_id_level##">
		##TP_IF {[op_allowed UpdHomepage]}##
		<a class="caption" href="javascript:go_dd_popup()">change</a>
		##TP_ELSE##
		&nbsp;
		##TP_ENDIF##
	</td>
	<td><b>Scrollbars</b></td>
	<td>
		<input type="checkbox" name="win_scrollbar" ##TP_win_scrollbar##>
	</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td><input type=text name=id_name  size=32 onFocus='document.News_Details.disporder.focus()' value="##TP_id_name##">
		##TP_IF {[op_allowed UpdHomepage]}##
		<a class="caption" href="javascript:clear_bet_link()">clear bet link</a>
		##TP_ELSE##
		&nbsp;
		##TP_ENDIF##
	</td>
	<td><b>Menubar</b></td>
	<td>
		<input type="checkbox" name="win_menubar" ##TP_win_menubar##>
	</td>
</tr>
<tr>
	<td class="caption">From</td>

	<td><input type="text" size=18 name=fromDate value="##TP_fromDate##">


	</td>
	<td><b>Heading</b></td>
	<td>
		<input type="checkbox" name="link_heading" ##TP_link_heading##>
	</td>
</tr>
<tr>
	<td class="caption">To</td>

	<td><input type="text" size=18 name=toDate value="##TP_toDate##">


	</td>
	<td><b>Link text</b></td>
	<td align="left">
		<input type="checkbox" name="link_text" ##TP_link_text##>
	</td>
</tr>
<tr>
	<td></td>
	<td></td>
	##TP_IF {[tpGetVar FuncDimensions 0]}##
	<td><b>Window Size (W x H)</b></td>
	<td align="left">
		<input type=text name="link_win_width" size=4 maxlength=6 value="##TP_link_win_width##">&nbsp;X&nbsp;<input type=text name="link_win_height" size=4 maxlength=6 value="##TP_link_win_height##">
	</td>
	##TP_ELSE##
	<td colspan="2">&nbsp;</td>
	##TP_ENDIF##
</tr>


<tr class=subtitle>	<th colspan=4 align=left>Availability</th></tr>

##TP_IF {[tpGetVar FuncChannels 0]}##
<tr>
	<td class="caption">Channels</td>
	<td colspan="3" class="table">
	##TP_PLAY chan_sel.html##
	</td>
</tr>
##TP_ENDIF##
##TP_IF {[tpGetVar FuncMultiLang 0]}##
	<tr>
		<td class="caption">Languages</td>
		<td colspan="3" class="table">
		##TP_PLAY lang_sel.html##
		</td>
	</tr>
##TP_ENDIF##
##TP_IF {[OT_CfgGetTrue FUNC_VIEW_FLAGS]}##
	<tr>
		<td class="caption">Views</td>
		<td colspan="3" class="table">
		##TP_PLAY view_sel.html##
		</td>
	</tr>
	<tr class=subtitle><td class="newsInfo" colspan="4">Languages: These are the languages that will be able to see this news item, with the current views setup</td></tr>
	<tr><td class="newsInfobold" colspan="4" width="500">##TP_lang_list##</td></tr>
##TP_ENDIF##


##TP_IF {[op_allowed UpdHomepage]}##
<tr>
	<th colspan="4" class=buttons>
##TP_IF {[tpGetVar Insert 0]}##
	<input type=button class="btn_def" value="Insert" onClick="return fs(this,'Insert')">
##TP_ELSE##
	<input type=button class="btn_def" value="Update" onClick="return fs(this,'Update')">
	&nbsp;
	<input type=button class="btn_def" value="Delete" onClick="return fs(this,'Delete')">
	&nbsp;
	##TP_IF {[OT_CfgGetTrue FUNC_VIEWS]}##
	<input type=button class="btn_def" value="View Disporder" onclick="ViewDispPopup(this,'##TP_news_id##','##TP_link_title##')">
	##TP_ENDIF##
##TP_ENDIF##

	##TP_IF {[op_allowed ViewAudit]}##
	<input type=button class="btn_def" value="View Audit History" onClick="return doAudit('NewsHigh', this)">
	<input type=hidden name=AuditInfo value="">
	##TP_ENDIF##

	</th>
</tr>
##TP_ENDIF##
<input type=hidden name=SubmitName value="">
</table>
</form>
</body>
</html>

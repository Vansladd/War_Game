<html>
<!-- $Id: pmt_multiple.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>Multiple Methods</title>
<script language=javascript>
function fs(b,t)
{
	if (t == "UpdPMBSettings") {
		var pmb_settings_form = document.getElementById("pmb_settings");
		var pmb_vals = pmb_settings_form.elements;

		var max_pmt_mthds = pmb_settings_form.max_pmt_mthds;
		if (max_pmt_mthds.value < 0) {
			alert("Max payment methods must be greater than 0.");
			return false;
		}

		var max_cards = pmb_settings_form.max_cards;
		if (max_cards.value < 0) {
			alert("Max number of cards must be greater than 0.");
			return false;
		}
	
		for (var i = 0; i < pmb_vals.length; i++) {
			var pmb_val = pmb_vals[i].value;
			var name = pmb_vals[i].name;

			if (name.match("PMBExp")) {
				if (pmb_val > 366 || pmb_val < 0) {
					alert("PMB expiry must be between 0 and 366 days.");
					return false;
				}
			} else if (name.match("Pri")) {
				if (!pmb_val.match("[0-9]{1,3}")) {
					alert("Payment priority must be a number.");
					return false;
				}
			} else if (name.match("MaxComb")) {
				if (!pmb_val.match("[0-9]{1,3}")) {
					alert("Max combine must be a number.");
					return false;
				}
				if (pmb_val < 0) {
					alert("Max combine must be greater than 0.");
					return false;
				}
			}
		}
	}

	if (t == "UpdMultiPmt") {
		var multi_pmt_settings_form = document.getElementById("multi_pmt_settings");
	
		var nr_fraud_cpms = multi_pmt_settings_form.nr_fraud_cpms;
		if (nr_fraud_cpms.value < 0) {
			alert("Payment methods for fraud check must be greater than 0.");
			return false;
		}

		var fraud_cpms_period = multi_pmt_settings_form.fraud_cpms_period;
		if (fraud_cpms_period.value < 0) {
			alert("Fraud check period must be greater than 0 days.");
			return false;
		}
	}

	b.disabled = true;
	b.value = "Busy...";
	b.form.SubmitName.value=t;
	b.form.submit();
	return true;
}
</script>
</head>
<body>
##TP_PLAY error_rpt.html##
##TP_PLAY msg_rpt.html##
##TP_IF {[op_allowed UpdateMaxCombine]}##
<form name="multi_pmt_settings" id="multi_pmt_settings" method="POST" action="##TP_CGI_URL##">
<table border=0 cellspacing=0 cellpadding=3>
<tr>
	<th colspan=2 class=title>Multiple Payment Methods Fraud Settings</th>
</tr>
<tr>
	<td class="caption">Payment Methods for Fraud Check</td>
	<td><input type="text" name="nr_fraud_cpms" size="4" maxlength="3" value="##TP_NrFraudCPMs##" /></td>
</tr>
<tr>
	<td class="caption">in</td>
	<td><input type="text" name="fraud_cpms_period" size="4" maxlength="3" value="##TP_FraudCPMsPeriod##" />days</td>
</tr>
<tr>
	<td nowrap colspan="2" class="buttons"><input type="button" value="Update" onClick="return fs(this,'UpdMultiPmt')" ></td>
</tr>
<input type="hidden" name="action" value="ADMIN::PMT_MULTIPLE::DoUpdMultiPmt">
<input type="hidden" name="SubmitName" value="">
</table>
</form>
##TP_ENDIF##

<form name="pmb_settings" id="pmb_settings" method="POST" action="##TP_CGI_URL##">
<table border=0 cellspacing=0 cellpadding=3>
<tr>
	<th colspan=5 class=title>PMB Settings</th>
</tr>
<tr>
	<td colspan="2" class="caption">Max Payment Methods</td>
	<td><input type="text" name="max_pmt_mthds" size="4" maxlength="3" value="##TP_MaxPmtMthds##" /></td><td>&nbsp;</td><td>&nbsp;</td>
</tr>
<tr>
	<td colspan="2" class="caption">Max Number of Cards</td>
	<td><input type="text" name="max_cards" size="4" maxlength="3" value="##TP_MaxCards##" /></td><td>&nbsp;</td><td>&nbsp;</td>
</tr>
<tr>
	<th colspan=5 class=title>&nbsp;</th>
</tr>
<tr>
	<th nowrap class=colhead>Payment Method</th>
	<th nowrap class=colhead>Payment Scheme</th>
	<th nowrap class=colhead>Priority</th>
	<th nowrap class=colhead>PMB Expiry (days)</th>
	<th nowrap class=colhead>Max Combine</th>
</tr>
##TP_LOOP pmb_idx {[tpGetVar NrPmtSchemes]}##
<tr>
	<td class="caption">##TP_PayMthdDesc##</td>
	<td class="caption">##TP_PmtScheme##</td>
	<td><input type="text" name="##TP_PayMthd##_##TP_PmtScheme##_Pri" size="3" maxlength="3" value="##TP_PMBPriority##" /></td>
	<td><input type="text" name="##TP_PayMthd##_##TP_PmtScheme##_PMBExp" size="3" maxlength="3" value="##TP_PMBPeriod##" /></td>
	<td><input type="text" name="##TP_PayMthd##_##TP_PmtScheme##_MaxComb" size="3" maxlength="3" value="##TP_MaxCombine##" /></td>
</tr>
##TP_ENDLOOP##
##TP_IF {[op_allowed UpdatePMBExpiry]}##
<tr>
	<td nowrap colspan="5" class="buttons"><input type="button" name="UpdPMBButton" value="Update" onClick="return fs(this,'UpdPMBSettings')" ></td>
</tr>
<input type="hidden" name="action" value="ADMIN::PMT_MULTIPLE::DoUpdPMB">
<input type="hidden" name="SubmitName" value="">
##TP_ENDIF##
</table>
</body>
</html>

<html>
<!-- $Id: pmt_detail.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>Payment Detail</title>
##TP_PLAY JS_WriteSelect.html##
<script>
var voidBets = "";
function fs(b,t)
{
	if (t == "Authorise" || t == "AuthoriseConfirm") {

		##TP_IF {[tpGetVar pay_mthd] == "WU" && [tpGetVar payment_sort] == "W"}##
			if (b.form.auth_code.value == "") {
				alert ("Please enter an MTCN number");
				return false;
			}
		##TP_ENDIF##

		##TP_IF {[OT_CfgGet FUNC_AUTH_PMT_EXTRA_INFO 0] == 1 && [tpGetVar pay_mthd] != "CC" && [tpGetVar pay_mthd] != "MB" && [tpGetVar pay_mthd] != "ENVO"}##
			if (b.form.extra_info.value.length > 160) {
				alert("Authorisation notes must be less than 160 characters");
				return false;
			}
		##TP_ENDIF##

		var r = confirm("Authorise payment?")
		if (r == false){
		 	return false;
		} else {
			b.form.SR_type.value=t;
			b.form.submit();
			return true;
	  	}
	}
	if (t == "Decline" || t == "DeclineConfirm") {

		##TP_IF {[OT_CfgGet FUNC_AUTH_PMT_EXTRA_INFO 0] == 1 && [tpGetVar pay_mthd] != "CC" && [tpGetVar pay_mthd] != "MB" && [tpGetVar pay_mthd]  != "EVNO"}##
			if (b.form.extra_info.value.length > 160) {
				alert("Authorisation notes must be less than 160 characters");
				return false;
			}
		##TP_ENDIF##

		var r = confirm("Cancel payment?")
		if (r == false){
		 	return false;
		} else {
			b.form.SR_type.value=t;
			b.form.submit();
			return true;
	  	}
	}
	if (t == "GetAuthCode") {
		var r = confirm("Get Authorisation Code via payment gateway ?");
		if (r == false) {
			return false;
		} else {
			b.form.SR_type.value=t;
			b.form.submit();
			return true;
		}
	}
	if (t == "UpdAuthCode") {
		var r = confirm("Update Authorisation Code ?");
		if (r == false){
		 	return false;
		} else {
			b.form.SR_type.value=t;
			b.form.submit();
			return true;
		}
	}
	if (t == "SendAuthCode") {
		if (b.form.auth_code.value =="CALL AUTH CENTRE"){
			alert("Please Enter an Authorisation Code");
			return false;
		}
		var r = confirm("Send Authorisation Code to payment gateway ?");
		if (r == false){
			return false;
		} else {
			b.form.SR_type.value=t;
			b.form.submit();
			return true;
		}
	}
	if (t == "DoPmtProcVoid") {
		var r = confirm("Void bet(s)##TP_IF {[tpGetVar status]=="R" || [tpGetVar status]=="L"}## and cancel payment##TP_ENDIF##?")
		if (r == false){
		 	return false;
		} else {
			b.form.SR_type.value=t;
			b.form.submit();
			return true;
	  	}
	}
	if (t == "DoPmtProcDecl") {
		var r = confirm("Cancel payment?")
		if (r == false){
		 	return false;
		} else {
			b.form.SR_type.value=t;
			b.form.submit();
			return true;
	  	}
	}

	b.disabled = true;
	b.value = "Busy...";

	b.form.SR_type.value=t;
	b.form.submit();
	return true;
}

function fs_man_adj(b,t,pmt_id) {
	b.disabled = true;
	b.value = "Busy...";
	b.form.SubmitName.value= t;

	b.form.action.value    = "ADMIN::ADJ::GoManAdj"
	b.form.ManAdj_ref_key.value   = "PMT";
	b.form.ManAdj_ref_id.value    = pmt_id
	b.form.submit();
	return true;
}

function fs_audit(b,t,tab)
{
	b.form.SubmitName.value=t;
	b.form.AuditInfo.value=tab;
	b.form.submit();
	return true;
}

function bet_desc(betid)
{
	document.form.action.value="ADMIN::BET::DoManualBetDesc";
	document.form.BetId.value=betid;
	document.form.SR_type.value="FromPmt";
	document.form.submit();
}

function upd_defended()
{
	var id_to_disable;
	var id_to_enable;
		
	var chargeback = document.getElementById("chargeback");
	var defended = document.getElementById("defended");
		
	if (chargeback  && defended ) {

		if (chargeback.checked == true) {

			defended.disabled = false;

		} else {

			defended.disabled = true;

			for(i = 0; i < defended.length; i++)
			{
				if(defended.options[i].value=="U")
				{
					defended.selectedIndex=i
				}
			}
		}
	}

	return false;

}

</script>
</head>
<body>
##TP_PLAY error_rpt.html##
##TP_PLAY msg_rpt.html##
<table border=0 cellspacing=0 cellpadding=3>
	<form name="form" action="##TP_CGI_URL##" method=post onSubmit="return false;">
	<input type="hidden" name="SubmitName" value="">
	<input type="hidden" name="action" value=ADMIN::PMT::GoPmtProcRequest>
	<input type="hidden" name="pay_mthd" value="##TP_pay_mthd##">
	<input type="hidden" name="pmt_id" value="##TP_acct_pmt_id##">
	<input type="hidden" name="status" value="##TP_status##">
	<input type="hidden" name="pay_sort_##TP_acct_pmt_id##" value="##TP_payment_sort##">
		
	<!-- Support ticket#42367: add elements for admin/tcl/pmt/make_payment.tcl format extraction -->
	<input type="hidden" name="pay_amt_##TP_acct_pmt_id##" value="##TP_amount##">
	<input type="hidden" name="pay_ccy_##TP_acct_pmt_id##" value="##TP_ccy_code##">
	<input type="hidden" name="cust_id_##TP_acct_pmt_id##" value="##TP_cust_id##">	
		
	<!-- For ManAdj -->
	<input type="hidden" name="ManAdj_ref_key" value="##TP_ManAdj_ref_key##">
	<input type="hidden" name="ManAdj_ref_id"  value="##TP_ManAdj_ref_id##">
	<input type="hidden" name="ManAdj_group"   value="PMT">
	<!-- bind search options -->
	<input type="hidden" name="cust_id" value="##TP_cust_id##">
	<input type="hidden" name="amount" value="##TP_amount##">
	<input type="hidden" name="SR_type" value="#">
	<input type="hidden" name="SR_username" value="##TP_SR_username##">
	<input type="hidden" name="SR_upper_username" value="##TP_SR_upper_username##">
	<input type="hidden" name="SR_fname" value="##TP_SR_fname##">
	<input type="hidden" name="SR_lname" value="##TP_SR_lname##">
	<input type="hidden" name="SR_email" value="##TP_SR_email##">
	<input type="hidden" name="SR_acct_no_exact" value="##TP_SR_acct_no_exact##">
	<input type="hidden" name="SR_acct_no" value="##TP_SR_acct_no##">
	<input type="hidden" name="SR_date_1" value="##TP_SR_date_1##">
	<input type="hidden" name="SR_date_2" value="##TP_SR_date_2##">
	<input type="hidden" name="SR_date_range" value="##TP_SR_date_range##">
	<input type="hidden" name="SR_status" value="##TP_SR_status##">
	<input type="hidden" name="SR_payment_sort" value="##TP_SR_payment_sort##">
	<input type="hidden" name="SR_channel" value="##TP_SR_channel##">
	<input type="hidden" name="SR_pay_mthd" value="##TP_SR_pay_mthd##">
	<input type="hidden" name="BetId" value ="">
	<input type="hidden" name="AuditInfo" value ="">

    ##TP_IF {[tpGetVar call_id] != ""}##
	<tr>
		<th colspan=3 class=title>Payment ###TP_ref_no## - Call ###TP_TCL {tpBufWrite [tpGetVar call_id]}##</th>
	</tr>
    ##TP_ELSE##
	<tr>
		<th colspan=3 class=title>Payment ###TP_ref_no##</th>
	</tr>
    ##TP_ENDIF##
    <!-- Customer Details -->
	<tr class=subtitle>
		<th colspan=3 align=left>Customer Details</th>
	</tr>
	<tr>
		<td class=caption>Username:</td>
		<td colspan="2"><a href="##TP_CGI_URL##?action=ADMIN::CUST::GoCust&CustId=##TP_cust_id##">##TP_username##&nbsp;</a></b></td>
	</tr>
	<tr>
		<td class=caption>Account No:</td>
		<td colspan="2">##TP_acct_no##&nbsp;</b></td>
	</tr>
	<tr>
		<td class=caption>Customer Id:</td>
		<td colspan="2" >##TP_cust_id##&nbsp;</b></td>
	</tr>
	<tr>
		<td class=caption>Title:</td>
		<td colspan="2">##TP_title##&nbsp;</b></td>
	</tr>
	<tr>
		<td class=caption>First Name:</td>
		<td colspan="2">##TP_fname##&nbsp;</b></td>
	</tr>
	<tr>
		<td class=caption>Last Name:</td>
		<td colspan="2">##TP_lname##</b></td>
	</tr>
	<tr class=subtitle>
		<th colspan=3 align=left>Payment Information</th>
	</tr>
	<tr>
		<td class=caption>Username:</td>
		<td colspan="2">##TP_username##&nbsp;(Acct # ##TP_acct_no##)</b></td>
	</tr>
	<tr>
		<td class=caption>Method:</td>
		<td colspan="2"><a href="##TP_CGI_URL##?action=ADMIN::PMT::go_pay_mthd_auth&cpm_id=##TP_cpm_id##&CustId=##TP_cust_id##&pay_mthd=##TP_pay_mthd##">##TP_IF {[tpGetVar pay_mthd]=="ENVO"}####TP_pay_mthd_desc## ##TP_PMT_envoy_payment_type####TP_ELSE####TP_pay_mthd_desc####TP_ENDIF##</a>&nbsp;</td>
	</tr>
	##TP_IF {[tpGetVar pay_mthd]=="BANK"}##
	<tr>
		<td class=caption>Route:</td>
		<td colspan="2">##TP_route##</td>
	</tr>
	##TP_ENDIF##
	<tr>
		<td class=caption>Sort:</td>
			<td colspan="2"><script>write_which("##TP_payment_sort##","D","Deposit","W","Withdrawal")</script></td>
	</tr>
	<tr>
		<td class=caption>Amount:</td>
		<td colspan="2">##TP_ccy_code## ##TP_amount##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Commission:</td>
		<td colspan="2">##TP_ccy_code## ##TP_commission##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Status:</td>
		<td colspan="2">
		<script>
			write_which('##TP_TCL {tpGetVar status}##','Y','Good','N','Bad','P','Pending','R','Referred','I','Incomplete','L','Later','U','Unknown','X','Cancelled','B','Reversed')
		</script>

		##TP_IF {[tpGetVar status] == "P"}##
		##TP_IF {[tpBindGet is_delayed] == "Y"}## (delayed) ##TP_ELSE## (non delayed) ##TP_ENDIF##
		##TP_ENDIF##

		##TP_IF {[tpGetVar pg_type] == "COMMIDEA_ATH" && [tpGetVar status] == "Y"}##
		##TP_IF {[tpGetVar Fulfilled ""] == "Y"}## - fulfilled##TP_ELSEIF  {[tpGetVar Fulfilled ""] == "N"}## - unfulfilled##TP_ENDIF##
		##TP_ENDIF##
		</td>
	</tr>
	<tr>
		<td class=caption>Date of Payment:</td>
		<td colspan="2">##TP_settled_at##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Operator:</td>
		<td colspan="2">##TP_operator##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Settled By:</td>
		<td colspan="2">##TP_settled_by##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Line Number:</td>
		<td colspan="2">##TP_line_no##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>IP Address:</td>
		<td colspan="2">##TP_ipaddr##&nbsp;</td>
	</tr>
	##TP_IF {[OT_CfgGet PMT_RECEIPT_FUNC 0] && [tpBindGet receipt] != ""}##
	<tr>
		<td class=caption>Receipt:</td>
		<td colspan="2">##TP_receipt##&nbsp;</td>
	</tr>
	##TP_ENDIF##
	##TP_IF {[tpGetVar pay_mthd]=="CC"}##
	<tr>
		<td class=caption>Auth. Code:</td>
		##TP_IF {[tpGetVar status]=="R"}##
		<td><input type="text" name="auth_code" value="##TP_auth_code##" size=32></td>
		<td align="right" class="buttons">
			<input type=button class="btn_def" value="Send Auth Code" name="SendAuthCode" onClick="return fs(this,'SendAuthCode')" class="buttons">
			<input type=button class="btn_def" value="Store Auth Code" name="UpdAuthCode"  onClick="return fs(this,'UpdAuthCode')"  class="buttons">
		</td>
		##TP_ELSEIF {[tpGetVar status]=="I"}##
		<td><input type="text" name="auth_code" value="##TP_auth_code##" size=32></td>
		</td>
		##TP_ELSEIF {[tpGetVar status]=="L"}##
		<td>##TP_auth_code##&nbsp;</td>
		<td><align="right" class="buttons">
			<input type=button class="btn_def" value="Get Auth Code via Payment Gateway" onClick="return fs(this,'GetAuthCode')" class="buttons">
		</td>
		##TP_ELSE##
			<td colspan="2">##TP_auth_code##&nbsp;</td>
		##TP_ENDIF##
	</tr>
	##TP_ENDIF##

	##TP_IF {[tpGetVar pay_mthd] == "PSC"}##
	<tr>
		<td class=caption>Transaction ID:</td>
		<td colspan="2">##TP_unique_id##</td>
	</tr>
	<tr>
		<td class=caption>PSC Info:</td>
		<td colspan="2">
			##TP_IF {[tpGetVar NumSerials] > 0}##
			<table border="1" width="100%">
				<tr>
					<td><strong>Serial</strong></td>
					<td><strong>Value</strong></td>
				</tr>
				##TP_LOOP psc_idx {[tpGetVar NumSerials]}##
				<tr>
					<td>##TP_psc_serial##</td>
					<td>##TP_psc_value##</td>
				</tr>
				##TP_ENDLOOP psc_idx##
			</table>
			##TP_ENDIF##
		</td>
	</tr>
	##TP_ENDIF##

	<tr>
		<td class=caption>Extra Info:</td>
		<td colspan="2">##TP_PMT_extra_info##&nbsp;</td>
	</tr>
	<tr>
		<th colspan=3 class="buttons">
			##TP_IF {[tpGetVar PERM_ViewAudit 0]}##
				<input type=button class="btn_def" value="View Audit History" onClick="return fs_audit(this,'GoAudit','tPmt')">&nbsp;
			##TP_ENDIF##
			<input type=button class="btn_def" value="Create ManAdj" onClick="return fs_man_adj(this,'GoManAdj','##TP_acct_pmt_id##')">
		</th>
	</tr>


##TP_IF {[tpGetVar pay_mthd]=="CC"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Card Details:</th>
	</tr>
	##TP_PLAY pmt/pmt_detail_CC.html##
    <tr class=subtitle>
		<th colspan=3 align=left>Payment Details:</th>
	</tr>
	<tr>
		<td class=caption>Pmt Gateway:</td>
		<td colspan="2">##TP_PMT_pg_host_desc## &nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Merchant Acct:</td>
		<td colspan="2">##TP_PMT_pg_acct_desc##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Response Code:</td>
		<td colspan="2">##TP_PMT_gw_auth_code##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Unique Id:</td>
	##TP_IF {[tpGetVar pg_type] == "COMMIDEA_ATH" &&
	([tpGetVar status]=="U" || [tpGetVar status]=="L")}##
	<td colspan="2">
		<input type="text" name="PMT_gw_uid_TID" value="##TP_PMT_gw_uid_TID##"
		size=32 autocomplete="off"> (TransactionID) <br>
		<input type="text" name="PMT_gw_uid_EFTSN"
		value="##TP_PMT_gw_uid_EFTSN##" size=32 autocomplete="off"> (EFTSN)
	</td>
	<tr>
		<td class=caption>Auth. Code:</td>
		<td><input type="text" name="PMT_auth_code" value="##TP_auth_code##" size=32 autocomplete="off"></td>
	</tr>
	##TP_ELSE##
		<td colspan="2">##TP_PMT_gw_uid##&nbsp;</td>
		##TP_ENDIF##
	</tr>
	##TP_IF {[OT_CfgGet DISPLAY_PMT_DETAILS_CVV2_RESP 0]}##
	<tr>
		<td class=caption>CVV2 Response:</td>
		<td colspan="2">##TP_PMT_cvv2_resp##&nbsp;</td>
	</tr>
	##TP_ENDIF##
	<tr>
		<td class=caption>Ref. No.:</td>
		<td colspan="2">##TP_PMT_ref_no##&nbsp;</td>
	</tr>
	##TP_IF {[tpGetVar pg_type] == "SAFECHARGE"}##
	<tr>
		<td class=caption>Acquiring Bank:</td>
		<td colspan="2">##TP_PMT_gw_acq_bank##&nbsp;</td>
	</tr>
	##TP_ENDIF##
	<tr>
		<td class=caption>Return Msg.:</td>
		<td colspan="2">##TP_PMT_gw_ret_msg##&nbsp;</td>
	</tr>
	##TP_IF {[OT_CfgGet DISP_PMT_DETAILS_AUTH_TYPE 1]}##
	<tr>
		<td class=caption>3D Secure / VBV Action:</td>
		<td colspan="2">##TP_PMT_auth_type##&nbsp;</td>
	</tr>
	##TP_ENDIF##

    <tr class=subtitle>
		<th colspan=3 align=left>Payment Gateway Response codes:</th>
	</tr>
	##TP_IF {[OT_CfgGet PMT_STORE_VERBOSE_3DS_CODES 0]}##
		##TP_IF {[tpGetVar payment_sort] == "D"}##
		<tr>
			<td class=caption>Enrol Response Code:</td>
			<td colspan="2">##TP_PMT_enrol_3d_resp##&nbsp;</td>
		</tr>
		##TP_ENDIF##
	<tr>
		<td class=caption>Auth Response Code:</td>
		<td colspan="2">##TP_PMT_auth_3d_resp##&nbsp;</td>
	</tr>
	##TP_ENDIF##
	<tr>
		<td class=caption>Return Code:</td>
		<td colspan="2">##TP_IF {[tpGetVar pg_type] == "COMMIDEA"}## ##TP_PMT_commidea_gw_ret_code## ##TP_ELSE## ##TP_PMT_gw_ret_code## ##TP_ENDIF##&nbsp;</td>
	</tr>
##TP_ELSEIF {[tpGetVar pay_mthd]=="C2P"} ##

	<tr class=subtitle>
		<th colspan=3 align=left>C2P Details:</th>
	</tr>

	##TP_PLAY pmt/pmt_detail_C2P.html##

##TP_ELSEIF {[tpGetVar pay_mthd]=="PB"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Paybox Details:</th>
	</tr>
	##TP_PLAY pmt/pmt_detail_PB.html##
    <tr class=subtitle>
		<th colspan=3 align=left>Payment Details:</th>
	</tr>
	<tr>
		<td class=caption>Return Code:</td>
		<td colspan="2">##TP_PMT_gw_ret_code##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Response Code:</td>
		<td colspan="2">##TP_PMT_gw_auth_code##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Unique Id:</td>
		<td colspan="2">##TP_PMT_gw_uid##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Ref. No.:</td>
		<td colspan="2">##TP_PMT_ref_no##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Return Msg.:</td>
		<td colspan="2">##TP_PMT_gw_ret_msg##&nbsp;</td>
	</tr>
##TP_ELSEIF {[tpGetVar pay_mthd]=="EP"}##
  <tr class="subtitle">
    <th colspan="3" align="left">Earthport Details:</th>
  </tr>
  ##TP_PLAY pmt/pmt_detail_EP.html##
  <tr class="subtitle">
    <th colspan="3" align="left">Payment Details:</th>
  </tr>
  <tr>
    <td class="caption">Ref. No.:</td>
    <td colspan="2">##TP_PMT_ref_no##</td>
  </tr>
  <tr>
    <td class="caption">Trade ID:</td>
    <td colspan="2">##TP_PMT_trade_id##</td>
  </tr>
  ##TP_IF {[tpGetVar payment_sort] == "D"}##
  <tr>
    <td class="caption">External ID:</td>
    <td colspan="2">##TP_PMT_ext_id##</td>
  </tr>
  <tr>
    <td class="caption">Amount from Earthport Account:</td>
    <td colspan="2">##TP_PMT_ccy_code## ##TP_PMT_ext_amount##</td>
  </tr>
  <tr>
    <td class="caption">Trade Description:</td>
    <td colspan="2">##TP_PMT_trade_desc##</td>
  </tr>
  <tr>
    <td class="caption">Transaction Time:</td>
    <td colspan="2">##TP_PMT_trans_time##</td>
  </tr>
  <tr>
    <td class="caption">Trade Type</td>
    <td colspan="2">##TP_PMT_trade_type##</td>
  </tr>
  ##TP_ELSEIF {[tpGetVar payment_sort] == "W"}##
  <tr>
    <td class="caption">Amount to Earthport Account:</td>
    <td colspan="2">##TP_PMT_ccy_code## ##TP_PMT_ext_amount##</td>
  </tr>
  ##TP_ENDIF##
  <tr>
    <td class="caption">Exchange Rate to GBP:</td>
    <td colspan="2">##TP_PMT_exch_to_gbp##</td>
  </tr>
  <tr>
    <td class="caption">Exchange Rate from GBP:</td>
    <td colspan="2">##TP_PMT_exch_frm_gbp##</td>
  </tr>
##TP_ELSEIF {[tpGetVar pay_mthd]=="CHQ"}##

	##TP_IF {[tpGetVar payment_sort] == "D"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Payment Details:</th>
	</tr>
	<tr>
		<td class=caption>Payer</td>
		<td colspan="2">##TP_PMT_payer##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Cheque No.</td>
		<td colspan="2">##TP_PMT_chq_no##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Cheque Date</td>
		<td colspan="2">##TP_PMT_chq_date##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Sort Code</td>
		<td colspan="2">##TP_PMT_chq_sort_code##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Account No.</td>
		<td colspan="2">##TP_PMT_chq_acct_no##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Internal Ref.</td>
		<td colspan="2">##TP_PMT_rec_delivery_ref##&nbsp;</td>
	</tr>
	##TP_ELSEIF {[tpGetVar payment_sort] == "W"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Cheque Details</th>
	</tr>
	##TP_PLAY pmt/pmt_detail_CHQ.html##
	<tr class=subtitle>
		<th colspan=3 align=left>Payment Details</th>
	</tr>
	<tr>
		<td class=caption>Cheque No.:</td>
		<td colspan="2">##TP_PMT_chq_no##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Cheque Date:</td>
		<td colspan="2">##TP_PMT_chq_date##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Internal Ref.:</td>
		<td colspan="2">##TP_PMT_rec_delivery_ref##&nbsp;</td>
	</tr>
	##TP_ENDIF##
##TP_ELSEIF {[tpGetVar pay_mthd]=="BANK"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Bank Details</th>
	</tr>
	##TP_PLAY pmt/pmt_detail_BANK.html##
	<tr class=subtitle>
		<th colspan=2 align=left>Payment Details</th>
	</tr>
	<tr>
		<td class=caption>Bank Code:</td>
		<td colspan="2">##TP_PMT_code##</td>
	</tr>
##TP_ELSEIF {[tpGetVar pay_mthd]=="WU"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Western Union Details</th>
	</tr>
	##TP_PLAY pmt/pmt_detail_WU.html##
	<tr class=subtitle>
		<th colspan=2 align=left>Payment Details</th>
	</tr>
	<tr>
		<td class=caption>MTCN:</td>
		##TP_IF {[tpGetVar status]=="P" && [tpGetVar payment_sort]=="W"}##
		<td colspan="2"><input type="text" name="auth_code" value="##TP_PMT_mtcn##" size=32></td>
		##TP_ELSE##
		<td colspan="2">##TP_PMT_mtcn##</td>
		<input type="hidden" name="auth_code" value="##TP_PMT_mtcn##">
		##TP_ENDIF##
	</tr>
	<tr>
		<td class=caption>Location of Email req.:</td>
		<td colspan="2">##TP_PMT_req_location##</td>
	</tr>
##TP_ELSEIF {[tpGetVar pay_mthd]=="GDEP" || [tpGetVar pay_mthd]=="GWTD"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Payment Details</th>
	</tr>
	<tr>
		<td class=caption>Payment Type:</td>
		<td colspan="2">##TP_PMT_pay_type##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Description:</td>
		<td colspan="2">##TP_PMT_blurb##&nbsp;</td>
	</tr>
##TP_ELSEIF {[tpGetVar pay_mthd]=="BASC"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Payment Details</th>
	</tr>
	<tr>
		<td class=caption>Location / ATM Number:</td>
		<td colspan="2">##TP_PMT_desc##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Reference Number:</td>
		<td colspan="2">##TP_PMT_ext_ref##&nbsp;</td>
	</tr>
##TP_ELSEIF {[tpGetVar pay_mthd]=="CSH"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Payment Details</th>
	</tr>
	<tr>
		<td class=caption>Outlet:</td>
		<td colspan="2">##TP_PMT_outlet##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>ID:</td>
		<td colspan="2">##TP_PMT_id_serial_no##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Manager:</td>
		<td colspan="2">##TP_PMT_manager##&nbsp;</td>
	</tr>
##TP_ELSEIF {[tpGetVar pay_mthd]=="BC"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Betcard Details</th>
	</tr>

	<tr>
		<td class=caption>Vendor:</td>
		<td colspan="2">
			<a href="##TP_CGI_URL##?action=ADMIN::BETCARD::GoVendor&vendor_id=##TP_PMT_vendor_id##">
			##TP_PMT_vendor_uname##&nbsp;
			</a>
		</td>
	</tr>

	<tr>
		<td class=caption>Betcard No:</td>
		<td colspan="2">
			<a href="##TP_CGI_URL##?action=ADMIN::BETCARD::DoBetcard&SubmitName=FindBetcards&betcard_id=##TP_PMT_betcard_id##">
			##TP_PMT_betcard_no_enc##&nbsp;
			</a>
		</td>
	</tr>
##TP_ELSEIF {[tpGetVar pay_mthd]=="ENET"}##
	<tr class=subtitle>
		<th colspan=3 align=left>eNETS</th>
	</tr>

	<tr>
		<td class=caption>eNETs Ref Id:</td>
		<td colspan="2">
			##TP_PMT_gw_uid##
		</td>
	</tr>
	<tr>
		<td class=caption>eNETs Pmt Id:</td>
		<td colspan="2">
			##TP_PMT_gw_pmt_id##
		</td>
	</tr>
	<tr>
		<td class=caption>Order status:</td>
		<td colspan=2>
			<script>
write_which('##TP_PMT_ext_ord_status##', 'E', 'Prepared', 'O', 'Order sent', 'R', 'Order response received', 'D', 'Customer redirected', 'P', 'Payment response received');
			</script>
		</td>
	</tr>
	<tr>
		<td class=caption>Payment status:</td>
		<td colspan="2">
			##TP_PMT_gw_ret_msg##
		</td>
	</tr>
##TP_ELSEIF {[tpGetVar pay_mthd]=="MB"}##
	<tr class=subtitle>
		<th colspan=3 align=left>MoneyBooker Details</th>
	</tr>
	##TP_PLAY pmt/pmt_detail_MB.html##
	<tr>
		<td class=caption>MoneyBookers Ref Id:</td>
		<td colspan="2">
			##TP_PMT_mb_transaction_id##
		</td>
	</tr>
	<tr>
		<td class=caption>MoneyBookers Session Id:</td>
		<td colspan="2">
			##TP_PMT_sid##
		</td>
	</tr>
	<tr>
		<td class=caption>MoneyBookers Payment Status:</td>
		<td colspan="2">
			##TP_PMT_mb_status##
		</td>
	</tr>
	<tr>
		<td class=caption>MoneyBookers Payment Type:</td>
		<td colspan="2">
			##TP_PMT_mb_payment_type##
		</td>
	</tr>
##TP_ELSEIF {[tpGetVar pay_mthd]=="ENVO"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Envoy Details</th>
	</tr>
	##TP_PLAY pmt/pmt_detail_ENVO.html##
	<tr>
		<td class=caption>Envoy EPAC Ref:</td>
		<td colspan="2">
			##TP_PMT_envoy_epac_ref##
		</td>
	</tr>
	<tr>
		<td class=caption>Envoy Submethod:</td>
		<td colspan="2">
			##TP_PMT_envoy_payment_type##
		</td>
	</tr>
##TP_ELSEIF {[tpGetVar pay_mthd]=="CB"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Click and Buy Details</th>
	</tr>
	##TP_PLAY pmt/pmt_detail_CB.html##
	<tr>
		<td class=caption>Click and Buy BDR ID:</td>
		<td colspan="2">##TP_PMT_cb_bdr_id##&nbsp;</td>
	</tr>
##TP_ELSEIF {[tpGetVar pay_mthd]=="NTLR"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Neteller Details</th>
	</tr>
	##TP_PLAY pmt/pmt_detail_NTLR.html##
##TP_ELSEIF {[tpGetVar pay_mthd]=="PPAL"}##
	<tr class=subtitle>
		<th colspan=3 align=left>PayPal Details</th>
	</tr>
	<tr>
		<td class=caption>Invoice No.:</td>
		<td colspan="2">
			##TP_PMT_pp_inv_num##
		</td>
	</tr>
	<tr>
		<td class=caption>PayPal Transaction ID:</td>
		<td colspan="2">
			##TP_PMT_pp_txn_id##
		</td>
	</tr>
	<tr>
		<td class=caption>Extra info:</td>
		<td colspan="2">
			##TP_PMT_pp_extra_info##
		</td>
	</tr>
	<tr>
		<td class=caption>Case id:</td>
		<td colspan="2">
			##TP_PMT_pp_case_id##
		</td>
	</tr>
	<tr>
		<td class=caption>Case info:</td>
		<td colspan="2">
			##TP_PMT_pp_case_info##
		</td>
	</tr>
	<input type="hidden" name="ppal_txn_id" value ="##TP_PMT_pp_txn_id##" />
	<input type="hidden" name="ppal_inv_num" value ="##TP_PMT_pp_inv_num##" />
	<input type="hidden" name="ppal_cr_date" value="##TP_PMT_cr_date##" />
	<input type="hidden" name="ppal_ccy_code" value="##TP_ccy_code##" />

	##TP_IF {[tpGetVar SHOW_PPAL_TXN_DETAILS 0]}##
		<tr class=subtitle>
			<th colspan=3 align=left>PayPal Returned Transaction Details</th>
		</tr>
		<tr>
			<td class=caption>Order Time:</td>
			<td colspan="2">
			##TP_ppal_ordertime##
			</td>
		</tr>
		<tr>
			<td class=caption>Receiver email:</td>
			<td colspan="2">
				##TP_ppal_receiveremail##
			</td>
		</tr>
		<tr>
			<td class=caption>Payer email:</td>
			<td colspan="2">
				##TP_ppal_email##
			</td>
		</tr>
		<tr>
			<td class=caption>Payer name:</td>
			<td colspan="2">
				##TP_ppal_firstname##&nbsp;##TP_ppal_middlename##&nbsp;##TP_ppal_lastname##
			</td>
		</tr>
		<tr>
			<td class=caption>Payer Status:</td>
			<td colspan="2">
			##TP_ppal_payerstatus##
			</td>
		</tr>
		<tr>
			<td class=caption>Transaction ID:</td>
			<td colspan="2">
			##TP_ppal_transactionid##
			</td>
		</tr>
		<tr>
			<td class=caption>Currency code:</td>
			<td colspan="2">
			##TP_ppal_currencycode##
			</td>
		</tr>
		<tr>
			<td class=caption>Amount:</td>
			<td colspan="2">
			##TP_ppal_amt##
			</td>
		</tr>
		<tr>
			<td class=caption>Fee Amount:</td>
			<td colspan="2">
			##TP_ppal_feeamt##
			</td>
		</tr>
		<tr>
			<td class=caption>Transaction Type:</td>
			<td colspan="2">
			##TP_ppal_transactiontype##
			</td>
		</tr>
		<tr>
			<td class=caption>Status:</td>
			<td colspan="2">
			##TP_ppal_paymentstatus##
			</td>
		</tr>
		<tr>
			<td class=caption>Reason Code:</td>
			<td colspan="2">
			##TP_ppal_reasoncode##
			</td>
		</tr>
	##TP_ENDIF##

##TP_ELSEIF {[lsearch -exact {UKSH IKSH} [tpGetVar pay_mthd]] != -1}##
		<tr class="subtitle">
			<th colspan="3" align="left">
			##TP_IF {[tpGetVar pay_mthd] == "IKSH"}##
				Ukash International
			##TP_ELSE##
				Quickcash
			##TP_ENDIF##
				Details
			</th>
		</tr>
		<tr>
			<td class="caption">Voucher:</td>
			<td colspan="2">##TP_PMT_voucher##</td>
		</tr>
		<tr>
			<td class="caption">Expiry:</td>
			<td colspan="2">##TP_PMT_expiry##</td>
		</tr>
		<tr>
			<td class="caption">Transaction ID:</td>
			<td colspan="2">##TP_PMT_txn_id##</td>
		</tr>
		<tr>
			<td class="caption">Error Code:</td>
			<td colspan="2">##TP_PMT_err_code##</td>
		</tr>
		<tr>
			<td class="caption">Error Description:</td>
			<td colspan="2">##TP_PMT_err_desc##</td>
		</tr>
	##TP_IF {[tpGetVar pay_mthd] == "IKSH"}##
		<tr>
			<td class="caption">Product Code:</td>
			<td colspan="2">##TP_PMT_prod_code##</td>
		</tr>
	##TP_ENDIF##

##TP_ELSEIF {[tpGetVar pay_mthd]=="SHOP"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Payment Details</th>
	</tr>
	<tr>
		<td class=caption>Shop Number:</td>
		<td colspan="2">##TP_PMT_shop_no##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Shop Name:</td>
		<td colspan="2">##TP_PMT_shop_name##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Payment Type:</td>
		<td colspan="2">##TP_PMT_shop_pmt_type##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Ticket Number:</td>
		<td colspan="2">##TP_PMT_ticket_num##&nbsp;</td>
	</tr>
	<tr>
		<td class=caption>Staff Member:</td>
		<td colspan="2">##TP_PMT_staff_member##&nbsp;</td>
	</tr>
##TP_ELSEIF {[tpGetVar pay_mthd] == "PSC"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Payment Details:</th>
	</tr>
	<tr>
		<td class=caption>State:</td>
		<td colspan="2">##TP_PMT_state## <script>write_which("##TP_PMT_state##","R","(Created)","S","(Disposed)","E","(Debited)","O","(Consumed)","L","(Cancelled)","I","(Invalid)","X","(Expired)")</script></td>
	</tr>
	<tr>
		<td class=caption>Error Code:</td>
		<td colspan="2">##TP_PMT_errcode##</td>
	</tr>
	<tr>
		<td class=caption>Error Message:</td>
		<td colspan="2">##TP_PMT_errmessage##</td>
	</tr>
	<tr>
		<td class=caption>Pmt Gateway:</td>
		<td colspan="2">##TP_PMT_pg_host_desc##</td>
	</tr>
	<tr>
		<td class=caption>Merchant Acct:</td>
		<td colspan="2">##TP_PMT_pg_acct_desc##</td>
	</tr>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_AUTH_PMT_EXTRA_INFO 0] == 1 && [tpGetVar status] == "P" && [tpGetVar pay_mthd] != "CC"}##
	<tr class=subtitle>
		<th colspan=3 align=left>Authorisation Notes</th>
	</tr>
	<tr>
		<td class=caption>Comments:</td>
		<td colspan="2">
			<input type="text" name="extra_info" value="##TP_PMT_extra_info##" size="32" maxlength="160">
		</td>
	</tr>
##TP_ENDIF##
	<tr>
		<th colspan=3 class="buttons">
		##TP_IF {[tpGetVar PendFraudFlags] == 1}##
		##TP_IF {[tpGetVar ShowFraudCheckAuth] == 1}##
		<input type=button value="Authorise Fraud Check" onClick="return fs(this,'AuthoriseFC')">
		##TP_ENDIF##
		##TP_IF {[tpGetVar ShowLargeRetAuth] == 1}##
		<input type=button value="Authorise Large Return" onClick="return fs(this,'AuthoriseLR')">
		##TP_ENDIF##
		<input type=button value="Decline"   onClick="return fs(this,'Decline')">
		##TP_COMMENT If it is MoneyBookers then display the following##
		##TP_ELSEIF {[tpGetVar pay_mthd] == "MB"}##
			##TP_IF {[tpGetVar payment_sort] == "W"}##
				##TP_IF {[tpGetVar status] == "I" || [tpGetVar status] == "P"}##
					<input type=button value="Authorise" onClick="return fs(this,'Authorise')">
					<input type=button value="Decline"   onClick="return fs(this,'Decline')">
				##TP_ENDIF##
			##TP_ELSE##
				##TP_IF {[tpGetVar status] == "U"}##
					<input type=button value="Re-request Status Report" onClick="return fs(this,'Repost')">
					<input type=button value="Decline"   onClick="return fs(this,'Decline')">
				##TP_ELSEIF {[tpGetVar status] == "P"}##
					<input type=button value="Decline"   onClick="return fs(this,'Decline')">
				##TP_ENDIF##
			##TP_ENDIF##
		##TP_ELSE##
			##TP_IF {[tpGetVar status]=="I"}##
				##TP_IF {[tpGetVar pay_mthd]!="PSC" || [tpGetVar status] == "U"}##
				<input type=button class="btn_def" value="Authorise" onClick="return fs(this,'DoPmtProcAuth')">
				##TP_ENDIF##
				<input type=button class="btn_def" value="Decline"   onClick="return fs(this,'DoPmtProcDecl')">
			##TP_ELSEIF {
				[tpGetVar status]=="P" &&
				(([tpGetVar pay_mthd]=="WU"|| [tpGetVar pay_mthd]=="CB") && [tpGetVar payment_sort]=="W" ||
					[OT_CfgGet FUNC_AUTH_PMT_EXTRA_INFO 0] && [tpGetVar pay_mthd]!="CB" )
			}##
				##TP_IF {[tpGetVar pay_mthd]!="PSC" || [tpGetVar status] == "U"}##
				<input type=button class="btn_def" value="Authorise" onClick="return fs(this,'Authorise')">
				##TP_ENDIF##
				##TP_IF {[tpGetVar pay_mthd]!="CB"}##
				<input type=button class="btn_def" value="Decline"   onClick="return fs(this,'Decline')">
				##TP_ELSE##
				<input type="button" class="btn_def" value="Decline" onclick="return fs(this,'DoPmtProcDecl');" />

				##TP_ENDIF##
			##TP_ENDIF##
			##TP_IF {[tpGetVar pay_mthd]=="PPAL" && ![tpGetVar SHOW_PPAL_TXN_DETAILS 0]}##
				<input type="button" class="btn_def" value="Get Transaction Details" onClick="return fs(this,'DoPmtPPALTxnSearch')" />
			##TP_ENDIF##
			##TP_IF {[tpGetVar PERM_ViewAudit 0] && [tpGetVar pay_mthd]=="CC"}##
			<input type=button class="btn_def" value="View Audit History" onClick="return fs_audit(this,'GoAudit','tPmtCC')">
			##TP_ENDIF##

			##TP_IF {[tpGetVar pg_type] == "COMMIDEA_ATH" &&
			([tpGetVar status]=="U" || [tpGetVar status]=="L")}##
			##TP_IF {[op_allowed PmtAuthDecline] && [op_allowed PmtAuthCOMM]}##
			<input type=button class="btn_def" value="Authorise" onClick="return fs(this,'AuthoriseConfirm')">
			##TP_ENDIF##
			<input type=button class="btn_def" value="Decline"   onClick="return fs(this,'DeclineConfirm')">
			<input type="hidden" name="PMT_pg_type" value="##TP_TCL {tpBufWrite [tpGetVar pg_type]}##">
			<input type=button class="btn_def" value="Send Confirmation Message"
			onClick="return fs(this,'DoPmtUpdateData')">
			##TP_ENDIF##
			&nbsp;
		##TP_ENDIF##

        </th>
	</tr>


	##TP_IF {[tpGetVar pay_mthd]=="CC"}##
		<tr class=subtitle>
			<th colspan=3 align=left>Chargebackâ€™s Defended</th>
		</tr>
		<tr>
			<td class=caption>Chargeback:</td>
			<td>
				##TP_IF {[op_allowed chargeback]}##
					<input type="checkbox" name="chargeback" id="chargeback" value="1" ##TP_IF {[tpGetVar isChargeback 0] == 1}## checked ##TP_ENDIF## onclick="upd_defended();"/>
				##TP_ELSEIF {[tpGetVar isChargeback 0] == 1}##
					Yes
				##TP_ELSE##
					No
				##TP_ENDIF##
			</td>
		</tr>
	
		<tr>
			<td class=caption>Defended:</td>
			<td>
				##TP_IF {[tpGetVar PERM_chargeback 0]}##
					<select name="defended" id="defended" ##TP_IF {[tpGetVar isChargeback 0] == 0}## disabled ##TP_ENDIF##>
						<script>
							write_select('##TP_defended##','U','Unset','D','Defended','N','Not Defended')
						</script>
					</select>
				##TP_ELSE##
					##TP_defended_label##
				##TP_ENDIF##
			</td>
		</tr>

		##TP_IF {[tpGetVar PERM_chargeback 0]}##
			<tr>
				<td>
					<input type=button class="btn_def" value="Change Chargeback" onClick="return fs(this,'DoChargeback')">
				</td>
				<td>
					&nbsp;
				</td>
			</tr>
		##TP_ENDIF##

	##TP_ENDIF##


	<tr class=subtitle>
		<th colspan=3 align=left>Linked Manual Adjustments</th>
	</tr>
	<tr>
		<td class=caption>Manual Adjustments:</td>
		<td>
			##TP_LOOP adj_idx {[tpGetVar NumAdjs]}##
				<a href="##TP_CGI_URL##?action=ADMIN::TXN::MADJ::GoTxn&&op_ref_id=##TP_ManAdjId##">##TP_ManAdjId##</a><br>
			##TP_ENDLOOP##
		</td>
	</tr>

	##TP_IF {[OT_CfgGet FUNC_IOVATION_SNARE 0] || 1}##
	<tr class="subtitle">
		<th colspan="3" align="left">Iovation</th>
	</tr>
	<tr>
		<td class="caption">Device alias</td>
		<td colspan="2">##TP_iova_device_alias##&nbsp;</td>
	</tr>
	<tr>
		<td class="caption">Response</td>
		<td colspan="2">##TP_iova_response##&nbsp;</td>
	</tr>
	##TP_ENDIF##

</table>

<table border=0 cellspacing=0 cellpadding=3>
    ##TP_IF {([string first [tpGetVar status] "RL"]>=0 && [tpGetVar payment_sort] == "D")}##
    ##TP_PLAY pmt/pmt_bet_list.html##
    ##TP_ENDIF##
</table>
##TP_IF {[tpGetVar status]=="R" && ([tpGetVar payment_sort] == "W" || [tpGetVar NumBets 0] == 0)}##
<table border=0 cellspacing=0 cellpadding=3>
	<tr>
		<th colspan=3 class="buttons">
			<input type=button class="btn_def" value="Decline Payment" onClick="return fs(this,'DoPmtProcDecl')">
		</th>
	</tr>
</table>
##TP_ENDIF##
</form>
</body>
</html>

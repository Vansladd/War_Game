<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
	<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
	<title>Customer Payment Method Rule</title>
	
	##TP_PLAY JS_WriteSelect.html##
	<script>
		function fs(b,t)
		{
			if (b.form.name == "ruleForm") {
				if (b.form.RuleGroupSelect.value == "-") {
					b.form.RuleGroup.value = b.form.RuleGroupText.value;
				}
				else {
					b.form.RuleGroup.value = b.form.RuleGroupSelect.value;
				}
			}
			
			
			b.form.SubmitName.value=t;
			b.form.submit();
			return true;
		}
		
		function fs_rule(b,t,code)
		{
			b.form.code_id.value=code;
			b.form.lang.value="en";
			b.form.SubmitName.value=t;
			b.form.submit();
			return true;
		}
		
		function fs_op(b,t,id) 
		{
			b.form.OpId.value = id;
			b.form.SubmitName.value=t;
			b.form.submit();
			return true;
		}
		
	</script>
</head>
	
<body>
	##TP_PLAY msg_rpt.html##
	##TP_PLAY error_rpt.html##
	
	<form name="ruleForm" action="##TP_CGI_URL##" method="get">
	<table border="0" cellspacing="0" cellpadding="2">
		<tr>
			<th colspan="3" class="title">
				##TP_IF {[tpGetVar CPMRuleType "R"] == "M"}##
				Customer Payment Method Message
				##TP_ELSE##
				Customer Payment Method Rule
				##TP_ENDIF##
			</th>
		</tr>
		
		<tr>
			<td class="caption">Rule Name</td>
			<td><input name="RuleName" type="text" size="20" value="##TP_RuleName##"></td>
			<td>&nbsp;</td>
		</tr>
		
		<tr>
			<td class="caption">Rule Group</td>
			<td colspan="2">
				<select name="RuleGroupSelect">
				<script>
					write_select('##TP_RuleGroup##'
						,'-','None / New Group -->'
						##TP_LOOP grp_idx {[tpGetVar NumGrps]}##
							,"##TP_RuleGrp##","##TP_RuleGrp##"
						##TP_ENDLOOP##
						)
				</script>
				</select>
				&nbsp;<input name="RuleGroupText" type="text" size="20" value="">
			</td>
		</tr>
		
		<tr>
			<td class="caption">Status</td>
			<td colspan="2">
				<select name="RuleStatus">
				<script>
					write_select('##TP_RuleStatus##'
						,'A','Active'
						,'S','Suspended'
						,'X','Removed'
						)
				</script>
				</select>
			</td>
		</tr>
	
		##TP_IF {[tpGetVar CPMRuleType "R"] == "M"}##
		<tr>
			<td class="caption">Priority</td>
			<td colspan="2">
				<input type="text" size="2" name="Priority" value="##TP_RulePriority##"/>
			</td>
		</tr>
		##TP_ENDIF##
		
		<tr>
			<td class="caption">Rule Description</td>
			<td colspan="2"><textarea cols="50" rows="3" wrap="virtual" name="RuleDesc">##TP_RuleDesc##</textarea></td>
		</tr>
		
		##TP_IF {[tpGetVar CPMRuleType "R"] == "R"}##
		<tr>
			<td class="caption">Pay Method</td>
			<td>
				<select name="PayMthd">
				<script>
					write_select('##TP_RuleAllowId##'
							##TP_LOOP cpmallow_idx {[tpGetVar NumMthds]}##
								,"##TP_CPMAllowId##","##TP_CPMDesc##"
							##TP_ENDLOOP##
							)
				</script>
				</select>
			</td>
			<td>&nbsp;</td>
		</tr>
		##TP_ENDIF##
		
		
		##TP_IF {[tpGetVar CPMRuleType "R"] == "R"}##
		<tr>
			<td class="caption">Rule Type</td>
			<td>
				<select name="RuleType">
				<script>
					write_select('##TP_RuleType##'
							,'DISALLOW','DISALLOW'
							,'FORCE','FORCE'
							)
				</script>
				</select>
			</td>
			<td>&nbsp;</td>
		</tr>
		##TP_ENDIF##
		
		##TP_IF {[tpGetVar CPMRuleType "R"] == "R"}##
		<tr>
			<td class="caption">Payment Type</td>
			<td>
				<select name="PmtType">
				<script>
					write_select('##TP_PmtType##'
							,'DEP','DEP'
							,'WTD','WTD'
							,'BOTH','BOTH'
							)
				</script>
				</select>
			</td>
			<td>&nbsp;</td>
		</tr>
		##TP_ENDIF##
		
		##TP_IF {[tpGetVar CPMRuleType "R"] == "M"}##
		<input type="hidden" name="MsgPoint" value="DEP_DECL" />
		##TP_ENDIF##
		
		##TP_IF {[tpGetVar CPMRuleType "R"] == "M"}##
		<tr>
			<td class="caption" valign="top">Primary Message</td>
			<td colspan="2" >
				<table  style="{width:100px}" border="0" cellspacing="0" cellpadding="2">
					<tr>
						<td valign="top">
							<label for="Msg1">##TP_RuleMsgPrefix##</label>
							<input name="Msg1" type="text" size="15" value="##TP_RuleMsg1##">
						</td>
						
						##TP_IF {[tpGetVar editing 0]}##
						<td>
							<p style="{font-style:italic}">
							<textarea style="{font-style:italic; background-color:#C0CCCC}" cols="50" rows="3" wrap="virtual" name="EnXlation1" readonly>##TP_MsgXlation_1##</textarea>
							##TP_IF {[tpGetVar en_xlation_exists_1 0]}##


								##TP_IF {[OT_CfgGet FUNC_MENU_MULTI_LANG_MSG 1] && [op_allowed ManageMessages]}##
								<input type="button" class="btn_def" value="Edit" onClick="return fs_rule(this,'GoMsgCode',##TP_MsgCodeId_1##)">
								##TP_ENDIF##

							##TP_ELSE##
								##TP_IF {[OT_CfgGet FUNC_MENU_MULTI_LANG_MSG 1] && [op_allowed ManageMessages]}##

									##TP_IF {[tpGetVar MsgCodeExists 0]}##
									<input type="button" class="btn_def" value="Add New Translation" onClick="return fs_rule(this,'GoMsgCode',##TP_MsgCodeId_1##)">
									##TP_ELSE##
									<input type="button" class="btn_def" value="Add New Msg" onClick="return fs_rule(this,'NewMsg',1)" ##TP_IF {[tpBindGet RuleMsg1] == ""}##disabled##TP_ENDIF##>
									##TP_ENDIF##

								##TP_ENDIF##
							##TP_ENDIF##
							</p>
						</td>
						##TP_ENDIF##
						
					</tr>
				</table>
			</td>
		</tr>
		<tr>
			<td class="caption">Suggested Payment Methods</td>
			<td>
			##TP_IF {[tpGetVar NumSchemes 0] > 0}##
				<table cellspacing=0 cellpadding=0 border=0>
				##TP_LOOP scheme_idx {[expr {4*(([tpGetVar NumSchemes]+3)/4)}]}##
					##TP_IF {[tpGetVar scheme_idx]%4 == 0}##
						<tr>
					##TP_ENDIF##
					##TP_IF {[tpGetVar scheme_idx]<[tpGetVar NumSchemes]}##
						<td>
							<input type="checkbox" name="Sch_##TP_PaySchemeId##" ##TP_PaySchemeChkd## />
							<input type="text" name="DO_##TP_PaySchemeId##" size="1" value="##TP_PaySchemeDisp##"/>##TP_PaySchemeDesc##
						</td>
					##TP_ELSE##
						<td>&nbsp;</td>
					##TP_ENDIF##
					##TP_IF {([tpGetVar scheme_idx]+1)%4 == 0}##
						</tr>
					##TP_ENDIF##
				##TP_ENDLOOP##
				</table>
			##TP_ELSE##
				<font color=yellow>
				<b>No methods available</b>
				</font>
			##TP_ENDIF##
			</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td class="caption" valign="top">Secondary Message</td>
			<td colspan="2" >
				<table  style="{width:100px}" border="0" cellspacing="0" cellpadding="2">
					<tr>
						<td valign="top">
							<label for="Msg2">##TP_RuleMsgPrefix##</label>
							<input name="Msg2" type="text" size="15" value="##TP_RuleMsg2##">
						</td>
						
						##TP_IF {[tpGetVar editing 0]}##
						<td>
							<p style="{font-style:italic}">
							<textarea style="{font-style:italic; background-color:#C0CCCC}" cols="50" rows="3" wrap="virtual" name="EnXlation2" readonly>##TP_MsgXlation_2##</textarea>
							##TP_IF {[tpGetVar en_xlation_exists_2 0]}##


								##TP_IF {[OT_CfgGet FUNC_MENU_MULTI_LANG_MSG 1] && [op_allowed ManageMessages]}##
								<input type="button" class="btn_def" value="Edit" onClick="return fs_rule(this,'GoMsgCode',##TP_MsgCodeId_2##)">
								##TP_ENDIF##

							##TP_ELSE##
								##TP_IF {[OT_CfgGet FUNC_MENU_MULTI_LANG_MSG 1] && [op_allowed ManageMessages]}##

									##TP_IF {[tpGetVar MsgCodeExists 0]}##
									<input type="button" class="btn_def" value="Add New Translation" onClick="return fs_rule(this,'GoMsgCode',##TP_MsgCodeId_2##)">
									##TP_ELSE##
									<input type="button" class="btn_def" value="Add New Msg" onClick="return fs_rule(this,'NewMsg',2)" ##TP_IF {[tpBindGet RuleMsg2] == ""}##disabled##TP_ENDIF##>
									##TP_ENDIF##

								##TP_ENDIF##
							##TP_ENDIF##
							</p>
						</td>
						##TP_ENDIF##
						
					</tr>
				</table>
			</td>
		</tr>
		##TP_ENDIF##

		##TP_IF {[OT_CfgGet FUNC_CHANNELS 0]}##
		##TP_IF {[tpGetVar CPMRuleType "R"] == "R"}##
		<tr>
			<td class="caption">Channels</td>
			<td colspan="2">
				##TP_PLAY chan_sel.html##
			</td>
		</tr>
		##TP_ELSE##
		<input type="hidden" name="CN_I" value="I" />
		##TP_ENDIF##
		##TP_ENDIF##
		
		
		<tr>
			<th colspan="3" class="buttons">
			
				<table width="100%" cellpadding="0" cellspacing="0" border="0"><tr>
					<th class="buttons" width="75%">
					
						##TP_IF {[op_allowed EditCPMRules]}##
						
						##TP_IF {[tpGetVar adding 0]}##
						<input type="button" class="btn_def" value="Add"    onClick="return fs(this,'Add')">
						##TP_ENDIF##

						##TP_IF {[tpGetVar editing 0]}##
						<input type="button" class="btn_def" value="Update" onClick="return fs(this,'Update')">
						##TP_ENDIF##
						
						##TP_ENDIF##

						<input type="button" class="btn_def" value="Back"   onClick="return fs(this,'Back')">
					</th>
					
					<th width="25%" class="goaudit">
						##TP_IF {[tpGetVar editing 0]}##
						<input type="button" class="btn_def" value="View Audit History" onclick="return fs(this,'GoAudit')"> 
						##TP_ENDIF##
						<input value="CPMRule" name="AuditInfo" type="hidden">
					</th>
				</tr></table>
				
			</th>
		</tr>
	</table>
	
	<input type="hidden" name="SubmitName" value="" />
	<input type="hidden" name="action" value="ADMIN::CPM_RULES::DoCPMRule" />
	<input type="hidden" name="CPMRuleType" value="##TP_CPMRuleType##" />
	<input type="hidden" name="RuleGroup" value="" />
	<input type="hidden" name="RuleId" value="##TP_RuleId##" />
	
	<input type="hidden" name="rule_id" value="##TP_RuleId##" />
	<input type="hidden" name="code_id" value="" />
	<input type="hidden" name="lang" value="" />
	
	<input type="hidden" name="this_action" value="##TP_this_action##" />
	<input type="hidden" name="back_action" value="##TP_back_action##" />
	
	</form>
	
	
	
	
	
	
	
	
	
	
	
	
	
	##TP_IF {[tpGetVar editing 0]}##
	<form name="opForm" action="##TP_CGI_URL##" method="get">
	<table border="0" cellspacing="0" cellpadding="2">
		<tr>
			<th colspan="7" class="title">
				Payment Method Rule Components
			</th>
		</tr>
		
				
		<tr>
			<th class="colhead">Sequence</th>
			<th class="colhead">Status</th>
			<th class="colhead">&nbsp;&nbsp;Level</th>
			<th class="colhead">LHS</th>
			<th class="colhead">Operator</th>
			<th class="colhead">RHS</th>
			<th class="colhead"></th>
		</tr>
		
		
	
		##TP_IF {[tpGetVar NumOps 0]>0}##
		
		##TP_LOOP op_idx {[tpGetVar NumOps]}##
		
		<tr
		##TP_IF     {$RULE_OPS([tpGetVar op_idx],status) == "A"}##bgcolor="#9CCF9C"
		##TP_ELSEIF {$RULE_OPS([tpGetVar op_idx],status) == "S"}##bgcolor="#f3eec7"
		##TP_ELSEIF {$RULE_OPS([tpGetVar op_idx],status) == "X"}##bgcolor="#CE9A9C"
		##TP_ENDIF##
		>
			<td>##TP_OpSequence##</td>
			
			<td>
			##TP_IF     {$RULE_OPS([tpGetVar op_idx],status) == "A"}##Active
			##TP_ELSEIF {$RULE_OPS([tpGetVar op_idx],status) == "S"}##Suspended
			##TP_ELSEIF {$RULE_OPS([tpGetVar op_idx],status) == "X"}##Removed
			##TP_ENDIF##
			</td>
			
			<td>&nbsp;&nbsp;##TP_OpLevel##&nbsp;&nbsp;##TP_OpLevelText##</td>
			<td>##TP_OpLHS##</td>
			<td>##TP_OpOperator##</td>
			<td>##TP_OpRHS##</td>
			<td>&nbsp;&nbsp;<input type="button" class="btn_def" value="Edit" onClick="return fs_op(this,'Edit',##TP_OpId##);"></td>
		</tr>
		
		##TP_ENDLOOP##
		
		##TP_ELSE##
		<tr>
			<td colspan="7">
			<b>No Components are currently defined for this Rule.</b>
			</td>
		</tr>
		
		##TP_ENDIF##
		
		
		<tr>
			<th colspan="6" class="buttons">
				##TP_IF {[op_allowed EditCPMRules]}##
				<input type="button" class="btn_def" value="Add" onClick="return fs(this,'Add');">
				##TP_ENDIF##
			</th>
			<th  class="buttons">
				##TP_IF {[tpGetVar showDeleted]}##
				<input type="button" class="btn_def" value="Hide Deleted" onClick="return fs(this,'Refresh')" />
				<input type="hidden" name="showDeleted"   value="0" />
				##TP_ELSE##
				<input type="button" class="btn_def" value="Show Deleted" onClick="return fs(this,'Refresh')" />
				<input type="hidden" name="showDeleted"   value="1" />
				##TP_ENDIF##
			</th>
		</tr>
	</table>
	
	<input type="hidden" name="SubmitName" value="" />
	<input type="hidden" name="action" value="ADMIN::CPM_RULES::GoCPMOp" />
	<input type="hidden" name="CPMRuleType" value="##TP_CPMRuleType##" />
	<input type="hidden" name="RuleGroup" value="" />
	<input type="hidden" name="RuleId" value="##TP_RuleId##" />
	<input type="hidden" name="OpId" value="" />
	
	<input type="hidden" name="this_action" value="##TP_this_action##" />
	<input type="hidden" name="back_action" value="##TP_back_action##" />
	
	</form>
	##TP_ENDIF##
</body>

</html>

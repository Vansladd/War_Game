<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<!-- $Id: pmt_reg_C2P.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ -->

##TP_PLAY JS_WriteSelect.html##

<script language=JavaScript>
	var error_list = "";
	var invalid_str = "Invalid ";

	function fs(b,t)
	{
		var f = document.forms['c2pform'];
		var n_errs = 0;

		reset_error();

		n_errs += ck_mandatory(f.c2pUsername.value, "Click2Pay Username", 3, 64, 0);
		n_errs += ck_mandatory(f.c2pPAN.value, "Click2Pay PAN", 16, 16, 1);
		
		if((t == 'AddMthd') && (n_errs > 0)) {
			alert(error_list);
			return false;
		} else {	
			b.disabled = true;
			b.value = "Busy...";
			b.form.SubmitName.value=t;
			b.form.submit();
			return true;
		}
	}
	
	// check a mandatory string
	function ck_mandatory(str, desc, min_len, max_len, val_chars) 
	{
		if(str.length <= 0 || (min_len != 0 && str.length < min_len) ||
				(max_len != 0 && str.length > max_len)) {
			return add_error(invalid_str + desc + ".");
		}

		if(val_chars) {
			var re = "^[A-Za-z0-9\.\_\-]*$";
			if(!str.match(new RegExp(re))) {
				return add_error(invalid_str + desc + ".");
			}
		}
		return 0;
	}

	// add an error
	function add_error(str) 
	{
		if(error_list.length > 0) {
			error_list += "\n";
		}
		error_list += str;
		return 1;
	}

	// reset error count
	function reset_error() {
		error_list = "";
	}
</script>

</head>
<body>
##TP_PLAY error_rpt.html##
<table style="padding:3px; border:none">
<form name="c2pform" action="##TP_CGI_URL##" method="post">
	<input type="hidden" name="SubmitName" value="" />
	<input type="hidden" name="CustId"     value="##TP_CustId##" />
	<input type="hidden" name="action"     value="ADMIN::PMT::do_pay_mthd_add" />
	<input type="hidden" name="pay_mthd"   value="C2P" />
	<input type="hidden" name="Username"   value="##TP_Username##" />
	<input type="hidden" name="AcctNo"     value="##TP_AcctNo##" />
	<input type="hidden" name="SettleType" value="##TP_SettleType##" />
	<input type="hidden" name="AcctType"   value="##TP_AcctType##" />
	<input type="hidden" name="backAction" value="##TP_backAction##">
	<tr>
	   <th colspan="2" class="title">Add payment method (Click2Pay)</th>
	</tr>
	<!-- show the customers details -->
	##TP_PLAY pmt/pmt_detail_cust.html##
	<tr>
		<td colspan="2">&nbsp;</td>
	</tr>

	<!-- now card details -->
	<tr class="subtitle">
		<th colspan="2">Click2Pay Details</th>
	</tr>
	<tr>
		<td class="caption">Click2Pay Username</td>
		<td>
			<input 
				type="text" 
				name="c2pUsername" 
				size="40" 
				maxlength="64" 
				value="##TP_c2pUsername##"/>
		</td>
	</tr>
	<tr>
		<td class="caption">Click2Pay PAN</td>
		<td>
			<input
				type      = "text"
				name      = "c2pPAN"
				size      = "16"
				maxlength = "16"
				value     = "##TP_c2pPAN##"
			/>
		</td>
	</tr>

	<!-- actions -->
	<tr>
		<th colspan="2" class="buttons">
			<input type="button" class="btn_def" value="Add Payment Method" onClick="return fs(this,'AddMthd')" />
			<input type="button" class="btn_def" value="Back" onClick="return fs(this,'Back')" />
		</th>
	</tr>
</table>
</form>
</body>
</html>

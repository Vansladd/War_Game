
##TP_COMMENT $Id: pmt_qry.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $##

##TP_COMMENT $Name: RC_Training $##
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>OpenBet Administration</title>
##TP_PLAY header_cal.html##
<script>
var Title = parent.parent.document.title;

function fs(b,t)
{
	var label = b.value;

	b.disabled = true;
	b.value = "Busy...";

	//Validate search for payment methods
	##TP_IF {[OT_CfgGet VALIDATE_PMT_METHOD_SEARCHES 0]}##
	if (b.form.name == "payment_method_query" && !validate_pmt_search()) {
		b.value = label;
		b.disabled = false;
		return false;
	}

	// Validate card search
	if(b.form.name == "payment_card_query" && !validate_card_search()) {
		b.value = label;
		b.disabled = false;
		return false;	
	}
	##TP_ENDIF##

	b.form.SubmitName.value=t;
	b.form.submit();
	return true;
}

##TP_IF {[OT_CfgGet FUNC_CARD_CHANGE_ALLOWED 0]}##
function openOkToDelete() {

	var username = document.getElementById("CCChangeUsername").value;
	
	// popup colour chooser window
	var url = "##TP_CGI_URL##?action=ADMIN::CUST::GoOkToDelete&username="+username;
	var name = "oktodelete";
	var features = "width=750,height=300,resizable=yes,menubar=no,toolbar=no,status=yes";

	colour_win = window.open(url, name, features);
}
##TP_ENDIF##


/*
 * Validate payment method search to prevent a large result set.
 * Set of compulsory fields must be filled
 */
function validate_pmt_search()
{
	var compulsory_fields =
		document.forms.payment_method_query.Username.value +
		document.forms.payment_method_query.AcctNo.value +
		document.forms.payment_method_query.PmtDate1.value +
		document.forms.payment_method_query.PmtDate1.value +
		document.forms.payment_method_query.DateRange.value;

	if (compulsory_fields == "") {
		alert("The search you are attempting will return a large number of results"
			+ " which will take a long time to return results and may impact the speed of"
			+ " returning results for other users.  Please redefine your search to"
			+ " include at least one of the following fields:"
			+ "\n\n\t- Username\n\t- Account Number\n\t- Date range");
		return 0;
	} else {
		return 1;
	}
}

/*
 * Validate card search to prevent a query that returns a large number of results.
 * Card bin and Card number must contain numeric values.
 */
function validate_card_search() {

	var card_no = document.forms.payment_card_query.card_no.value;
	var card_bin = document.forms.payment_card_query.card_bin.value;
	var status = document.forms.payment_card_query.status.value;

	if (card_bin == "" && card_no == "" && status == "") {
		alert("The search you are attempting will return a large number of results which will take a long time to return results and may impact the speed of returning results for other users.  Please redefine your search to include at least one of the following fields:\n\n\t- Card No.\n\t- Card Bin\n\t- Status");
		return 0;
	} else if (is_numeric(card_no) && is_numeric(card_bin)) {
		return 1;
	} else {
		alert("You must enter numeric values for card bin and card number");
		return 0;
	}	
}

function is_numeric(value) {
	var re = new RegExp("^[0-9]*$");
	
	if (re.test(value) || value == "") {
		return 1;
	} else {
		return 0;
	}	
}

function displayCalendars() {
	new Calendar(document.forms.payment_method_query.PmtDate1,null,false,"lo")
	new Calendar(document.forms.payment_method_query.PmtDate2,null,false,"lo")
}

window.onbeforeunload = function () {

        var re = /.*Secure Area.*/;
        if (re.test(parent.parent.document.title)) {
                parent.parent.document.title = Title;
        }
}

</script>
##TP_PLAY JS_WriteSelect.html##
</head>
<body onload="displayCalendars()">
##TP_PLAY error_rpt.html##
##TP_IF {[op_allowed ViewPayMethod]}##
<table cellspacing=0 cellpadding=2 border=0>
<form name=payment_method_query method=get action=##TP_CGI_URL##>
<tr>
  <th colspan=2 class=title>
  Payment Method Query
  </th>
</tr>
<tr>
  <td class=caption>Username</td>
  <td>
  <input type="text" name="Username" value="" size=32> (exact: <input type="checkbox" name="exact" value="Y" ##TP_IF {[OT_CfgGet FUNC_DEF_CASE_INS_SEARCH 0] == 0}##checked##TP_ENDIF##>&nbsp; case insensitive: <input type="checkbox" name="ignorecase" value="Y" ##TP_IF {[OT_CfgGet FUNC_DEF_CASE_INS_SEARCH 0] == 1}##checked##TP_ENDIF##>)
  </td>
</tr>
<tr>
  <td class=caption>Acct No</td>
  <td>
  <input type="text" name="AcctNo" value="" size=10>
  </td>
</tr>
<tr>
  <td class=caption>Date Range</td>
  <td>
  <input type="text" name="PmtDate1" value="" size=12>
  &nbsp;and&nbsp;
  <input type="text" name="PmtDate2" value="" size=12>
  </td>
</tr>
<tr>
  <td class=caption>or</td>
  <td>
  <select name="DateRange">
    <option value="">n/a</option>
    <option value="TD" selected>Today</option>
    <option value="YD">Yesterday</option>
    <option value="L3">Last 3 days</option>
    <option value="L7">Last 7 days</option>
    <option value="CM">Current month</option>
  </select>
  </td>
</tr>
<tr>
  <td class=caption>Method</td>
  <td>
  <select name="pay_mthd">
  <script>
  write_select(""
    ,"","Any"
    ##TP_LOOP pm_idx {[tpGetVar NumPayMthds]}##
      ,"##TP_pay_mthd##", "##TP_pay_mthd_desc##"
    ##TP_ENDLOOP##
  )
  </script>
  </select>
  </td>
</tr>
<tr>
  <td class=caption>Deposit authorisation</td>
  <td>
  <select name="DepAuthStatus">
    <option value="">any</option>
    <option value="Y">Good</option>
    <option value="N">Bad</option>
    <option value="P">Pending</option>
    <option value="R">Referral</option>
  </select>
  </td>
</tr>
<tr>
  <td class=caption>Withdrawal authorisation</td>
  <td>
  <select name="WtdAuthStatus">
    <option value="">any</option>
    <option value="Y">Good</option>
    <option value="N">Bad</option>
    <option value="P">Pending</option>
  </select>
  </td>
</tr>

##TP_IF {[OT_CfgGet FUNC_LOG_CVV2_RESP 0]}##
<tr>
  <td class=caption>CSC Response</td>
  <td>
  <select name="cvv2_resp">
    <option value="">any</option>
    <option value="NO DATA MATCHES">NO DATA MATCHES</option>
    <option value="ADDRESS MATCH ONLY">ADDRESS MATCH ONLY</option>
    <option value="SECURITY CODE MATCH ONLY">SECURITY CODE MATCH ONLY</option>
    <option value="ALL MATCH">ALL MATCH</option>
	<option value="DATA NOT CHECKED">DATA NOT CHECKED</option>
	<option value="UNKNOWN">UNKNOWN</option>
  </select>
  </td>
</tr>
##TP_ENDIF##

<tr>
  <th class=buttons colspan=2>
  <input type=button class="btn_def" value="Find Methods" onClick="return fs(this,'DoPmtAuthQry')">
  </th>
</tr>
<input type=hidden name=SubmitName value="">
<input type=hidden name=action value=ADMIN::PMT::do_auth_qry>
</form>
</table>
<br>
##TP_ENDIF##

##TP_IF {[op_allowed ViewPayMethod] && [op_allowed PayMethodCardSrch]}##
<table cellspacing=0 cellpadding=2 border=0>
<form name="payment_card_query" method="get" action="##TP_CGI_URL##">
<tr>
  <th colspan=2 class=title>
  Card Search
  </th>
</tr>
<tr>
  <td class=caption>Card No.</td>
  <td>
    <input type="text" name="card_no" value="" size=20 onfocus="parent.parent.document.title = Title + ' - Secure Area';" onblur="parent.parent.document.title = Title;">
  </td>
</tr>
<tr>
  <td class=caption>Card Bin</td>
  <td>
    <input type="text" name="card_bin" value="" size=6>
  </td>
</tr>
<tr>
	<td class=caption>Status</td>
	<td>
	<select name="status">
		<option value="">-Any-</option>
		<option value="A">Active</option>
		<option value="S">Suspended</option>
		<option value="X">Removed</option>
	</select>
	</td>
</tr>
<tr>
  <th class=buttons colspan=2>
    <input type=button class="btn_def" value="Find Methods" onClick="return fs(this,'GoFindCard')">
  </th>
</tr>
<input type=hidden name=SubmitName value="">
<input type=hidden name=action value="ADMIN::PMT::do_card_qry">
</form>
</table>
<br>
##TP_ENDIF##

##TP_IF {[tpGetVar AllowedToAddPayMthds] > 0}##
<table cellspacing=0 cellpadding=2 border=0>
<form method="get" action="##TP_CGI_URL##">
<tr>
  <th colspan=2 class=title>
  Add New Payment Method
  </th>
</tr>
<tr>
  <td class=caption>Username</td>
  <td>
  <input type="text" name="Username" value="" size=32>
  </td>
</tr>
<tr>
  <td class=caption>Acct No</td>
  <td>
  <input type="text" name="AcctNo" value="" size=32>
  </td>
</tr>
<tr>
  <td class=caption>Email</td>
  <td>
  <input type="text" name="Email" value="" size=50>
  </td>
</tr>


<tr>
  <td class=caption>Method</td>
  <td>
    <select name="pay_mthd">
      <script>
      write_select(""
        ##TP_LOOP pm_idx {[tpGetVar NumPayMthds]}##
	   ##TP_IF {[op_allowed "Add[tpBindGet pay_mthd]"]}##
          ,"##TP_pay_mthd##", "##TP_pay_mthd_desc##"
	   ##TP_ENDIF##
        ##TP_ENDLOOP##
      )
      </script>
    </select>
  </td>
</tr>
<tr>
  <th class=buttons colspan=2>
  <input type=button class="btn_def" value="Add Method" onClick="return fs(this,'GoAddPmtMthd')">
  </th>
</tr>
<input type=hidden name=SubmitName value="">
<input type=hidden name=backAction value="PMT">
<input type=hidden name=action value="ADMIN::PMT::go_pay_mthd_add">
</form>
</table>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_PAYBOX 0] && [op_allowed ViewPayMethod] && [op_allowed PayMethodPhoneSrch]}##
<br>
<table cellspacing=0 cellpadding=2 border=0>
<form method="get" action="##TP_CGI_URL##">
<tr>
  <th colspan=2 class=title>
  Paybox Phone Number Search
  </th>
</tr>
<tr>
  <td class=caption>Phone No.</td>
  <td>
    <input type="text" name="phone_no" value="" size=20>
  </td>
</tr>

<tr>
  <th class=buttons colspan=2>
    <input type=button class="btn_def" value="Find Methods" onClick="return fs(this,'GoFindPhone')">
  </th>
</tr>
<input type=hidden name=SubmitName value="">
<input type=hidden name=action value="ADMIN::PMT::do_phone_qry">
</form>
</table>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_EARTHPORT 0] && [op_allowed ViewPayMethod] && [op_allowed PayMethodVanSrch]}##
<br />
<table cellspacing="0" cellpadding="2" border="0">
  <form method="get" action="##TP_CGI_URL##">
    <tr>
      <th colspan="2" class="title">
        Earthport Search
      </th>
    </tr>
    <tr>
      <td class="caption">VAN Number</td>
      <td>
        <input type="text" name="ep_van_no" value="" size="20" />
      </td>
    </tr>
    <tr>
	  <td class="caption">Earthport Account Number</td>
	  <td>
	    <input type="text" name="ep_acc_no" value="" size="20" />
	  </td>
    </tr>
    <tr>
	  <td class="caption">Bank Name like</td>
	  <td>
		 <input type="text" name="ep_bank_name" value="" size="20" />
		 &nbsp;&nbsp;(case insensitive:<input type="checkbox" name="is_upper_name" value="Y" checked>)
	  </td>
    </tr>
    <tr>
      <th class="buttons" colspan="2">
        <input type="button" class="btn_def" value="Find Methods" onClick="return fs(this,'GoFindEarthport')" />
      </th>
    <tr>
    </tr>
    <input type="hidden" name="SubmitName" value="" />
    <input type="hidden" name="action" value="ADMIN::PMT::do_earthport_qry" />
  </form>
</table>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_NETELLER 0] && [op_allowed ViewPayMethod]}##
<br>
<table cellspacing="0" cellpadding="2" border="0">
<form method="get" action="##TP_CGI_URL##">
<tr>
	<th colspan="2" class="title">
	Neteller ID Search
	</th>
</tr>
<tr>
	<td class="caption">Neteller ID</td>
	<td>
		<input type="text" name="neteller_id" value="" size="12" />
	</td>
</tr>

<tr>
	<th class="buttons" colspan="2">
		<input type="button" class="btn_def" value="Find Methods" onClick="return fs(this,'GoFindNeteller')" />
	</th>
</tr>
<input type="hidden" name="SubmitName" value="" />
<input type="hidden" name="action" value="ADMIN::PMT::do_neteller_qry" />
</form>
</table>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_CLICK2PAY 0] && [op_allowed ViewPayMethod]}##
<br/>
<table cellspacing="0" cellpadding="2" border="0">
<form method="get" action="##TP_CGI_URL##">
<tr>
	<th colspan="2" class="title">
	Click2Pay Search
	</th>
</tr>
<tr>
	<td class="caption">Email</td>
	<td>
		<input type="text" name="c2pUsername" value="" size="40" maxlength="64"/>
	</td>
</tr>
<tr>
	<td class=caption>PAN</td>
	<td>
		<input type="text" name="c2pPAN" value="" size="40" maxlength="64"/>
	</td>
</tr>
<tr>
	<th class="buttons" colspan="2">
		<input type="button" class="btn_def" value="Find Methods" onClick="return fs(this,'GoFindC2P')" />
	</th>
</tr>
<input type="hidden" name="SubmitName" value="" />
<input type="hidden" name="action" value="ADMIN::PMT::do_c2p_qry" />
</form>
</table>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_PAYPAL 0] && [op_allowed ViewPayMethod]}##
	<br/>
	<form method="get" action="##TP_CGI_URL##">
	<table cellspacing="0" cellpadding="2" border="0">
	<tr><th colspan="2" class="title">PayPal Search</th></tr>
	<tr>
		<td class="caption">Email</td>
		<td>
			<input id="email" type="text" name="email" value="" size="20" />
		</td>
	</tr>
	<tr>
		<td class="caption">Payer Id</td>
		<td>
			<input id="payer_id" type="text" name="payer_id" value="" size="20" />
		</td>
	</tr>
	<tr>
		<th class="buttons" colspan="2">
			<input type="button"  class="btn_def"  value="Find Methods" onclick="return fs(this,'GoFindPayPal')" />
		</th>
	</tr>
	</table>
	<input type="hidden" name="SubmitName" value="" />
	<input type="hidden" name="action" value="ADMIN::PMT::do_paypal_qry" />
	</form>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_CLICKANDBUY 0] && [op_allowed ViewPayMethod]}##
	<br/>
	<form method="get" action="##TP_CGI_URL##">
	<table cellspacing="0" cellpadding="2" border="0">
	<tr><th colspan="2" class="title">Click and Buy Search</th></tr>
	<tr>
		<td class="caption">Email</td>
		<td>
			<input id="email" type="text" name="email" value="" size="20" />
		</td>
	</tr>
	<tr>
		<td class="caption"><label for="cb_crn">CRN Number</label></td>
		<td>
		<input id="cb_crn" type="text" name="cb_crn" value="" size="20" />
		</td>
	</tr>
	<tr>
		<th class="buttons" colspan="2">
			<input type="button" class="btn_def" value="Find Methods" onclick="return fs(this,'GoFindClickAndBuy')" />
		</th>
	</tr>
	</table>
	<input type="hidden" name="SubmitName" value="" />
	<input type="hidden" name="action" value="ADMIN::PMT::do_clickandbuy_qry" />
	</form>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_MONEYBOOKERS 0] && [op_allowed ViewPayMethod]}##
	<br/>
	<form method="get" action="##TP_CGI_URL##">
	<table cellspacing="0" cellpadding="2" border="0">
	<tr><th colspan="2" class="title">MoneyBookers Search</th></tr>
	
	<tr>
		<td class="caption">Email</td>
		<td>
			<input id="email" type="text" name="email" value="" size="20" />
		</td>
	</tr>
	
	<tr>
		<td class="caption">MoneyBookers ID</td>
		<td>
			<input id="mb_id" type="text" name="mb_id" value="" size="20" />
		</td>
	</tr>
	
	<tr>
		<th class="buttons" colspan="2">
			<input type="button" class="btn_def" value="Find Methods" onclick="return fs(this,'GoFindMoneyBookers')" />
		</th>
	</tr>
	</table>
	<input type="hidden" name="SubmitName" value="" />
	<input type="hidden" name="action" value="ADMIN::PMT::do_moneybookers_qry" />
	</form>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_PSC 0] && [op_allowed ViewPayMethod]}##
	<br/>
	<form method="get" action="##TP_CGI_URL##">
	<table cellspacing="0" cellpadding="2" border="0">
	<tr><th colspan="2" class="title">Pay Safe Card Search</th></tr>
	
	<tr>
		<td class="caption">PSC Serial Number</td>
		<td>
			<input id="psc_serial" type="text" name="psc_serial" value="" size="32" /> (exact: <input type="checkbox" name="psc_serial_exact" value="Y" ##TP_IF {[OT_CfgGet FUNC_PSC_DEF_CASE_INS_SEARCH 1] == 1}##checked##TP_ENDIF##>)
		</td>
	</tr>
	
	<tr>
		<th class="buttons" colspan="2">
			<input type="button" class="btn_def" value="Find Methods" onclick="return fs(this,'GoFindPaySafeCard')" />
		</th>
	</tr>
	</table>
	<input type="hidden" name="SubmitName" value="" />
	<input type="hidden" name="action" value="ADMIN::PMT::do_paysafecard_qry" />
	</form>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_ENVOY 0] && [op_allowed ViewPayMethod]}##
	<br/>
	<form method="get" action="##TP_CGI_URL##">
	<table cellspacing="0" cellpadding="2" border="0">
	<tr><th colspan="2" class="title">Envoy Payment Method Search</th></tr>
	
	<tr>
		<td class="caption">Envoy Unique Ref:</td>
		<td>
			<input id="envoy_uniq_ref" type="text" name="envoy_uniq_ref" value="" size="32" />
		</td>
	</tr>
	
	<tr>
		<th class="buttons" colspan="2">
			<input type="button" class="btn_def" value="Find Methods" onclick="return fs(this,'GoFindEnvoyPmtMthd')" />
		</th>
	</tr>
	</table>
	<input type="hidden" name="SubmitName" value="" />
	<input type="hidden" name="action" value="ADMIN::PMT::do_envoy_pmt_mthd_qry" />
	</form>
##TP_ENDIF##


##TP_IF {[OT_CfgGet FUNC_CARD_CHANGE_ALLOWED 0]}##
<br>
<table cellspacing="0" cellpadding="2" border="0">
		<tr>
			<th colspan="2" class="title">
				Card Change Allowed ?
			</th>
		</tr>
		<tr>
			<td class=caption>
				Username
			</td>
			<td>
				<input id="CCChangeUsername" type="text" name="CCChangeUsername" value="" size=32>
			</td>
		</tr>
		<tr>
			<th class="buttons" colspan="2">
				<input type="button" class="btn_def" value="Check" onClick="javascript:openOkToDelete();" />
			</th>
		</tr>
</table>
##TP_ENDIF##

</body>
</html>

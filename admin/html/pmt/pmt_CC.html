<html>
<!-- $Id: pmt_CC.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>OpenBet Administration</title>
##TP_PLAY JS_WriteSelect.html##
<script>

var wtd_str = ##TP_IF {[tpBindGet IsKYCOverride] == 1}##'Customer is KYC Restricted. Continue with withdrawal?'##TP_ELSE##'Make withdrawal?'##TP_ENDIF##;
var Title = parent.parent.document.title;

function check_cv2_no (b) {

	##TP_IF {[tpGetVar DepWtd] == "DEP" && [OT_CfgGet DISPLAY_CV2_FOR_PMT 0]}##
	if(b.form.cvv2.value == "") {
		alert("The CV2 number field is required: please enter the number on the back of the customer card.");
		return false;
	} else {
		return true;
	}
	##TP_ELSE##
	return true;
	##TP_ENDIF##
}



function fs(b,t)
{
	if (t != 'Back') {
		if (!check_cv2_no(b)) {
			return;
		}
	}

	if (t == 'DoDep' && !confirm('Make deposit?')) {
		return
	}
	if (t == 'DoWtd' && !confirm(wtd_str)) {
		return
	}

	b.disabled = true;
	b.value = "Busy...";
    b.form.SubmitName.value=t;
    b.form.submit();
    return true;
}

window.onbeforeunload = function () {

	var re = /.*Secure Area.*/;
	if (re.test(parent.parent.document.title)) {
		parent.parent.document.title = Title;
	}
}

</script>
</head>
<body>
##TP_PLAY error_rpt.html##
<form method=post action="##TP_CGI_URL##">
<table cellspacing=0 cellpadding=2 border=0>

	<tr>
		<th colspan=2 class=title>Debit/Credit Payment (##TP_DepWtd##)</th>
	</tr>

	<!-- show the customers details -->
	##TP_PLAY pmt/pmt_detail_cust.html##

	<tr class=subtitle>
		<th colspan=2 align=left>Payment details</th>
	</tr>

	<!-- show the cheque details -->
	##TP_PLAY pmt/pmt_detail_CC.html##
	<tr>
		<td class=caption>Auth Code.</td>
		<td><input type=text name="auth_code" value="##TP_auth_code##" size=20></td>
	</tr>
	##TP_IF {[op_allowed PmtReferOverride]}##
	<tr>
		<td class=caption>Gateway Auth Code.</td>
		<td><input type=text name="gw_auth_code" value="##TP_gw_auth_code##" size=20></td>
	</tr>
	##TP_ENDIF##
	<tr>
		<td class=caption>Extra Info.</td>
		<td><input type=text name="extra_info" value="##TP_extra_info##" size=40></td>
	</tr>
	<tr>
		<td class=caption>Channel:</td>
		<td>
			<select name="source">
				<script>write_select("P"
					##TP_LOOP chan_idx {[tpGetVar NumChannels]}##
						,"##TP_ChanCode##", "##TP_ChanName##"
					##TP_ENDLOOP##
							);</script>
			</select>
		</td>
	</tr>


##TP_IF {[tpGetVar DepWtd] == "WTD"}##
	<tr class=subtitle>
		<th colspan=2 align=left>Withdrawal</th>
	</tr>
##TP_ELSEIF {[tpGetVar DepWtd] == "DEP"}##
	<tr class=subtitle>
		<th colspan=2 align=left>Deposit</th>
	</tr>
##TP_ENDIF##
	<tr>
		<td class=caption>Amount (##TP_CustCurrency##):</td>
		<td><input type="text" name="Amount" size=10 value=""></td>
	</tr>
##TP_IF {[tpGetVar DepWtd] == "DEP" && [OT_CfgGet DISPLAY_CV2_FOR_PMT 0]}##
	<tr>
		<td class=caption>CSC Number:</td>
		<td><input type="text" name="cvv2" size=10 value="" onfocus="parent.parent.document.title = Title + ' - Secure Area';" onblur="parent.parent.document.title = Title;"></td>
	</tr>
##TP_ENDIF##
##TP_IF {[tpGetVar DepWtd] == "WTD"}##
	<tr>
		<th colspan=2 class=buttons>
			<input type="button" class="btn_def" value="Make Withdrawal" onClick="return fs(this,'DoWtd')">
			<input type=button class="btn_def" value="Back" onClick="return fs(this,'Back')">
		</th>
	</tr>
##TP_ELSEIF {[tpGetVar DepWtd] == "DEP"}##
	<tr>
		<th colspan=2 class=buttons>
			<input type="button" class="btn_def" value="Make Deposit" onClick="return fs(this,'DoDep')">
			<input type=button class="btn_def" value="Back" onClick="return fs(this,'Back')">
		</th>
	</tr>
##TP_ENDIF##
	<input type="hidden" name="cpm_id" value="##TP_cpm_id##">
	<input type="hidden" name="pay_mthd" value="##TP_pay_mthd##">
	<input type="hidden" name="CustId" value="##TP_CustId##">
	<input type="hidden" name="SubmitName" value="">
	<input type="hidden" name="action" value="ADMIN::PMT::do_pay_mthd_pmt">
	<input type="hidden" name="uniqueId" value="##TP_TCL {tpBufWrite [OT_UniqueId]}##">
	<input type="hidden" name="DepWtd" value="##TP_DepWtd##">
	<input type="hidden" name="IsKYCOverride" value="##TP_IsKYCOverride##">
	</form>
</table>
</body>
</html>


<!-- $Id: empty_market_cleanup_list.html,v 1.1.1.1 2011/10/04 10:54:25 xbourgui Exp $ -->

<html>

<head>

<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>OpenBet Administration</title>

<script language="Javascript">

	function fs(b,t) {

		b.disabled = true;
		b.value = "Busy...";
		if (t=="Back") {
			b.form.action.value="ADMIN::CLEANUP::GoUnstlEvSel";
		}
		b.form.SubmitName.value=t;
		b.form.submit();
		return true;
	}

	function set_radios (radio_value)  {
		var all_inputs = document.emptymarketcleanupform.getElementsByTagName("input")
		for (i=0;i<all_inputs.length;i++) {
			if (all_inputs[i].type == "radio"){
				var current_radio = document.getElementsByName(all_inputs[i].name);
				for(var a = 0; a < current_radio.length; a++) {
					current_radio[a].checked = false;
					if(current_radio[a].value == radio_value.toString()) {
						current_radio[a].checked = true;
					}
				}
			}
		}
	}

</script>

</head>

<body>

##TP_PLAY error_rpt.html##
##TP_PLAY msg_rpt.html##

<form method="post" name="emptymarketcleanupform" action="##TP_CGI_URL##">

<input type="hidden" name="action"      value="ADMIN::CLEANUP::DoEmptyMarketCleanup">
<input type="hidden" name="SubmitName"  value="">
<input type="hidden" name="NumEEvs"     value="##TP_TCL {tpBufWrite [tpGetVar ee_rows]}##">
<input type="hidden" name="BackType"    value="0">
<input type="hidden" name="EEventArgs"  value="##TP_EEVENT_INFO##">


<table cellspacing="0" cellpadding="2" border="0">

<tr><th class="title" colspan="7">Empty Market Cleanup Selection</th></tr>

<tr>
	<th class="colhead">Event Type</th>
	<th class="colhead">Description</th>
	<th class="colhead">Market</th>
	<th class="colhead">Settle</th>
	##TP_IF {[tpGetVar AllowDDDeletion 0]}##
		<th class="colhead">Delete</th>
	##TP_ENDIF##
	<th class="colhead">No Action</th>
</tr>

##TP_IF {[tpGetVar ee_rows 0]>0}##

##TP_LOOP ee_idx {[tpGetVar ee_rows]}##
##TP_FOREACH mkt_idx {[tpBindGet Markets]}##
<tr>
	<td>##TP_EventType##</td>
	<td><a href="##TP_CGI_URL##?action=ADMIN::EVENT::GoEv&EvId=##TP_EvId##">##TP_Desc##</a></td>
	<td >##TP_MktName##</td>

	<td align="middle" width="80px"><input type="radio" name="act_##TP_TCL {tpBufWrite [tpGetVar mkt_idx]}##" value="S">Settle</td>
	##TP_IF {[tpGetVar AllowDDDeletion 0]}##
		<td align="middle" width="80px"><input type="radio" name="act_##TP_TCL {tpBufWrite [tpGetVar mkt_idx]}##" value="D">Delete</td>
	##TP_ENDIF##
	<td align="middle" width="80px"><input type="radio" name="act_##TP_TCL {tpBufWrite [tpGetVar mkt_idx]}##" value="-" checked>No Action</td>
	<input type="hidden" name="ee_ev_id_##TP_TCL {tpBufWrite [tpGetVar ee_idx]}##" value="##TP_EvId##">
	<input type="hidden" name="ee_mkt_desc_##TP_TCL {tpBufWrite [tpGetVar mkt_idx]}##" value="##TP_MktName##">
	<input type="hidden" name="ee_markets_##TP_EvId##" value="##TP_Markets##">

</tr>
##TP_ENDFOREACH##
##TP_ENDLOOP##

##TP_ELSE##
<tr>
	<td colspan="6">No markets matched the search criteria.</td>
</tr>
##TP_ENDIF##
<tr>
	<th class="buttons" colspan="2"><input type="button" onClick="return fs(this,'SettleDeleteMarkets')" value="Update Markets">
	<input type="button" onClick="return fs(this,'Back')" value="Back"></th>
	<th class="buttons" colspan="1">&nbsp;</th>
	<th class="buttons" colspan="3">Select: <a href="javascript:set_radios('S');">ALL Settle</a>
	##TP_IF {[tpGetVar AllowDDDeletion 0]}##<a href="javascript:set_radios('D');">All Delete</a>##TP_ENDIF##
	<a href="javascript:set_radios('-');">All No Action</a></th>
</tr>
</table>
</form>

</body>

</html>

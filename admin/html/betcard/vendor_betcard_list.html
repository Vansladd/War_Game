<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>OpenBet Administration</title>
##TP_PLAY JS_WriteSelect.html##

<script>

function write_suspend_link(status, sort, id, text){
	if(status=='A' && sort == 'D'){
		url = "\"##TP_CGI_URL##?action=ADMIN::BETCARD::GoSuspendBetcard&betcard_id=" +id+ "\"";
		
		document.writeln("<a href='javascript:open_puw(" +url+ ", 350,110)'>" +text+ "</a>");
	} else {
		document.writeln(text);
	}
}

// Open pop-up
function open_puw(url,sx,sy) {
	puw = null;
	puw = window.open(url, 'puw', 'status=yes,scrollbars=yes,height='+sy+',width='+sx+',screenX=20,screenY=20');
	if (puw && puw.focus) puw.focus();
	return;
}

function write_status(status){
	if (status=='A') {
		document.writeln('Active');
	} else if (status=='S') {
		document.writeln('Suspended');
	} else if (status=='R') {
		document.writeln('Redeemed');
	} else {
		document.writeln('&nbsp;');
	}
}

function write_sort(sort){
	if (sort=='D') {
		document.writeln('Deposit');
	} else if (sort=='W') {
		document.writeln('Withdrawal');
	} else {
		document.writeln('&nbsp;');
	}
}

function write_suspended_by(sus, id){
	if (sus=='A') {
		var url = "\"##TP_CGI_URL##?action=ADMIN::USERS::GoUser&UserId=" +id+ "\"";
		url = "<a href=" +url+ ">Administrator</a>"
	} else if (sus=='V') {
		var url = "\"##TP_CGI_URL##?action=ADMIN::BETCARD::GoVendor&vendor_id=" +id+ "\"";
		url = "<a href=" +url+ ">Vendor</a>"
	} else if (sus=='C') {
		var url = "\"##TP_CGI_URL##?action=ADMIN::CUST::GoCust&CustId=" +id+ "\"";
		url = "<a href=" +url+ ">Customer</a>"
	} else {
		var url ='&nbsp';
	}
	
	document.writeln(url);
}

</script>

<STYLE TYPE="text/css" MEDIA=screen>
<!--
  .sort_D { background-color:#CC9999;color:black; }
  .sort_W { background-color:#CCFF99;color:black; }
  
  .status_R { color:orange; }
  .status_A { color:green; }
  .status_S { color:red; }
-->
</STYLE>
</head>
<body>
##TP_PLAY error_rpt.html##
<table cellspacing=0 cellpadding=2 border=0>
<tr>
	<th colspan=16 class=title>
	Betcard search results
	</th>
</tr>
<tr>
	<th nowrap class=colhead>Number</th>
	<th nowrap class=colhead>Creation Date</th>
	<th nowrap class=colhead>Vendor</th>
	<th nowrap class=colhead>Amount</th>
	<th nowrap class=colhead>Customer</th>
	<th nowrap class=colhead>Status</th>
	<th nowrap class=colhead>Sort</th>
	<th nowrap class=colhead>Vendor Payment</th>
	<th nowrap class=colhead>Redeemed</th>
	<th nowrap class=colhead>Suspended Date</th>
	<th nowrap class=colhead>Suspended By</th>
</tr>
##TP_IF {[tpGetVar NumBetcards 0]==0}##
<tr>
	<td colspan=16 align=center>
	No betcards match your search criteria
	</td>
</tr>
##TP_ELSE##
##TP_LOOP betcards_idx {[tpGetVar NumBetcards]}##
<tr class="sort_##TP_betcard_sort##">
	<td><script>write_suspend_link("##TP_status##", "##TP_betcard_sort##", "##TP_betcard_id##", "##TP_betcard_no_enc##")</script></td>
	<td>##TP_cr_date##</td>
	<td><a href="##TP_CGI_URL##?action=ADMIN::BETCARD::GoVendor&vendor_id=##TP_vendor_id##">##TP_vendor_uname##</a></td>
	<td>##TP_amount##</td>
	<td><a href="##TP_CGI_URL##?action=ADMIN::CUST::GoCust&CustId=##TP_cust_id##">##TP_username##</a></td>
	<td class="status_##TP_status##"><script>write_status("##TP_status##")</script></td>
	<td><script>write_sort("##TP_betcard_sort##")</script></td>
	
	<td><a href="##TP_CGI_URL##?action=ADMIN::BETCARD::DoPayment&SubmitName=FindPayments&vendor_pmt_id=##TP_vendor_pmt_id##&vendor_id=##TP_vendor_id##">vendor payment</a></td>
	
	<td>##TP_redeemed_date##</td>
	<td>##TP_suspended_date##</td>
	<td><script>write_suspended_by("##TP_suspended_by##", "##TP_suspended_id##")</script></td>
</tr>
##TP_ENDLOOP##
##TP_ENDIF##
</table>


<br>
<br>

<table>
	<tr><td colspan=2 class=caption>Key</td></tr>
	
	<tr class="sort_W">
	<td><script>write_sort("W")</script></td>
	</tr>
	
	<tr class="sort_D">
	<td><script>write_sort("D")</script></td>
	</tr>
	
</table>
</body>
</html>

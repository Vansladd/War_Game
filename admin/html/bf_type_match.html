<html>
<!-- $Id: bf_type_match.html,v 1.1.1.1 2011/10/04 10:54:25 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>BF Type Match</title>
##TP_PLAY header_cal.html##
##TP_PLAY JS_WriteSelect.html##

<script language=JavaScript>

var all_type_names = new Array ();
var all_type_ids   = new Array ();

##TP_LOOP ob_cat_idx {[tpGetVar OBNumCat 0]}##
	##TP_LOOP ob_clas_idx {[tpGetVar OBNumClass([tpGetVar ob_cat_idx]) 0]}##
		##TP_IF {[tpBindGet OBClasId] != ""}##
			all_type_names[##TP_OBClasId##] = new Array (##TP_LOOP ob_typ_idx {$TYP([tpGetVar ob_cat_idx],[tpGetVar ob_clas_idx],types)}####TP_IF {[tpGetVar ob_typ_idx]>0}##,##TP_ENDIF##"##TP_OBTypeName##"##TP_ENDLOOP##);
			all_type_ids[##TP_OBClasId##] = new Array (##TP_LOOP ob_typ_idx {$TYP([tpGetVar ob_cat_idx],[tpGetVar ob_clas_idx],types)}####TP_IF {[tpGetVar ob_typ_idx]>0}##,##TP_ENDIF##"##TP_OBTypeId##"##TP_ENDLOOP##);
		##TP_ENDIF##	
	##TP_ENDLOOP##
##TP_ENDLOOP##

function update_types (form) {
	
	var class_list = form.OBClasId;
	var type_options = form.OBTypeId.options;

	var clId = class_list.options[class_list.selectedIndex].value;
	var clName = class_list.options[class_list.selectedIndex].text;
	
	// Delete everything
	type_options.length=0;
	
	if (clId != "0") {
		var class_type_names = all_type_names[clId];
		var class_type_ids = all_type_ids[clId];

		for (i=0;i<class_type_names.length;i++) {
			type_options[type_options.length] =
				new Option( class_type_names[i], class_type_ids[i]);
		}
		
	}
	
	form.Match.disabled=false;
	
}



var all_class_names = new Array ();
var all_class_ids   = new Array ();
##TP_LOOP ob_cat_idx {[tpGetVar OBNumCat 0]}##
	##TP_IF {[tpBindGet OBCateId]!=""}##
		all_class_names[##TP_OBCateId##] = new Array (##TP_LOOP ob_clas_idx {$CLAS([tpGetVar ob_cat_idx],classes)}## ##TP_IF {[tpGetVar ob_clas_idx]>0}## , ##TP_ENDIF## "##TP_OBClasName##" ##TP_ENDLOOP##);
		all_class_ids[##TP_OBCateId##] = new Array (##TP_LOOP ob_clas_idx {$CLAS([tpGetVar ob_cat_idx],classes)}## ##TP_IF {[tpGetVar ob_clas_idx]>0}## , ##TP_ENDIF## "##TP_OBClasId##" ##TP_ENDLOOP##);
	##TP_ENDIF##	
##TP_ENDLOOP##
function update_classes (form) {
		
	var cat_list = form.OBCatId;
	var class_options = form.OBClasId.options;
	var type_options = form.OBTypeId.options;
	var cId = cat_list.options[cat_list.selectedIndex].value;
	var cName = cat_list.options[cat_list.selectedIndex].text;
	
	// Delete everything
	class_options.length=0;

	if (cId != "0") {
		var cat_class_names = all_class_names[cId];
		var cat_class_ids = all_class_ids[cId];
		
		for (i=0;i<cat_class_names.length;i++) {
			class_options[class_options.length] =
				new Option( cat_class_names[i], cat_class_ids[i] );
		}
		
		for (j=0;j<type_options.length;j++) {
			type_options[j].value = "";
			type_options[j].text = "";
		}
		type_options.length=0;
	}	
	form.Match.disabled=false;
}

function fs(b,t)
{
	var type_bf = b.form.BFTypeId;
	if (type_bf.selectedIndex == "-1") {
		alert("Betfair Type Not Selected")
		return false
	} else {
		b.disabled = true;
		b.value = "Busy...";
		b.form.SubmitName.value=t;
		b.form.submit();
		return true;
	}
}

</script>

</head>
<body>
##TP_IF {[tpGetVar TyMatched 0]}##
	<h3><font color=green>Type Matched Successfully</font></h3>
##TP_ENDIF##

##TP_PLAY error_rpt.html##
##TP_IF {[OT_CfgGet BF_SHOW_PRICES 0]}##
<table border=0 cellspacing=0 cellpadding=3>
<form name="match" method=get ACTION="##TP_CGI_URL##">
	<tr>
		<th colspan=1 class=title>
		Betfair Type Matching
		</th>
	</tr>
	<tr>
		<td>
			<table cellspacing=0 cellpadding=2 border=0 width =25%>
				<tr>
					<td class=caption valign=center>Betfair Types</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td class=caption valign=center>Openbet Category </td>
					<td class=caption valign=center>Openbet class</td>
					<td class=caption valign=center>Openbet Types</td>							
				</tr>
				<tr>
					<td valign=center>
					<select name="BFTypeId" size="10">
						##TP_LOOP bf_type_idx {[tpGetVar BFTypNum 0]}##
							<option value="##TP_BFTypeId##">##TP_BFTypeName##</option>
						##TP_ENDLOOP##
					</select>
					</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td valign=center>
						<select name="OBCatId" size="10" onchange="update_classes (document.forms['match'])">
							##TP_LOOP ob_cat_idx {[tpGetVar OBNumCat 0]}##
								<option value="##TP_OBCateId##">##TP_OBCateName##</option>
							##TP_ENDLOOP##
						</select>
					</td>
					<td valign=center>
						<select name="OBClasId" size="10" onchange="update_types (document.forms['match'])" >
						</select>
					</td> 
					<td valign=center>
						<select name="OBTypeId" size="10">
						</select>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<th class=buttons>
			<input type=button class="btn_def" name="Match" value="Match" disabled onClick="return fs(this,'BFTypeMatch')">
		</th>
	</tr>
	<input type=hidden name=SubmitName value="">
	<input type=hidden name=action value=ADMIN::BETFAIR::DoBFTypeMatch>
</form>
</table>
##TP_ENDIF##
</body>
</html>
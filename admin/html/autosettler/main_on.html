<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
##TP_COMMENT $Id: main_on.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ ##

<html>
	<head>
		<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
		<link href="##TP_CGI_URL##?action=ADMIN::AUTO_SETTLE::AutoSettlerStyle" rel="stylesheet" type="text/css">

		<title>
			Autosettlement
		</title>

		<script language="javascript">

			function as_fs(b,t) {
				b.disabled = true;
				b.value = "Busy...";
				document.forms["autosettle_form"].task.value = t;
				document.forms["autosettle_form"].submit();
			}

			function fs() {
				document.forms["go_ev"].submit();
			}
			
			function getObj(name) {
				if (document.getElementById)
				{
					this.obj = document.getElementsByName(name).item(0);
				}
				else if (document.all)
				{
					this.obj = document.all[name];
				}
				else if (document.layers)
				{
					this.obj = getObjNN4(document,name);
				}
			}
			
			function setParam(sname,svalue) {
				var x = new getObj(sname);
				if (!x.obj) {
					var oInput = document.createElement("INPUT");
					oInput.name = sname;
					oInput.type = "HIDDEN";
					oInput.id = sname;
					oInput.value = svalue;
					var oForm = new getObj("go_ev");
					oForm.obj.appendChild(oInput);
				} else {
					x.obj.value = svalue;
				}
			}

		</script>

	</head>

	<body class="body_simple">

	<!-- controll form -->
	<form id="go_ev" name="go_ev" method="get" action="##TP_CGI_URL##">
	</form>

	<!-- controll form -->
	<form id="autosettle_form" name="autosettle_form" method="post" action="##TP_CGI_URL##?action=ADMIN::AUTO_SETTLE::DoAutoSettlerAction">
		<input type="hidden" name="task" value="" />
	</form>

	##TP_IF {[op_allowed ViewAutoSettler]}##
		<table cellspacing="10" cellpadding="0" width="850px">
			<tr>
				<th class="title">Auto Settler Control Centre: Settlement Queue</th>
			</tr>

			<tr>
				##TP_IF {[tpBindGet AS_STATUS] == "SUSPENDED"}##
				<th class=title width=850px>Status: <font color="orange">##TP_AS_STATUS##</font>&nbsp;
					##TP_IF {[op_allowed ActivateAutoSettler]}##
					<input type="button" Value="Activate" class="btn_def" onClick="javascript:as_fs(this,'activate');"/>
					##TP_ENDIF##
				</th>
				##TP_ELSE##
				<th class=title width=850px>Status: <font color="green">##TP_AS_STATUS##</font>&nbsp;
					##TP_IF {[op_allowed ActivateAutoSettler]}##
					<input type="button" Value="Suspend" class="btn_def" onClick="javascript:as_fs(this,'suspend');"/>
					<input type="button" Value="Reset" class="btn_def" onClick="javascript:as_fs(this,'reset');"/>
					##TP_ENDIF##
				</th>
				##TP_ENDIF##
			</tr>

			<tr>
				<td style="padding:0;margin:0">
					##TP_IF {[tpBindGet AS_STATUS] == "SUSPENDED"}##
						Please activate Auto Settler to see current queue
					##TP_ELSE##
						
					<iframe marginwidth="0"
						src="##TP_AUTOSETTLER_URL##?action=go_queues"
						marginheight="0"
						width="850"
						height="550"
						hspace="0"
						vspace="0"
						frameborder="0">
							Queue Data
					</iframe>
					##TP_ENDIF##
				</td>
			</tr>
		</table>
	##TP_ENDIF##
	</body>

</html>

<html>
<!-- $Id: commentary.html,v 1.1.1.1 2011/10/04 10:54:25 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>Add/Modify Commentary</title>
##TP_PLAY JS_WriteSelect.html##
<script language="Javascript">

function blurb_popup (id, sort) {
	if (id == "") {
		alert("No Id specified, does the "+sort+" exist.\n"+
			"You must create it before you can add a blurb");
		return;
	}

	window.open("##TP_CGI_URL##?action=ADMIN::BLURB::do_blurb&ref_id="+id+"&sort="+sort,
		"Blurb",
		"toolbar=no,location=no,directories=no,menubar=no,resizable=yes,width=600,height=200");
}

function validate(f,t)
{
	var b = document.forms[0];
	var scoreRegex = /[0-9]+-[0-9]+|^$/;
	if (!f.form.CommentCol1.value.match(scoreRegex) ||
		!f.form.CommentCol2.value.match(scoreRegex)) {

		alert ("Check Your Score values.  format is '1-0'");
		return false;
	}
	fs(f,t);
}

function fs(b,t)
{
	b.disabled = true;
	b.value = "Busy...";
	b.form.SubmitName.value=t;
	b.form.submit();
	return true;
}
</script>
</head>
<body>
##TP_PLAY error_rpt.html##
<table border=0 cellspacing=0 cellpadding=3>
<tr>
	<th colspan=3 class=title>
	Comment Details
	</th>
</tr>
<form ACTION="##TP_CGI_URL##" method=get>
<input type="hidden" name="event" value="##TP_EvId##">
<input type="hidden" name="type"  value="##TP_EvTypeId##">
<input type="hidden" name="class" value="##TP_EvClassId##">
<tr>
	<td class=caption>Class / Type / Event</td>
	<td>
		<a href="##TP_CGI_URL##?action=ADMIN::CLASS::GoClass&ClassId=##TP_EvClassId##">##TP_EvClass##</a>
		&nbsp;/&nbsp;
		<a href="##TP_CGI_URL##?action=ADMIN::TYPE::GoType&ClassId=##TP_EvClassId##&TypeId=##TP_EvTypeId##">##TP_EvType##</a>
		&nbsp;/&nbsp;
		<a href="##TP_CGI_URL##?action=ADMIN::EVENT::GoEv&EvId=##TP_EvId##">##TP_Ev##</a>
	</td>
</tr>
<tr>
	<td class=caption>Comment Type</td>
	<td>
		<select name="CommentType">
			##TP_LOOP type_idx {[tpGetVar NumTypes]}##
			<option value="##TP_TypeName##" ##TP_TypeSel##>##TP_TypeDesc##</option>
			##TP_ENDLOOP##
		</select>
	</td>
</tr>
<tr>
	<td class=caption>Type 1 Score</td>
	<td>
		<input type="text" id="CommentCol1" name="CommentCol1" value="##TP_CommentCol1##" size=10>
	</td>
</tr>
<tr>
	<td class=caption>Type 2 Score</td>
	<td>
		<input type="text" id="CommentCol2" name="CommentCol2" value="##TP_CommentCol2##" size=10>
	</td>
</tr>
<tr>
	<td class=caption>Free Text</td>
	<td>
		<input type="text" name="CommentCol3" value="##TP_CommentCol3##" size=40><i>(40 char)</i><br/>
		<a href='javascript:blurb_popup("##TP_CommentId##", "COMMENT")'>edit multi-lingual text</a><br/>
		<span class="multiLingualMsg">(multi-lingual text will take precedence over the default text)</span>
	</td>
</tr>
<tr>
	<td class=caption>Image URL</td>
	<td><input type="text" name="CommentImage" value="##TP_CommentImage##" size=40></td>
</tr>
<tr>
	<td class=caption>Disporder</td>
	<td><input type="text" name="Disporder" value="##TP_Disporder##" size=5></td>
</tr>

<tr>
	<th colspan=2 class=buttons>
	##TP_IF {[op_allowed ManageComments]}##
		<input type=hidden name="EvId" value="##TP_EvId##">
		<input type=hidden name="ShowEvId" value="##TP_ShowEvId##">
		<input type=hidden name="CommentId" value="##TP_CommentId##">
		##TP_IF {[tpGetVar opAdd 0]}##
			<input type=button value="Add Commentary" onClick="validate(this,'CommentAdd');">
		##TP_ELSE##
			<input type=button value="Modify Commentary" onClick="validate(this,'CommentMod');">
			<input type=button value="Delete Commentary" onClick="fs(this,'CommentDel');">
			<input type=button value="View Audit History" onClick="return fs(this,'GoAudit')">
			<input type=hidden name=AuditInfo value="BIRComment">
		##TP_ENDIF##
	##TP_ENDIF##
	<input type=button value="Back" onClick="javascript:history.go(-1)">
	</th>
</tr>

<input type=hidden name=SubmitName value="">
<input type=hidden name=action value="ADMIN::COMM::DoCommentary">
</form>
</table>
</body>
</html>

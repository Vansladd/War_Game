<html>
<!-- $Id: qas_standalone.html,v 1.1.1.1 2011/10/04 10:54:25 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>Address Information</title>
##TP_PLAY JS_WriteSelect.html##
<script src="##TP_CGI_URL##?action=qasearch_js"></script>
<script language="javascript" src="##TP_OFFICE_STATIC_URL##/js/xmlhttp.js"  type="text/javascript"></script>
<script language="javascript">

function qas_init () {
	// Quick Address Search
	document.QAS = new QASearch(document.getElementById('tb_reg'),document.getElementById('addrSelect'));
	document.cgi_url = '##TP_CGI_URL##';
	// Override function
	document.QAS.after_lookup_tasks = after_lookup_tasks;
}

function after_lookup_tasks () {

	if (document.QAS.qas_return_type == document.QAS.qas_return_types.MULTIPLE) {
		document.getElementById('addressSelect').style.display  = '';
		document.getElementById('useAddressButton').style.display  = '';
		document.getElementById('addrSelect').disabled = false;
		document.getElementById('useAddrButton').disabled = false;
	} else if (document.QAS.qas_return_type == document.QAS.qas_return_types.SINGLE) {
		document.getElementById('addressSelect').style.display  = 'none';
		document.getElementById('useAddressButton').style.display  = 'none';
		document.getElementById('addrSelect').disabled = true;
		document.getElementById('useAddrButton').disabled = true;

		toggle_input_text('addr_street_1');
		toggle_input_text('addr_street_2');
		toggle_input_text('addr_street_3');
		toggle_input_text('addr_street_4');
		toggle_input_text('addr_city');
		toggle_input_text('addr_postcode');

		document.getElementById('chng_addr_link').style.display = '';
	} 
}

function toggle_input_text (id, type) {
	if (document.getElementById('text_' + id).style.display == 'none') {
		document.getElementById('text_' + id).innerHTML = document.getElementById('input_' + id).value;
		document.getElementById('input_' + id).style.display = 'none';
		document.getElementById('text_' + id).style.display = '';
	} else {
		document.getElementById('text_' + id).style.display = 'none';
		document.getElementById('input_' + id).style.display = '';
	}
}

function change_address () {
	toggle_input_text('addr_street_1');
	toggle_input_text('addr_street_2');
	toggle_input_text('addr_street_3');
	toggle_input_text('addr_street_4');
	toggle_input_text('addr_city');
	toggle_input_text('addr_postcode');

	document.getElementById('chng_addr_link').style.display = 'none';
}

</script>

</head>
<body onload="qas_init();">
##TP_PLAY error_rpt.html##
##TP_ERROR##

<table border="0" cellspacing="0" cellpadding="2">
	<form id="tb_reg" name="tb_reg" action="##TP_CGI_URL##" method="POST">
	<tr>
		<th colspan="2" class="title">Address Lookup</th>
	</tr>
    <tr>
		<td class="caption">House Number</td>
		<td>
			<input type="text" id="input_addr_street_1" name="addr_street_1" value="##TP_addr_street_1##" size="40">
			<span style="display:none" id="text_addr_street_1"></span>
		</td>
	</tr>
	<tr>
		<td class="caption">Address 2</td>
		<td>
			<input type="text" id="input_addr_street_2" name="addr_street_2" value="##TP_addr_street_2##" size="40">
			<span style="display:none" id="text_addr_street_2"></span>
		</td>
	</tr>
	<tr>
		<td class="caption">Address 3</td>
		<td>
			<input type="text" id="input_addr_street_3" name="addr_street_3" value="##TP_addr_street_3##" size="40">
			<span style="display:none" id="text_addr_street_3"></span>
		</td>
	</tr>
	<tr>
		<td class="caption">Address 4</td>
		<td>
			<input type="text" id="input_addr_street_4" name="addr_street_4" value="##TP_addr_street_4##" size="40">
			<span style="display:none" id="text_addr_street_4"></span>
		</td>
	</tr>
	<tr>
		<td class="caption">City/Town</td>
		<td>
			<input type="text" id="input_addr_city" name="addr_city" value="##TP_addr_city##" size="25">
			<span style="display:none" id="text_addr_city"></span>
		</td>
	</tr>
	<tr>
		<td class="caption">Postcode</td>
		<td>
			<input type="text" id="input_addr_postcode" name="addr_postcode" value="##TP_addr_postcode##" size="25">
			<span style="display:none" id="text_addr_postcode"></span>
		</td>
	</tr>
	<tr id="addressSelect" style="display:none">
		<td class="caption">Select an address</td>
		<td>
			<select id="addrSelect" name="address" multiple="multiple" disabled="true"></select>
		</td>
	</tr>
	<tr id="useAddressButton" style="display:none">
		<td class="caption"></td>
		<td>
			<input id="useAddrButton" class="btn" type="button" value="Use this address" onclick="return document.QAS.lookup_refine();" disabled="true"/>
		</td>
	</tr>

	<tr>
		<th colspan="2" class="buttons">
			<table border=0 cellspacing=0 cellpadding=0 width=100%>
				<tr>
					<th class=buttons>
						<input type="button" style="width: 188px" id="find_address_button" onclick="return document.QAS.lookup_address();" class="btn" value="Find address" />
						<a id="chng_addr_link" style="display:none" onclick="return change_address();">Change address</a>
					</th>
				</tr>
			</table>
		</th>
	</tr>

	</form>
</table>
</body>
</html>

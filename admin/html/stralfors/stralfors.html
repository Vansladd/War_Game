<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>OpenBet Administration</title>
##TP_PLAY JS_WriteSelect.html##
<script language=JavaScript>

function fs(b,t) {
	b.form.SubmitName.value=t;
	b.form.submit();
	return true;
}

function getObj(obj) {
	var objRef;
	
	if(document.all) {
	objRef = eval("document.all." + obj);
	}
	if(document.getElementById) {
	objRef = document.getElementById(obj);
	}
	
	return objRef;
}

function includeAllCusts(b,t) {

	if (t == "extract") {
		##TP_LOOP stral_extract_idx {[tpGetVar NumExtract]}##
		this.document.getElementById('chk_##TP_CustId##').checked = true;
		##TP_ENDLOOP##
	} else if (t == "exception") {
		##TP_LOOP stral_exception_idx {[tpGetVar NumException]}##
		this.document.getElementById('chk_##TP_ExcCustId##').checked = true;
		##TP_ENDLOOP##
	}
}

function includeNoneCusts(b,t) {

	if (t == "extract") {
		##TP_LOOP stral_extract_idx {[tpGetVar NumExtract]}##
		this.document.getElementById('chk_##TP_CustId##').checked = false;
		##TP_ENDLOOP##
	} else if (t == "exception") {
		##TP_LOOP stral_exception_idx {[tpGetVar NumException]}##
		this.document.getElementById('chk_##TP_ExcCustId##').checked = false;
		##TP_ENDLOOP##
	}
}

function showConfirm(b,t)
{
	var r = confirm("Are you sure you want to extract the selected customers?");
	
	if (r == true) {
		return fs(b,t);
	} else {
		return true;
	}
}
</script>
</head>
<body>
##TP_PLAY error_rpt.html##
<table cellspacing=0 cellpadding=2 border=0>
<form action="##TP_CGI_URL##" method=get>
<tr>
	<th colspan=9 class=title>
	Stralfors Extraction List
	</th>
</tr>
<tr>
	<th nowrap class=colhead>Acct No</th>
	<th nowrap class=colhead>First Name</th>
	<th nowrap class=colhead>Last Name</th>
	<th nowrap class=colhead>Address</th>
	<th nowrap class=colhead>City</th>
	<th nowrap class=colhead>County</th>
	<th nowrap class=colhead>Postcode</th>
	<th nowrap class=colhead>Stralfors Code</th>
	<th nowrap class=colhead>Include?</th>
</tr>

##TP_LOOP stral_extract_idx {[tpGetVar NumExtract]}##
	<tr>
	<td nowrap><a href="##TP_CGI_URL##?action=ADMIN::CUST::GoCust&CustId=##TP_CustId##&FromStralfors=1">##TP_AcctNo##</a></td>
	<td nowrap>##TP_FName##</td>
	<td nowrap>##TP_LName##</td>
	<td nowrap>##TP_Addr##</td>
	<td nowrap>##TP_City##</td>
	<td nowrap>##TP_County##</td>
	<td nowrap>##TP_Postcode##</td>
	<td nowrap>##TP_StralCode##</td>
	<td><input type=checkbox name="included_cust" id="chk_##TP_CustId##" value="##TP_CustId##" ##TP_Include##></td>
	</tr>
##TP_ENDLOOP##
	<th colspan=9 class=buttons>
	<input type=button value="Export CSV File" onClick="return showConfirm(this,'ExportExtractionListCSV')">
	<input type=button value="Include All" onClick="includeAllCusts(this,'extract')">
	<input type=button value="Include None" onClick="includeNoneCusts(this,'extract')">
	<input type=button value="Sort" onClick="return fs(this,'SortByIncluded')">
	<input type=button value="Update Status" onClick="return fs(this,'UpdateIncludeStatus')">
	<input type=hidden name=SubmitName value="">
	<input type=hidden name=action value=ADMIN::STRALFORS::DoStralfors>
	</th>
</form>
</table>

<table cellspacing=0 cellpadding=2 border=0>
<form action="##TP_CGI_URL##" method=get>
<tr>
	<th colspan=9 class=title>
	Exception List
	</th>
</tr>
<tr>
	<th nowrap class=colhead>Acct No</th>
	<th nowrap class=colhead>First Name</th>
	<th nowrap class=colhead>Last Name</th>
	<th nowrap class=colhead>Address</th>
	<th nowrap class=colhead>City</th>
	<th nowrap class=colhead>County</th>
	<th nowrap class=colhead>Postcode</th>
	<th nowrap class=colhead>Stralfors Code</th>
	<th nowrap class=colhead>Include?</th>
</tr>

##TP_LOOP stral_exception_idx {[tpGetVar NumException]}##
	<tr>
	<td nowrap><a href="##TP_CGI_URL##?action=ADMIN::CUST::GoCust&CustId=##TP_ExcCustId##&FromStralfors=1">##TP_ExcAcctNo##</a></td>
	<td nowrap>##TP_ExcFName##</td>
	<td nowrap>##TP_ExcLName##</td>
	<td nowrap>##TP_ExcAddr##</td>
	<td nowrap>##TP_ExcCity##</td>
	<td nowrap>##TP_ExcCounty##</td>
	<td nowrap>##TP_ExcPostcode##</td>
	<td nowrap>##TP_ExcStralCode##</td>
	<td><input type=checkbox name="exc_included_cust" id="chk_##TP_ExcCustId##" value="##TP_ExcCustId##" ##TP_ExcInclude##></td>
	</tr>
##TP_ENDLOOP##
	<th colspan=9 class=buttons>
	<input type=button value="Export CSV File" onClick="return showConfirm(this, 'ExportExceptionListCSV')">
	<input type=button value="Include All" onClick="includeAllCusts(this,'exception')">
	<input type=button value="Include None" onClick="includeNoneCusts(this,'exception')">
	<input type=button value="Sort" onClick="return fs(this,'ExcSortByIncluded')">
	<input type=button value="Update Status" onClick="return fs(this,'UpdateExcIncludeStatus')">
	<input type=hidden name=SubmitName value="">
	<input type=hidden name=action value=ADMIN::STRALFORS::DoStralfors>
	</th>
</form>
</table>
</body>
</html>

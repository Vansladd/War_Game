<html>
<!-- $Id: tb_reg.html,v 1.1.1.1 2011/10/04 10:54:26 xbourgui Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>Customer Registration Information</title>
##TP_PLAY JS_WriteSelect.html##
##TP_IF { [OT_CfgGetTrue FUNC_REG_QAS_LOOKUP] }##
	<script src="##TP_CGI_URL##?action=qasearch_js"></script>
##TP_ENDIF##
<script language="javascript" src="##TP_OFFICE_STATIC_URL##/js/xmlhttp.js"  type="text/javascript"></script>
<script language=JavaScript>
	isIe4=true;
	if (navigator.appName=="Netscape") {
	   isIe4=false;
   }


var errorList = "";
function fs(b,t) {
	##TP_IF {[tpGetVar acct_type] == "DBT" || [tpGetVar acct_type] == "DEP"}##
		if (t == 'DoRegister') {
			document.getElementById('deposit_limit').value = document.getElementById('max_deposit').value;
		}
	##TP_ENDIF##

	##TP_IF {[OT_CfgGet DISABLE_7DIGITS_USERNAMES 0] && [OT_CfgGet ALLOW_SPECIFIED_USERNAME 1]}##
		if (document.tb_reg.username.value.match(/^\d{7}$/)) {
		alert ("You cannot use a 7 digit username by config");
		return false;
		}
	##TP_ENDIF##

	##TP_IF {[OT_CfgGet FUNC_HYBRID_HEDGING 0]  && [tpBindGet acct_owner] == "F" && [op_allowed "RepCodeMod"]}##
		// Enable the rep_code so that we don't lose it in case of an error
		if (t == 'UpdCustReg') {
			document.getElementById('rep_code').disabled = false;
		}
	##TP_ENDIF##

	b.form.SubmitName.value=t;
	b.form.submit();
	return true;
}

function master_changed() {
##TP_IF {[OT_CfgGetTrue FUNC_EXT_ID] && [op_allowed ExtIdFunc] && [op_allowed ExtIdMastFunc] && [op_allowed ExtIdPermFunc]}##
##TP_LOOP ext_group_idx {[tpGetVar NumExtGroups 0]}##
	if (document.forms[0].ext_master_##TP_TCL {tpBufWrite [tpGetVar ext_group_idx]}##.checked) {
		document.forms[0].ext_permanent_##TP_TCL {tpBufWrite [tpGetVar ext_group_idx]}##.disabled = false;
	} else {
		document.forms[0].ext_permanent_##TP_TCL {tpBufWrite [tpGetVar ext_group_idx]}##.disabled = true;
		document.forms[0].ext_permanent_##TP_TCL {tpBufWrite [tpGetVar ext_group_idx]}##.checked = false;
	}
##TP_ENDLOOP##
##TP_ENDIF##
}

var ha=Array();
var haDesc=Array();
var haId=Array();


ha[0]="";
haDesc[0]="";
haId[0]="";
##TP_LOOP hear_about_idx {[tpGetVar NumHearAbout]}##
ha[##TP_TCL {tpGetVar hear_about_idx}##]="##TP_hear_about##";
haDesc[##TP_TCL {tpGetVar hear_about_idx}##]="##TP_hear_about_desc##";
haId[##TP_TCL {tpGetVar hear_about_idx}##]="##TP_hear_about_type_id##";
##TP_ENDLOOP##
haTypeSel="##TP_hear_about_sel##";

function build_ha_list(id) {
	var i;
	// empty out select box
	var length=document.tb_reg.hear_about_txt.options.length;
	for (i=0; i<length; i++) {
		if (isIe4) {
			document.tb_reg.hear_about_txt.options.remove(0);
		} else {
			document.tb_reg.hear_about_txt.options[0]=null;
		}
	}
	// rebuild select box
	var tmp;
	var count=0;
	for (i=0; i<ha.length; i++) {
		if (haId[i] == id) {
			if (isIe4) {
				var tmp=document.createElement("OPTION");
				tmp.text=haDesc[i];
				tmp.value=ha[i];
				document.tb_reg.hear_about_txt.options.add(tmp);
			} else
				document.tb_reg.hear_about_txt.options[count++]=new Option(haDesc[i],ha[i],false,false);
		}
	}
	document.tb_reg.hear_about_txt.selectedIndex=0;
}

        var States = new Array();
        ##TP_LOOP country_idx {[tpGetVar NumCountrys]}##
                States['##TP_CountryCode##'] = new Array();
        ##TP_ENDLOOP##

        ##TP_LOOP state_idx {[tpGetVar NumStates]}##
                States['##TP_StateCC##']['##TP_StateCode##'] = '##TP_State##';
        ##TP_ENDLOOP##

function manage_countries() {
	var sel = document.forms['tb_reg'].elements['country_code'].selectedIndex;
	var country_code = document.forms['tb_reg'].elements['country_code'].options[sel].value;

	##TP_IF {[OT_CfgGet FUNC_REG_QAS_LOOKUP 0]}##
	if (country_code == 'UK') {
		document.getElementById('find_address').style.display = '';
	} else {
		document.getElementById('find_address').style.display = 'none';
	}
	##TP_ENDIF##

	var state_drop_down = document.forms['tb_reg'].elements['addr_state_id'];

	var stateChildren = state_drop_down.childNodes;
	var numChildren = stateChildren.length;

	for (var i = 0; i < numChildren; i++) {
		//remove all the current options
		state_drop_down.removeChild(stateChildren[0]);
	}

	for (state in States[country_code]){
		var o = document.createElement("option");
		o.value = state;
		if('##TP_DefaultState##' == state){
			o.selected = true;
		}
		o.appendChild(document.createTextNode(States[country_code][state]));
		state_drop_down.appendChild(o);
	}

	//populate the states drop down with the states for the specified country_code

	if (state_drop_down.childNodes.length == 0) {
		document.getElementById('state').style.display = 'none';
	} else {
		document.getElementById('state').style.display = '';
	}
}

function currency_changed (dep_limit) {

	var ccy_code = document.getElementById('ccy_code').value;
	var text = '<select name="max_deposit" id="max_deposit"><option value="-1">Choose Limit</option>';

	##TP_LOOP dep_lim_idx 0 {[tpGetVar num_currencies 0]}##

		if (ccy_code == '##TP_dep_limit_ccy_code##') {
			##TP_LOOP dep_lim_val_idx 0 {[tpBindGet dep_limit_num_limits]}##
			if (dep_limit && dep_limit == '##TP_dep_limit_amount##') {
				text = text + '<option value="##TP_dep_limit_amount##" selected="selected">##TP_dep_limit_amount##</option>';
			} else {
				text = text + '<option value="##TP_dep_limit_amount##">##TP_dep_limit_amount##</option>';
			}
			##TP_ENDLOOP##
		}

	##TP_ENDLOOP##

	text = text + '<option value="NO_LIMIT">No Limit</option>';

	document.getElementById('max_deposit_span').innerHTML = text + '</select>';

}

        /* Hack to not have a mess body onload property */
        function do_onload () {
                master_changed();
                manage_countries();

		##TP_IF {[OT_CfgGetTrue FUNC_REG_QAS_LOOKUP]}##
			qas_init();
		##TP_ENDIF##

		##TP_IF {[tpGetVar NewUser] && ([tpGetVar acct_type] == "DBT" || [tpGetVar acct_type] == "DEP")}## currency_changed('##TP_deposit_limit##');##TP_ENDIF##
        }


##TP_IF {[OT_CfgGetTrue FUNC_REG_QAS_LOOKUP]}##
// Quick Address Search

function qas_init () {
	// Quick Address Search
	document.QAS = new QASearch(document.getElementById('tb_reg'),document.getElementById('addrSelect'));
	document.cgi_url = '##TP_CGI_URL##';
	// Override function
	document.QAS.after_lookup_tasks = after_lookup_tasks;
}

function after_lookup_tasks () {

	if (document.QAS.qas_return_type == document.QAS.qas_return_types.MULTIPLE) {
		document.getElementById('addressSelect').style.display  = '';
		document.getElementById('useAddressButton').style.display  = '';
		document.getElementById('addrSelect').disabled = false;
		document.getElementById('useAddrButton').disabled = false;
	} else if (document.QAS.qas_return_type == document.QAS.qas_return_types.SINGLE) {
		document.getElementById('addressSelect').style.display  = 'none';
		document.getElementById('useAddressButton').style.display  = 'none';
		document.getElementById('addrSelect').disabled = true;
		document.getElementById('useAddrButton').disabled = true;
	} 
}
##TP_ENDIF##


</script>
</head>
<body onload="do_onload();">
##TP_PLAY error_rpt.html##
##TP_ERROR##

<table border=0 cellspacing=0 cellpadding=2>
	<form id="tb_reg" name="tb_reg" action="##TP_CGI_URL##" method="POST">
	<input type=hidden name=SubmitName value="">
	<input type=hidden name=action value="ADMIN::TB_CUST::DoRegister">
	<input type=hidden name=over18 value="Y">
	<input type=hidden name=read_rules value="Y">
	<input type=hidden name=stmt_status value="A">
	<input type=hidden name=cust_id value="##TP_CustId##">
	<input type=hidden name=CustId value="##TP_CustId##">
	<input type=hidden name=NewUser value="##TP_NewUser##">
	<input type=hidden name=deposit_limit id=deposit_limit value="">
	<input type=hidden name=deposit_limit_freq value="day">
	<tr>
		<th colspan=2 class=title>Account Details</th>
	</tr>

	##TP_IF {([OT_CfgGet ALLOW_BET_HEDGING 0] == 1 && [op_allowed CreateHedgingAcc]) || ([OT_CfgGet ALLOW_BET_FIELDING 0] == 1 && [op_allowed CreateFieldingAcc])}##
		<tr class="subtitle">
			<th colspan="2" align="left"><font color="white">Account Owner</font></th>
		</tr>
		##TP_IF {[tpGetVar NewUser]}##
		<tr>
			<td class="caption">Account Owner</td>
			<td>
				<select name="acct_owner" onchange="return fs(this,'ChangeAcctOwner');">
				##TP_IF {[OT_CfgGet FUNC_HYBRID_HEDGING 0]}##
			        ##TP_IF {[op_allowed CreateHedgingAcc] && ![op_allowed CreateFieldingAcc]}##
					<script>
					write_select("##TP_acct_owner##", "C", "Customer", "G", "Hedging")
					</script>
			        ##TP_ENDIF##
			        ##TP_IF {![op_allowed CreateHedgingAcc] && [op_allowed CreateFieldingAcc]}##
					<script>
					write_select("##TP_acct_owner##", "C", "Customer", "F", "Fielding")
					</script>
			        ##TP_ENDIF##
			        ##TP_IF {[op_allowed CreateHedgingAcc] && [op_allowed CreateFieldingAcc]}##
					<script>
					write_select("##TP_acct_owner##", "C", "Customer", "G", "Hedging", "F", "Fielding")
					</script>
			        ##TP_ENDIF##
				##TP_ELSE##
			        ##TP_IF {[op_allowed CreateHedgingAcc] && ![op_allowed CreateFieldingAcc]}##
					<script>
					write_select("##TP_acct_owner##", "C", "Customer", "Y", "Hedging")
					</script>
			        ##TP_ENDIF##
			        ##TP_IF {![op_allowed CreateHedgingAcc] && [op_allowed CreateFieldingAcc]}##
					<script>
					write_select("##TP_acct_owner##", "C", "Customer", "F", "Fielding")
					</script>
			        ##TP_ENDIF##
			        ##TP_IF {[op_allowed CreateHedgingAcc] && [op_allowed CreateFieldingAcc]}##
					<script>
					write_select("##TP_acct_owner##", "C", "Customer", "Y", "Hedging", "F", "Fielding")
					</script>
			        ##TP_ENDIF##
				##TP_ENDIF##
				</select>
			</td>
		</tr>
		##TP_ELSE##
		<tr>
			<td class="caption">Account Owner</td>
			<td>
			<input type="hidden" name="acct_owner" value="##TP_acct_owner##">
			<script>
				write_which("##TP_acct_owner##", "C", "Customer", "Y", "Hedging", "Z", "Hedging", "F", "Fielding", "G", "Hedging");
			</script>
			</td>
		</tr>
		##TP_ENDIF##
	##TP_ELSE##
		<input type="hidden" name="acct_owner" value="##TP_acct_owner##">
	##TP_ENDIF##

	##TP_IF {[OT_CfgGet FUNC_HYBRID_HEDGING 0]  && [tpBindGet acct_owner] == "F" && [op_allowed "RepCodeMod"]}##
		<tr>
			<td class="caption">Rep Code</td>
			<td>
				<input type="text" name="rep_code" id="rep_code" value="##TP_rep_code##" ##TP_rep_code_disabled##/>
				<input type="checkbox" name="rep_code_disable" ##TP_rep_code_chk## onchange="document.getElementById('rep_code').disabled = !document.getElementById('rep_code').disabled;"/>Disabled
			</td>
		</tr>
	##TP_ENDIF##

	##TP_IF {[tpBindGet acct_owner] == "C" && [OT_CfgGetTrue FUNC_SHOP_ACCOUNTS]}##
	<tr class=subtitle>
		<th colspan=2 align=left><font color=white>Shop Details</font></th>
	</tr>
	<tr>
		<td class="caption">Shop Number</td>
		<td>
			##TP_PLAY auto_complete_shop.html##
		</td>
	</tr>
	<tr>
		<td class="caption">Staff Member</td>
		<td><input type="text" name="StaffMember" value="##TP_StaffMember##" size="6" maxlength="6"/></td>
	</tr>
	##TP_ENDIF##

	##TP_IF {[OT_CfgGetTrue FUNC_SHOP_FIELDING_ACCOUNTS] && [op_allowed ShopFieldingAccounts] && [tpBindGet acct_owner] == "F"}##
	<tr class=subtitle>
		<th colspan=2 align=left><font color=white>Shop Details</font></th>
	</tr>
	<tr>
		<td class="caption">Shop Number</td>
		<td>
			##TP_PLAY auto_complete_shop.html##
		</td>
	</tr>
	<tr>
		<td class="caption">Log Number</td>
		<td>
			<input type="text" name="LogNo" size="8" value=""/>
		</td>
	</tr>
	##TP_ENDIF##

	<tr class=subtitle>
		<th colspan=2 align=left><font color=white>Funding</font></th>
	</tr>
	<tr>
		<td class=mandatory_caption>Account type</td>
		<td>
		##TP_IF {[tpGetVar NewUser]}##
			<select name="acct_type" onchange="return fs(this,'ChangeAcctType')">
				<script>
					write_select("##TP_acct_type##" ##TP_reg_acct_types##);
				</script>
			</select>
		##TP_ELSE##
			<input type=hidden name=acct_type value="##TP_acct_type##">
			<script>
				write_which("##TP_acct_type##", "DBT", "Debit", "DEP", "Deposit", "CDT", "Credit");
			</script>
		##TP_ENDIF##
		</td>
	</tr>
	##TP_IF {[tpGetVar NewUser] && [tpGetVar acct_type] == "DBT"}##
	<input type=hidden name=card_required value="Y">
	<tr>
		<td class=##TP_IF {[tpGetVar acct_type] == "DBT"}##mandatory_caption##TP_ELSE##caption##TP_ENDIF##>Debit Card No.</td>
		<td>
			<input type=text name="card_no" size=20 value="##TP_card_no##" >&nbsp;(No spaces)
		</td>
	</tr>
	<tr>
		<td class=##TP_IF {[tpGetVar acct_type] == "DBT"}##mandatory_caption##TP_ELSE##caption##TP_ENDIF##>Start date</td>
		<td><input type=text name="start" size=5 maxlength=5 value="##TP_start##">&nbsp;(mm/yy)</td>
	</tr>
	<tr>
		<td class=##TP_IF {[tpGetVar acct_type] == "DBT"}##mandatory_caption##TP_ELSE##caption##TP_ENDIF##>Expiry date</td>
		<td><input type=text name="expiry" size=5 maxlength=5 value="##TP_expiry##">&nbsp;(mm/yy)</td>
	</tr>
	<tr>
		<td class=##TP_IF {[tpGetVar acct_type] == "DBT"}##mandatory_caption##TP_ELSE##caption##TP_ENDIF##>Issue no.</td>
		<td>
			<input type=text name="issue_no" size=2 maxlength=2 value="##TP_issue_no##">
		</td>
	</tr>
	<tr>
		<td class=##TP_IF {[tpGetVar acct_type] == "DBT"}##mandatory_caption##TP_ELSE##caption##TP_ENDIF##>Cardholder Name</td>
		<td><input type="text" name="hldr_name" size="30" value="##TP_hldr_name##">&nbsp;(as it appears on the card)</td>
	</tr>
	##TP_ENDIF##
	<tr>
		<td class=mandatory_caption>Currency</td>
		<td>
		##TP_IF {[tpGetVar NewUser]}##
			<select name="currency_code" id="ccy_code" ##TP_IF {[tpGetVar acct_type] == "DBT" || [tpGetVar acct_type] == "DEP"}## onchange="javascript:currency_changed();" ##TP_ENDIF##>
			##TP_LOOP ccy_idx {[tpGetVar NumCCYs]}##
				<option value="##TP_CCYCode##" ##TP_CCYSel##>##TP_CCYName##</option>
			##TP_ENDLOOP##
			</select>
		##TP_ELSE##
			<input type=hidden name=currency_code value="##TP_currency_code##">
			##TP_currency_code##
		##TP_ENDIF##
		</td>
	</tr>

	##TP_IF {[tpGetVar NewUser] && ([tpGetVar acct_type] == "DBT" || [tpGetVar acct_type] == "DEP")}##
	<tr>
		<td class="mandatory_caption">Deposit Limit</td>
		<td>
			<span id="max_deposit_span">
				<select id="max_deposit">
					<option value="-1" selected="selected">Choose Limit</option>
				</select>
			</span>
		</td>
	##TP_ENDIF##

	<input type=hidden name=card_required value="N">
	<tr class=subtitle>
		<th colspan=2 align=left><font color=white>Security</font></th>
	</tr>
	<tr>
		<td class="caption">Username</td>
		<td>
	##TP_IF {[tpGetVar NewUser]}##
		##TP_IF {[OT_CfgGet ALLOW_SPECIFIED_USERNAME 1]}##
			<input type="text" name="username" size="20" value="##TP_username##" >
		##TP_ELSE##
			<input type="text" name="username_disabled" disabled="disabled" size="20" value="Auto Generated"  />
		##TP_ENDIF##
	##TP_ELSE##
			<input type="hidden" name="username" value="##TP_username##" />
			##TP_username##
	##TP_ENDIF##
		</td>
	</tr>
	##TP_IF {[tpGetVar NewUser]}##
	<tr>
		<td class=caption>Password</td>
		<td><input type=password name="password" size=20 value="##TP_password##"></td>
	</tr>
	<tr>
		<td class=caption>(again)</td>
		<td><input type=password name="password2" size=20 value="##TP_password2##"></td>
	</tr>
	##TP_ELSE##
	<tr>
		<td class=caption>Account Number</td>
		<td>
		<input type=hidden name="acct_no" value="##TP_acct_no##">
		##TP_acct_no##
		</td>
	</tr>
	##TP_IF {[OT_CfgGetTrue FUNC_EXT_ID] && [op_allowed ExtIdFunc]}##
	##TP_IF {[tpGetVar NumExtGroups] >0}##
		##TP_LOOP ext_group_idx {[tpGetVar NumExtGroups]}##
			<tr>
				<td class=caption>##TP_ExtGroupDisp##</td>
				<td>
					<input type=text name="ext_cust_id_##TP_TCL {tpBufWrite [tpGetVar ext_group_idx]}##" size=16 value="##TP_ExtCustId##">
					##TP_IF {[op_allowed ExtIdMastFunc]}##
					<input type="checkbox" onchange="master_changed()" name="ext_master_##TP_TCL {tpBufWrite [tpGetVar ext_group_idx]}##" ##TP_ExtMaster## value="Y">Master
						##TP_IF {[op_allowed ExtIdPermFunc]}##
						<input type="checkbox" name="ext_permanent_##TP_TCL {tpBufWrite [tpGetVar ext_group_idx]}##" ##TP_ExtPermanent## value="Y">Permanent
						##TP_ELSE##
						<input type="hidden" name="ext_permanent_##TP_TCL {tpBufWrite [tpGetVar ext_group_idx]}##" value="undef">
						##TP_ENDIF##
					##TP_ELSE##
					<input type="hidden" name="ext_master_##TP_TCL {tpBufWrite [tpGetVar ext_group_idx]}##" value="undef">
					<input type="hidden" name="ext_permanent_##TP_TCL {tpBufWrite [tpGetVar ext_group_idx]}##" value="undef">
					##TP_ENDIF##
				</td>
			</tr>
			<input type=hidden name="ext_group_id_##TP_TCL {tpBufWrite [tpGetVar ext_group_idx]}##" value="##TP_ExtGroupCode##"/>
		##TP_ENDLOOP##
		<input type=hidden name="ext_groups_count" value="##TP_TCL {tpBufWrite [tpGetVar NumExtGroups]}##"/>
	##TP_ENDIF##
	##TP_ENDIF##

	##TP_ENDIF##
	<tr>
		<td class=caption>Significant date</td>
		<td><input type=text name="sig_date" size=10 value="##TP_sig_date##">&nbsp;(ddmmyyyy)</td>
	</tr>
	##TP_IF {[OT_CfgGet FUNC_PERS_QUEST_1]}##
	<tr>
		<td class=caption>Challenge 1</td>
		<td><input type=text name="challenge_1" value="##TP_challenge_1##" size=40></td>
	</tr>
	<tr>
		<td class=caption>Response 1</td>
		##TP_IF {![tpGetVar NewUser] && [OT_CfgGet FUNC_HIDE_SECURITY_RESPONSE 0] == 1 && ![op_allowed ViewSecurityResponse]}##
		<td>********</td>
		##TP_ELSE##
		<td><input type=text name="response_1" value="##TP_response_1##" size=40></td>
		##TP_ENDIF##
	</tr>
	##TP_ENDIF##
	##TP_IF {[OT_CfgGet FUNC_PERS_QUEST_2]}##
	<tr>
		<td class=caption>Challenge 2</td>
		<td><input type=text name="challenge_2" value="##TP_challenge_2##" size=40></td>
	</tr>
	<tr>
		<td class=caption>Response 2</td>
		##TP_IF {![tpGetVar NewUser] && [OT_CfgGet FUNC_HIDE_SECURITY_RESPONSE 0] == 1 && ![op_allowed ViewSecurityResponse]}##
		<td>********</td>
		##TP_ELSE##
		<td><input type=text name="response_2" value="##TP_response_2##" size=40></td>
		##TP_ENDIF##
	</tr>
	##TP_ENDIF##
	##TP_IF {[op_allowed EliteCustAccess]}##
		<tr>
			<td class=caption>Elite Customer</td>
			<td><input type=checkbox name="elite" size=20 value="Y" ##TP_elite_chk##></td>
		</tr>
	##TP_ENDIF##
	##TP_IF {([tpGetVar ShowChannels] && [tpGetVar NewUser]) || ([op_allowed UpdRegChannel] && ![OT_CfgGet USE_SITE_OPERATOR 0])}##
	<tr>
		<td class=caption>Registration Channel</td>
		<td>
		<select name="source">
			<script>write_select("##TP_source##"
				##TP_LOOP channel_idx {[tpGetVar NumChannels]}##
					,"##TP_Channel##", "##TP_ChannelName##"
				##TP_ENDLOOP##
						);</script>
		</select>
		</td>
	</tr>
	##TP_ELSE##
		##TP_IF {[tpGetVar NewUser]}##
			<input type=hidden name="source" value='P'>
		##TP_ENDIF##
	##TP_ENDIF##

	<tr class=subtitle>
		<th colspan=2 align=left><font color=white>Regional</font></th>
	</tr>
	<tr>
		<td class=##TP_IF {[tpGetVar acct_type] != "DEP"}##mandatory_caption##TP_ELSE##caption##TP_ENDIF##>Language</td>
		<td>
		<select name="lang_code">
		##TP_LOOP lang_idx {[tpGetVar NumLangs]}##
			<option value="##TP_LangId##" ##TP_LangSel##>##TP_LangName##</option>
		##TP_ENDLOOP##
		</select>
		</td>
	</tr>
		<tr>
		<td class=caption>Affiliate</td>
		<td>
	##TP_IF {[tpGetVar NewUser]}##
		##TP_IF {[OT_CfgGet USE_AFFILIATE_SELECT_LIST 0]}##
			<select name="aff_id">
				<option value=""></option>
			##TP_LOOP affiliate_idx {[tpGetVar NumAffiliates]}##
				<option value="##TP_AffiliateId##" ##TP_AffiliateSel##>##TP_AffiliateName##</option>
			##TP_ENDLOOP##
			</select>
		##TP_ELSE##
			<input type=text name=aff_id value="##TP_aff_id##" size=5>
		##TP_ENDIF##
	##TP_ELSE##
			<input type="hidden" name="aff_id" value="##TP_aff_id##">
			##TP_aff_id##
	##TP_ENDIF##

		</td>
	</tr>
	<tr class=subtitle>
		<th colspan=2 align=left><font color=white>Name/Address</font></th>
	</tr>
	<tr>
		<td class=mandatory_caption>Title</td>
		<td><input type=text name=title value="##TP_title##" size=10></td>
	</tr>
	<tr>
		<td class=mandatory_caption>Forename</td>
		<td><input type=text name=fname value="##TP_fname##" size=25></td>
	</tr>
	##TP_IF {[OT_CfgGet CAPTURE_FULL_NAME 0] == 1}##
	<tr>
		<td class=caption>Middle name</td>
		<td><input type=text name=mname value="##TP_mname##" size=25></td>
	</tr>
	##TP_ENDIF##
	<tr>
		<td class=mandatory_caption>Surname</td>
		<td><input type=text name=lname value="##TP_lname##" size=25></td>
	</tr>
	<tr>
		<td class=mandatory_caption>Country </td>
		<td>
		<select name="country_code" onchange="javascript:manage_countries(this);">
			##TP_LOOP country_idx {[tpGetVar NumCountrys]}##
				<option value="##TP_CountryCode##" ##TP_CountrySel##>##TP_CountryName##</option>
			##TP_ENDLOOP##
		</select>
		</td>
	</tr>
    <tr>
		<td class=mandatory_caption>House Number</td>
		<td><input type=text id=addr_street_1 name=addr_street_1 value="##TP_addr_street_1##" size=40></td>
	</tr>
	<tr>
		<td class=mandatory_caption>Address 2</td>
		<td><input type=text id=addr_street_2 name=addr_street_2 value="##TP_addr_street_2##" size=40></td>
	</tr>
	<tr>
		<td class=caption>Address 3</td>
		<td><input type=text id=addr_street_3 name=addr_street_3 value="##TP_addr_street_3##" size=40></td>
	</tr>
	<tr>
		<td class=caption>City/Town</td>
		<td><input type=text id=addr_city name=addr_city value="##TP_addr_city##" size=25></td>
	</tr>
	<tr>
		<td class=caption>County</td>
		<td><input type=text id=addr_street_4 name=addr_street_4 value="##TP_addr_street_4##" size=40></td>
	</tr>
	<tr style="display:none" id="state">
		<td class=caption>State</td>
		<td>
		<select name="addr_state_id">
		</select>
		</td>
	</tr>
	<tr>
		<td class=mandatory_caption>Postcode</td>
		<td><input type=text id=addr_postcode name=addr_postcode value="##TP_addr_postcode##" size=25>
			##TP_IF {[OT_CfgGet FUNC_CUST_ADDRESS_LOOKUP]}##
				<input type=button class="btn_def" value="Search" onClick="return fs(this,'GoPCodeLookup')">
			##TP_ENDIF##
		</td>
	</tr>
	<tr>
		<td class=caption>Postal Country</td>
		<td><input type=text name=addr_country value="##TP_addr_country##" size=25></td>
	</tr>
	##TP_IF {[OT_CfgGet FUNC_REG_QAS_LOOKUP 0]}##
	<tr style="display:none" id="find_address">
		<td class=caption></td>
		<td>
			<input type="button" style="width: 188px" id="find_address_button" onclick="return document.QAS.lookup_address();" class="btn" value="Find address" />
		</td>
	</tr>
	<tr id="addressSelect" style="display:none">
		<td class="caption">Select an address</td>
		<td>
			<select id="addrSelect" name="address" multiple="multiple" disabled="true"></select>
		</td>
	</tr>
	<tr id="useAddressButton" style="display:none">
		<td class="caption"></td>
		<td>
			<input id="useAddrButton" class="btn" type="button" value="Use this address" onclick="return document.QAS.lookup_refine();" disabled="true"/>
		</td>
	</tr>
	##TP_ENDIF##
	<tr>
		<td class=##TP_IF {[tpGetVar acct_type] != "CDT"}##mandatory_caption##TP_ELSE##caption##TP_ENDIF##>Telephone</td>
		<td><input type=text name=telephone value="##TP_telephone##" size=20></td>
	</tr>
	<tr>
		<td class=##TP_IF {[tpGetVar acct_type] != "CDT"}##mandatory_caption##TP_ELSE##caption##TP_ENDIF##>Mobile</td>
		<td><input type=text name=mobile value="##TP_mobile##" size=20></td>
	</tr>
	<tr>
		<td class=caption>Office</td>
		<td><input type=text name=office value="##TP_office##" size=20></td>
	</tr>
	<tr>
		<td class=caption>Fax</td>
		<td><input type=text name=fax value="##TP_fax##" size=20></td>
	</tr>
	<tr>
		<td class=caption>Email</td>
		<td><input type=text name=email value="##TP_email##" size=50></td>
	</tr>
	<tr>
		<td class=caption>ITV Email</td>
		<td><input type=text name=itv_email value="##TP_itv_email##" size=50></td>
	</tr>


	<tr class=subtitle>
		<th colspan=2 align=left><font color=white>Personal</font></th>
	</tr>
	<tr>
		<td class=##TP_IF {[tpGetVar acct_type] == "DBT"}##mandatory_caption##TP_ELSE##caption##TP_ENDIF##>Salutation</td>
		<td><input type=text name=salutation value="##TP_salutation##" size=25></td>
	</tr>
	<tr>
		<td class=##TP_IF {[tpGetVar acct_type] == "CDT"}##mandatory_caption##TP_ELSE##caption##TP_ENDIF##>Occupation</td>
		<td><input type=text name=occupation value="##TP_occupation##" size=25></td>
	</tr>
	<tr>
		<td class=##TP_IF {[tpGetVar acct_type] != "CDT"}##mandatory_caption##TP_ELSE##caption##TP_ENDIF##>Gender</td>
		<td>
			<input type=radio name=gender value="M" ##TP_gender_M_chk##>Male
			<input type=radio name=gender value="F" ##TP_gender_F_chk##>Female
		</td>
	</tr>
	<tr>
		<td class=mandatory_caption>Date of Birth</td>
		<td><input type=text name=dob value="##TP_dob##" size=10>&nbsp;(yyyy-mm-dd)</td>
	</tr>
	<tr>
		<td class=mandatory_caption>Introductory source</td>
		<td>
			<select name="hear_about" onChange="build_ha_list(this.options[this.selectedIndex].value)">
			##TP_LOOP hear_about_type_idx {[tpGetVar NumHearAboutType]}##
				<option value="##TP_hear_about_type##" ##TP_hear_about_type_sel##>##TP_hear_about_type##</option>
			##TP_ENDLOOP##
			</select>
			<select name="hear_about_txt">
				<script language="JavaScript">
					var output="";
					var i=0;
					for (i=0; i<ha.length; i++) {
						if (haTypeSel == ha[i]) {
							output+="<option value="+ha[i]+" selected='selected'>"+haDesc[i]+"</option>";
						} else {
							output+="<option value="+ha[i]+">"+haDesc[i]+"</option>";
						}
					}
					document.write(output);
				</script>
			</select>
		</td>
	</tr>
	<tr>
		<td class=mandatory_caption>
		</td>
		<td>
			<input type=text name=hear_about_free_txt value="##TP_hear_about_free_txt##" size=20>
		</td>
	</tr>
	<tr>
		<td class=caption>Referal Username</td>
		<td>
			<input type=text name=ref_cust_id size=20>
		</td>
	</tr>
    <tr>
        <td class=caption>Partnership flags</td>
        <td>
            <select name="partnership">
            ##TP_LOOP partner_idx {[tpGetVar NumPartner]}##
                <option value="##TP_ptnr_code##" ##TP_partner_sel##>##TP_partner_desc##</option>
            ##TP_ENDLOOP##
            </select>
        </td>
    </tr>
	<tr>
		<td class=##TP_IF {[tpGetVar acct_type] != "CDT"}##mandatory_caption##TP_ELSE##caption##TP_ENDIF##>Contact OK?</td>
 		<td><input type=checkbox name="contact_ok" size=20 value="Y" ##TP_contact_ok_chk##></td>
	</tr>
	##TP_IF {[info exists CONTACT_HOW] && $CONTACT_HOW(num) > 0}##
	<tr>
		<td class=caption>Contact Methods</td>
<script>
// set all the check boxes to be the same checked status as the one provided as an argument
// if master if not null, then set the value of value to be the concatonation of all
// the checked boxes
function changeCheckboxGroup(checkbox,masterName) {
	var val = checkbox.checked;
	var isAll = (checkbox.value == "all");
 	var checkboxes = eval("checkbox.form."+checkbox.name);
	if (isAll) {
		// if the one supplied an all style one then select this checkbox
		for (var i=0; i < checkboxes.length; i++) {
			checkboxes[i].checked = val;
		}
	} else {
		var allChecked = true;
		for (var i=0; i < checkboxes.length; i++) {
			if (checkboxes[i].value != "all" && checkboxes[i].checked == false) {
				allChecked = false;
			}
		}
		for (var i=0; i < checkboxes.length; i++) {
			if (checkboxes[i].value == "all") {
				checkboxes[i].checked = allChecked;
			}
		}
	}
	if (masterName != null) {
		val = "";
		var master = eval("checkbox.form."+masterName);
		for (var i=0; i < checkboxes.length; i++) {
			if (checkboxes[i].value != "all" && checkboxes[i].checked) {
				val += checkboxes[i].value;
			}
		}
		master.value = val;
	}
}

</script>
		<td>
			<input type=checkbox name="contact_how_frag" value="all" ##TP_contact_how_all_chk##" onclick="changeCheckboxGroup(this,'contact_how');">All
			##TP_LOOP contact_how_idx {$CONTACT_HOW(num)}##
				<input type=checkbox name="contact_how_frag" value="##TP_contact_how_code##" ##TP_contact_how_chk## onclick="changeCheckboxGroup(this,'contact_how');">##TP_contact_how_name##
			##TP_ENDLOOP##
			<input type="hidden" name="contact_how" value="##TP_contact_how##">
		</td>
	</tr>
	##TP_ELSE##
	<!-- not showing the contact options -->
	<input type="hidden" name="contact_how" value="....">
	##TP_ENDIF##
	##TP_IF {[OT_CfgGet MKT_CONTACT 0]}##
	<tr>
		<td class=caption>Marketing contact OK?</td>
		<td><input type=checkbox name="mkt_contact_ok" size=20 value="Y" ##TP_mkt_contact_ok_chk##></td>
	</tr>
	##TP_ENDIF##
	<tr>
		<td class=caption>Partner contact OK?</td>
		<td><input type=checkbox name="ptnr_contact_ok" size=20 value="Y" ##TP_ptnr_contact_ok_chk##></td>
	</tr>
	<tr>
		<td class=caption>Decimal pricing</td>
		<td><input type=checkbox name="price_type" size=20 value="DECIMAL" ##TP_decimal_chk##></td>
	</tr>

	##TP_IF {[OT_CfgGet FAV_FB_TEAM 0]}##
	<tr class=subtitle>
		<th colspan=2 align=left><font color=white>Favourite Football Team</font></th>
	</tr>
	<tr>
		<td class=caption>Team</td>
		<td>
		<select name="fbteam">
		##TP_LOOP fbteam_idx {[tpGetVar NumFBTeams]}##
		<option value="##TP_FBTeam##"##TP_FBTeamSel##>##TP_FBTeam##</option>
		##TP_ENDLOOP##
		</select>
		</td>
	</tr>
	##TP_ENDIF##
	<tr class=subtitle>
		<th colspan=2 align=left><font color=white>Account Options</font></th>
	</tr>

	<tr>
		<td class=caption>Tax group</td>
		<td>
			<select name="cust_sort">
			##TP_LOOP sort_idx {[tpGetVar NumSorts]}##
				<option selectvalue="##TP_sort##" ##TP_sort_sel##>##TP_sort##</option>
			##TP_ENDLOOP##
			</select>
		</td>
	</tr>
	<tr>
		<td class=caption>Tax on stake</td>
		<td><input type=checkbox name="tax_on" size=20 value="Y" ##TP_tax_on_chk##></td>
	</tr>
	##TP_IF {[tpGetVar acct_type] == "CDT"}##
	<tr>
		<td class=caption>Pay for a/p</td>
		<td><input type=checkbox name="ap_on" size=20 value="Y" ##TP_ap_on_chk##></td>
	</tr>
	##TP_ENDIF##
	##TP_IF {[OT_CfgGet FUNC_SINGLE_CUSTOMER_GROUP 1]}##
	<tr>
		<td class=caption>Customer group</td>
		<td>
			<select name="code">
			##TP_LOOP code_idx {[tpGetVar NumCodes]}##
				<option value="##TP_code##" ##TP_code_sel##>##TP_code_desc##</option>
			##TP_ENDLOOP##
			</select>
			<input type=text name=code_txt value="##TP_code_txt##" size=20>
		</td>
	</tr>
	##TP_ENDIF##

	##TP_IF {[tpGetVar acct_type] != "DEP"}##
	<tr class=subtitle>
		<th colspan=2 align=left><font color=white>Account Parameters</font></th>
	</tr>
	##TP_ENDIF##

	##TP_IF {[tpGetVar acct_type] == "DBT"}##
	<tr>
		<td class=caption>Settle account</td>
		<td>
			<input type=radio name=settle_type value="N" ##TP_settle_type_N_chk##>Never
			<input type=radio name=settle_type value="T" ##TP_settle_type_T_chk##>Threshold
		</td>
	</tr>
	##TP_ELSEIF {[tpGetVar acct_type] == "DEP"}##
	<input type=hidden name=settle_type value="N">
	##TP_ELSEIF {[tpGetVar acct_type] == "CDT"}##
	<input type=hidden name=settle_type value="T">
	##TP_ENDIF##

	##TP_IF {[tpGetVar acct_type] == "DBT" || [tpGetVar acct_type] == "CDT"}##
		##TP_IF {[tpGetVar acct_type] == "CDT" && [OT_CfgGet CREDIT_CUST_DISABLE_MIN_REPAY 0]}##
		<input type=hidden name=min_repay value="##TP_min_repay##">
		##TP_ELSE##
		<tr>
			<td class=caption>Min repayment</td>
			<td><input type=text name=min_repay size=6 value="##TP_min_repay##"></td>
		</tr>
		##TP_ENDIF##
	<tr>
		<td class=caption>Retain</td>
		<td><input type=text name=min_funds size=6 value="##TP_min_funds##"></td>
	</tr>
	##TP_ELSE##
	<input type=hidden name=min_repay value="##TP_min_repay##">
	<input type=hidden name=min_funds value="##TP_min_funds##">
	##TP_ENDIF##
	##TP_IF {[tpGetVar acct_type] == "CDT"}##
	<tr>
		<td class=caption>Request payment at</td>
		<td><input type=text name=min_settle size=6 value="##TP_min_settle##"></td>
	</tr>
		##TP_IF {[tpGetVar acct_type] == "CDT" && [OT_CfgGet CREDIT_CUST_DISABLE_PAY_PCT 0]}##
		<input type=hidden name=pay_pct value="##TP_pay_pct##">
		##TP_ELSE##
		<tr>
			<td class=caption>Payment percentage</td>
			<td><input type=text name=pay_pct size=6 value="##TP_pay_pct##"></td>
		</tr>
		##TP_ENDIF##
	<tr>
		<td class=mandatory_caption>Credit Limit</td>
		<td><input type=text name=credit_limit size=6 value="##TP_credit_limit##"></td>
	</tr>
	##TP_ELSE##
	<input type=hidden name=min_settle value="##TP_min_settle##">
	<input type=hidden name=pay_pct value="##TP_pay_pct##">
	<input type=hidden name=credit_limit value="##TP_credit_limit##">
	##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_CUST_STATEMENTS 0] && [tpGetVar NewUser]}##
	<tr class=subtitle>
		<th colspan=2 align=left><font color=white>Statements</font></th>
	</tr>

	##TP_IF {[tpGetVar acct_type] != "CDT"}##
	<tr>
		<td class=caption>Required</td>
		<td>
			<input type=checkbox name=stmt_on value="Y" ##TP_stmt_on_chk##>
		</td>
	</tr>
	##TP_ELSE##
	<input type=hidden name=stmt_on value="Y" ##TP_stmt_on_chk##>
	##TP_ENDIF##

	<tr>
		<td class=mandatory_caption>Generate every</td>
		<td>
			<input type=text name=freq_amt size=6 value="##TP_freq_amt##">
			<select name=freq_unit>
				<script>
				write_select("##TP_freq_unit##", "W", "week(s)", "M", "Month(s)")
				</script>
			</select>
			##TP_IF {[OT_CfgGet STMT_CONTROL 0]}##
			<p>
				<b>Statement dates are configured to be set from the
				<a href="##TP_CGI_URL##?action=ADMIN::STMT_CONTROL::go_stmt_controls">control</a>.
				This means that the frequency and date may be automatically
				changed	when the statements are produced.</b>
			</p>
			##TP_ENDIF##
		</td>
	</tr>
	##TP_IF {[OT_CfgGet STATEMENT_DELIVERY_CHOOSE 1]}##
	<tr>
		<td class=mandatory_caption>Delivery method</td>
		<td>
			<select name=dlv_method>
				<script>
				write_select("##TP_dlv_method##", "P", "Post", "E", "Email")
				</script>
			</select>
		</td>
	</tr>
	##TP_ELSE##
		<input type=hidden name=dlv_method value="P">
	##TP_ENDIF##
	##TP_IF {[OT_CfgGet STATEMENT_BRIEF_CHOOSE 1]}##
	<tr>
		<td class=caption>Brief statement</td>
		<td>
			<input type=checkbox name=brief value="N" ##TP_brief_chk##>
		</td>
	</tr>
	##TP_ELSE##
		<input type=hidden name=brief value="N">
	##TP_ENDIF##
	<tr>
		<td class=caption>From</td>
		<td><input type=text size=19 name=due_from value="##TP_due_from##"></td>
	</tr>
	<tr>
		<td class=caption>to</td>
		<td><input type=text size=19 name=due_to value="##TP_due_to##"><input type=checkbox name=enforce_period value="Y" ##TP_enforce_period_chk##>enforce full period&nbsp;&nbsp;</td>
	</tr>
	<input type=hidden name=stmt_available value="Y">
##TP_ELSE##
	<input type=hidden name=stmt_available value="N">
##TP_ENDIF##
##TP_IF {[OT_CfgGet FUNC_MENU_AUTO_DBT_RETURN 0]}##
	##TP_IF {[tpGetVar acct_type] == "DBT"}##
	<tr class=subtitle>
		<th colspan=2 align=left><font color=white>ClearDown Group</font></th>
	</tr>
	<tr>
			<td>Groups</td>
			<td>
				<select name=cd_grp_id>
				##TP_LOOP cd_grp_idx {[tpGetVar NumGroups]}##
				<option value="##TP_cd_grp_id##" ##TP_cd_grp_sel##> ##TP_cd_grp_name## -- ##TP_cd_days##</option>
				##TP_ENDLOOP##
				</select>
			</td>
	</tr>
    ##TP_ELSE##
	<input type="hidden" name="cd_grp_id" value = "##TP_cd_grp_default##">
    ##TP_ENDIF##
##TP_ENDIF##

	##TP_IF {[OT_CfgGet FUNC_OVS 0] == 1 &&  [OT_CfgGet FUNC_OVS_USE_SERVER 0] == 1} ##
		##TP_IF {[OT_CfgGet FUNC_OVS_REG_AV_CHANGE 1]}##
			##TP_IF {![tpGetVar NewUser 0]} ##
			<tr class=subtitle>
				<th colspan=2 align=left>
				<font color=white>
				Age Verification
				</font>
				</th>
			</tr>
			<tr>
				<td class=caption>Age-Verified</td>
				<td>
					##TP_IF {[op_allowed VRFAGECHECK]}##
						<select name="age_verified_list">
							<script type="text/javascript">
								write_select('##TP_AGE_VRF_STATUS##','N','N/A','A','Activated','P','Restricted','S','Suspended','U','Underage');
							</script>
						</select>
					##TP_ELSE##
						<script type="text/javascript">
								write_which('##TP_AGE_VRF_STATUS##','N','N/A','A','Activated','P','Restricted','S','Suspended','U','Underage');
						</script>
					##TP_ENDIF##
				</select>
				</td>
			</tr>
			##TP_ENDIF##
		##TP_ELSE##
			<input type="hidden" name="age_verified_list" value="##TP_AGE_VRF_STATUS##">
		##TP_ENDIF##
	##TP_ENDIF##

	<tr>
		<th colspan=2 class=buttons>
			<table border=0 cellspacing=0 cellpadding=0 width=100%>
				<tr>
					<th class=buttons>
					##TP_IF {[tpGetVar NewUser]}##
						<input type=button class="btn_def" value="Add Customer" onClick="return fs(this,'DoRegister')">
					##TP_ELSE##
						<input type=button class="btn_def" value="Update Customer" onClick="return fs(this,'UpdCustReg')">
						<input type=button class="btn_def" value="Back" onClick="return fs(this,'Back')">
						<input type=hidden name=CustId value="##TP_CustId##">
						##TP_IF {[OT_CfgGet FUNC_BETCARD 0]}##
						Ignore mandatory values <input type=checkbox name=ignore_mand value=Y>
						##TP_ENDIF##
					##TP_ENDIF##
					</th>
				</tr>
			</table>
		</th>
	</tr>

	</form>
</table>
</body>
</html>

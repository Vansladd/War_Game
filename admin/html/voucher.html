<html>
<!-- $Id -->
<head>
<meta http-equiv="Content-" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">
<title>Freebet Voucher Generation</title>
##TP_PLAY JS_WriteSelect.html##
<script>
<!--
function fs(b,t)
{
	b.disabled = true;
	b.value = "Busy...";
	b.form.SubmitName.value=t;
	b.form.submit();
	return true;
}
function write_tr(status,expected,created)
{
	var expected = expected;
	var created = created;
	
	if (status == 'Y') {
		if (created == expected) {
			document.write('<tr class=active>');
		} else {
			document.write('<tr class=unknown>');
		}
	} else if (status == 'N') {
		document.write('<tr class=suspended>');
	}
}

function type_change()
{
	document.form_voucher_generation.action.value="ADMIN::FREEBETS::GoGenerateVouchersSelect";
	document.form_voucher_generation.submit();
}

function trigger_change()
{
	document.form_voucher_generation.action.value="ADMIN::FREEBETS::GoGenerateTriggerSelect";
	document.form_voucher_generation.submit();
}

function voucher_runs_change()
{
	document.form_voucher_generation.action.value="ADMIN::FREEBETS::GoGenerateVoucherRunsSelect";
	document.form_voucher_generation.submit();
}
function shift_focus() {
	document.trigger_select.Back.focus();
}

function check_filename () {
	var f = document.file_voucher_generation;
	if (f.filename.value == "") {
		f.filename.focus();
		alert("Please enter a valid filename.");
	} else {
		f.submit();
	}
}

//-->
</script>
</head>

<body>
##TP_PLAY error_rpt.html##
##TP_PLAY msg_rpt.html##
	
<table border=0 cellspacing=0 cellpadding=2>
	<form name="file_voucher_generation" method=post action="##TP_VOUCHER_URL##" enctype="multipart/form-data">
	
	<input type="hidden" name="returl" value="##TP_CGI_URL##">
	<input type="hidden" name="retaction" value="ADMIN::FREEBETS::DoGenerateVouchers">
	<input type="hidden" name="GenerateOption" value="file">
	
	<tr>
		<th colspan=2 class=title>Voucher File Generation By Upload</th>
	</tr>
	<tr>
		<td class=caption>Filename</td>
		<td>
		<input type="file" name="filename" size=40>
		<input type="hidden" name="filetype" value="name">
		</td>
	</tr>
	<tr>
		<th colspan=2 class=buttons>
		<input type="button" class="btn_def" name="DoIt" value="Generate File" onClick="javascript:check_filename();" />
		</th>
	</tr>
	
	</form>

	<tr>
	<td><br></td>
	</tr>
	<form name="form_voucher_generation" action="##TP_CGI_URL##" method="post" >
	<input type=hidden name=GenerateOption value="form">
	<input type=hidden name=AffLevel value="##TP_AffLevel##">
	<input type=hidden name=AffId value="##TP_AffId##">
	<input type=hidden name=AffGrpId value="##TP_AffGrpId##">
	<tr>
		<th colspan=2 class=title>Voucher File Generation By Options</th>
	</tr>
		
	<tr>
		<td class=caption>Voucher Type</td>
		<td>
			<select name=SelVoucherCode onChange="type_change();">
				<script>
	    		write_select("##TP_SelVoucherCode##"
						##TP_LOOP v_idx {[tpGetVar num_vouchers]}##
	    				,"##TP_VoucherCode##","##TP_VoucherCode## - ##TP_VoucherName##"
						##TP_ENDLOOP##
					);
				</script>
			</select>
		</td>
	</tr>
	
	<tr>
		<td class=caption>Offer to apply voucher</td>
		<td>
			<select name=SelVoucherTrigger onChange="trigger_change();">
				<script>
	    		write_select("##TP_SelVoucherTrigger##"
						##TP_LOOP vt_idx {[tpGetVar num_voucher_triggers]}##
	    				,"##TP_VoucherTriggersId##","##TP_VoucherTriggersName##"
						##TP_ENDLOOP##
					);
				</script>
			</select>
		</td>
	</tr>
	
	

	<!-- check whether voucher type is significant date -->
	##TP_IF {[tpGetVar VoucherCode] == "SIGDT"}##
	<tr>
		<td class=caption>Date Type</td> 
   		<td><input type=radio name=DateOption value="dob" ##TP_dob_checked##>Birthday</td>
	</tr>
	<tr>
		<td></td>
		<td><input type=radio name=DateOption value="reg" ##TP_reg_checked##>Registration Anniversary</td>
	</tr>
	<tr>
		<td class=caption>Date</td>
		<td>
			<input type=text name="date" value="##TP_date##" size=10 maxlength=10/>&nbsp; 
			<i>(YYYY-MM-DD)</i>&nbsp;
		</td>
	</tr>
	
	##TP_ENDIF##
	
	<!-- check whether voucher type is inactivity -->
	##TP_IF {[tpGetVar VoucherCode] == "INACT"}##
	<tr>
		<td class=caption>Inactive Period</td>
		<td>
			<input type=text name="period" value="##TP_period##" size=10 maxlength=10/>&nbsp; 
			<i>(Days)</i>&nbsp;
		</td>
	</tr>
	
	##TP_ENDIF##

	<!-- check whether voucher type is incentive -->
	##TP_IF {[tpGetVar VoucherCode] == "INCEN"}##
	<tr>
		<td class=caption>Number of Vouchers</td>
		<td>
			<input type=text name="number" value="##TP_number##" size=10 maxlength=10/>&nbsp; 
		</td>
	</tr>
	
	##TP_ENDIF##

	<!-- check whether voucher type is miscellaneous -->
	##TP_IF {[tpGetVar VoucherCode] == "VAGUE"}##
	<tr>
		<td class=caption>Customer Account No.</td>
		<td>
			<input type=text name="acct_no" value="##TP_acct_no##" size=10 maxlength=10/>&nbsp;
			or <b>Username</b>&nbsp;
			<input type=text name="username" value="##TP_username##" size=10 maxlength=20/>&nbsp;
		</td>
	</tr>
	
	##TP_ENDIF##

	

	<tr>
		<td class=caption>Valid From</td>
		<td>
			<input type=text name="ValidFrom" value="##TP_ValidFrom##" size=19 maxlength=19/>&nbsp; 
			<i>(YYYY-MM-DD HH:MM:SS)</i>&nbsp;
		</td>
	</tr>
	
	<tr>
		<td class=caption>Valid To</td>
		<td>
			<input type=text name="ValidTo" value="##TP_ValidTo##" size=19 maxlength=19/>&nbsp; 
			<i>(YYYY-MM-DD HH:MM:SS)</i>&nbsp;
		</td>
	</tr>
	<tr>
		<th colspan=2 class=buttons>
		<input type=button class="btn_def" value="Generate File" onClick="return fs(this,'GenerateVouchers')">
		</th>
	</tr>
	<input type=hidden name=SubmitName value="">
	<input type=hidden name=action value=ADMIN::FREEBETS::DoGenerateVouchers>
	
	##TP_IF {[tpGetVar VoucherCode] == "VAGUE"}##
	##TP_IF {[tpGetVar DisplayVoucher]}##

	<tr>
		<th class=title colspan=10>Generated Voucher</th>
	</tr>
	<tr>
		<td colspan=3>Voucher <b>##TP_VAGUE_VOUCHER##</b> created for ##TP_VAGUE_FIELD## <b>##TP_VAGUE_VALUE##</b></td>
	</tr>

	##TP_ENDIF##
	##TP_ENDIF##
</table>
<br>
<table border=0 cellspacing=0 cellpadding=2>
	<tr>
		<th class=title colspan=10>Offer Voucher Runs</th>
	</tr>
	<tr>
		<td colspan=2 class=caption>Number of runs to display</td>
		<td>
			<select name="SelNumVoucherRuns" onChange="voucher_runs_change();">
				<script>
	    		write_select("##TP_SelNumVoucherRuns##","","All","100","Last 100","50","Last 50","25","Last 25","10","Last 10");
				</script>
			</select>
		</td>
	</tr>
	</form>
	<tr>
		<th nowrap class=colhead>Id</th>
		<th nowrap class=colhead>Date</th>
		<th nowrap class=colhead>Generated<br>By</th>
		<th nowrap class=colhead>Vouchers<br>Expected</th>
		<th nowrap class=colhead>Vouchers<br>Created</th>
		##TP_IF {[tpGetVar VoucherCode] == "INACT"}##
		<th nowrap class=colhead>Inactive<br>Period</th>
		##TP_ENDIF##
		##TP_IF {[tpGetVar VoucherCode] == "SIGDT"}##
		<th nowrap class=colhead>Date<br>Option</th>
		<th nowrap class=colhead>Date</th>
		##TP_ENDIF##
		##TP_IF {[tpGetVar VoucherCode] == "VAGUE"}##
		<th nowrap class=colhead>AcctNo</th>
		<th nowrap class=colhead>Username</th>
		##TP_ENDIF##
		<th nowrap class=colhead>Upload<br>File</th>
		<th nowrap class=colhead>File<br>Created</th>
		<th nowrap class=colhead>Export<br>File</th>
	</tr>
	##TP_IF {[tpGetVar num_voucher_runs]}##
	##TP_LOOP vr_idx {[tpGetVar num_voucher_runs]}##
	<script>write_tr('##TP_file_created##','##TP_vouchers_expected##','##TP_vouchers_created##');</script>
		<td>##TP_voucher_run_id##&nbsp;</td>
		<td>##TP_cr_date##&nbsp;</td>
		<td>##TP_generate_option##&nbsp;</td>
		<td>##TP_vouchers_expected##&nbsp;</td>
		<td>##TP_vouchers_created##&nbsp;</td>
		##TP_IF {[tpGetVar VoucherCode] == "INACT"}##
		<td>##TP_inact_period##&nbsp;</td>
		##TP_ENDIF##
		##TP_IF {[tpGetVar VoucherCode] == "SIGDT"}##
		<td>##TP_sigdt_option##&nbsp;</td>
		<td>##TP_sigdt##&nbsp;</td>
		##TP_ENDIF##
		##TP_IF {[tpGetVar VoucherCode] == "VAGUE"}##
		<td>##TP_acct_no##&nbsp;</td>
		<td>##TP_username##&nbsp;</td>
		##TP_ENDIF##
		<td>##TP_upload_filename##</td>
		<td>##TP_file_created##</td>
		<td><a href="##TP_CGI_URL##?action=ADMIN::FREEBETS::GoDisplayFile&DisplayFiletype=voucher&VoucherType=##TP_SelVoucherCode##&FromLine=0&ToLine=100&TotalLines=##TP_vouchers_created##&DisplayFilename=##TP_export_filename##">##TP_export_filename##</a></td>
	</tr>
	##TP_ENDLOOP##
	##TP_ELSE##
	<tr>
		<td colspan=10 align=center><i>There are no runs for this voucher type and offer</i></td>
	</tr>
	##TP_ENDIF##
</body>
</html>

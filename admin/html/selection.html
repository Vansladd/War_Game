<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- $Id: selection.html,v 1.1.1.1 2011/10/04 10:54:25 xbourgui Exp $ -->
<title>Update Event Selection</title>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=##TP_CHARSET##">
<link rel="stylesheet" type="text/css" href="##TP_CGI_URL##?action=stylesheet">

<style type="text/css">
	td.dbl_res_mismatch {
		color:       red;
		font-weight: bold;
	}
	td.dbl_res_masked {
		color:       green;
		font-weight: bold;
	}
</style>

##TP_PLAY JS_WriteSelect.html##
<script language=JavaScript>

##TP_IF {[OT_CfgGet BF_ACTIVE 0]}##
	##TP_PLAY bf_market.js##
##TP_ENDIF##

##TP_INCL price_util.js##

var errorList = "";


//get prices from the other selections in the market
##TP_IF {![tpGetVar opAdd 0]}##
var mktOcInfos = new Array();
var mktOcs = new Array();

##TP_LOOP oc_idx {[tpGetVar NumOcs]}##
	mktOcInfos['##TP_EvOcId##'] = new Array();
	mktOcInfos['##TP_EvOcId##'][0] = ##TP_EvOcId##;
	mktOcInfos['##TP_EvOcId##'][1] = ##TP_IF {[tpBindGet LpNum] != ""}## ##TP_LpNum## ##TP_ELSE## '' ##TP_ENDIF##;
	mktOcInfos['##TP_EvOcId##'][2] = ##TP_IF {[tpBindGet LpDen] != ""}## ##TP_LpDen## ##TP_ELSE## '' ##TP_ENDIF##;
	mktOcs.push('##TP_EvOcId##');
##TP_ENDLOOP##

var market_active = ##TP_MktActive##;

##TP_ENDIF##

function add_err(e_str)
{
	if (errorList.length > 0) {
		errorList += "\n";
	}
	errorList += e_str;
}

function TeamEvOcPopup()
{
	window.open("##TP_CGI_URL##/admin?action=ADMIN::TEAMPLAYER::GoTeamEvOc",
		"teams",
		"toolbar=no,location=no,directories=no,menubar=no,resizable=yes,width=450,height=300");
}

function clear_team_id ()
{
	document.DoSel.teamId.value = "";
}


function validate(f)
{
	return true;

	var submit_name = f.SubmitName.value;
	var scheme      = f.PricingScheme.value;

	errorList = "";

	if (submit_name == "Settle Selection") {

		var settle = confirm(
			"** This operation is not reversible **\n\n" +
			"Please confirm that you want to settle this selection");

		return settle;
	}

	if (submit_name == "Set Selection Result") {

		var result = f.Result.options[f.Result.selectedIndex].value;

		if (scheme == "SP") {

			if (result == "W") {
				var sp_num   = f.OddsSPNum.value;
				var sp_denom = f.OddsSPDenom.value;

				if (sp_num.length == 0 || sp_denom.length == 0) {
					add_err("starting price must be specified");
				} else {
					if (!isInt8(sp_num, false) || !isInt8(sp_denom, false)) {
						add_err("starting price : invalid numbers");
					} else {
						if ((parseInt(sp_num) < 1) || (parseInt(sp_denom) < 1)) {
							add_err("odds num/denom must be positive integers");
						}
					}
				}
			} else {
				f.OddsSPNum.value   = "";
				f.OddsSPDenom.value = "";
			}
		}
	}

	if (submit_name == "Modify Selection") {

		var desc          = strTrim(f.Desc.value, " ");
		var disporder     = strTrim(f.DispOrder.value, " ");
		var group_menu    = f.OptGrp;
		var group         = group_menu.options[group_menu.selectedIndex].value;
		var max_bet       = f.MaxBet.value;
		var min_bet       = f.MinBet.value;
		var max_tot_stake = f.MaxTotalStake.value;
		var odds_num      = f.OddsNum.value;
		var odds_denom    = f.OddsDenom.value;

		if (desc.length == 0) {
			add_err("Description cannot be empty");
		} else {
			if (!isSafeStr(desc)) {
				add_err("don't use these characters in descriptions: "
					+ "tab [ ] { } < > \" \\ $");
			}
		}
		if (group == "") {
			add_err("no market specified");
		}
		if (!isMoney(max_tot_stake, false)) {
			add_err("max total stake is invalid - must be a money quantity");
		}
		if ((min_bet.length > 0) && (!isMoney(min_bet, false))) {
			add_err("min bet is invalid - must be a money quantity");
		}
		if ((max_bet.length > 0) && (!isMoney(max_bet, false))) {
			add_err("max bet is invalid - must be a money quantity");
		}
		if ((min_bet.length > 0) && (max_bet.length > 0)) {
			if (isMoney(min_bet, false) && isMoney(max_bet, false)) {
				if (parseFloat(min_bet) > parseFloat(max_bet)) {
					add_err("min bet is bigger than max bet");
				}
			}
		}
		if (disporder.length > 0) {
			if (!isInt8(disporder, true)) {
				add_err("disporder must be an integer between +/-99999999");
			}
		}
		if (scheme == 'LP') {
			if (!isInt8(odds_num, false) || !isInt8(odds_denom, false)) {
				add_err("odds must be specified for live price");
			} else {
				if ((parseInt(odds_num) < 1) || (parseInt(odds_denom) < 1)) {
					add_err("odds num/denom must be positive integers");
				}
			}
		}
	}

	if (errorList != "") {
		alert("There are some errors in the form:\n\n" + errorList);
		return false;
	}

	return true;
}

/*
 * Function included to set cs_home and cs_away for a selection
 * of market sort TG or GC. These fields are used by Quick Result.
 */
function update_cs_fields()
{
	var home_obj = new getObj("OcCSHome");
	var away_obj = new getObj("OcCSAway");
	var flag = new getObj("OcFlag");
	t= flag.obj.options[flag.obj.selectedIndex].text

	var dash_index = t.indexOf("-");
	var plus_index = t.indexOf("+");

	if( dash_index != -1)
	{
		home_obj.obj.value = t.substring(0,dash_index);
		away_obj.obj.value = t.substring(dash_index+1,t.length);
	}
	else
	{
		home_obj.obj.value = t.substring(0,plus_index);
		away_obj.obj.value = "999";
	}
}

function write_oc_result(result)
{
	if (result == "W") {
		document.write("Win");
	} else if (result == "P") {
		document.write("Placed");
	} else if (result == "L") {
		document.write("Lose");
	} else if (result == "V") {
		document.write("Void");
	} else if (result == "H") {
		document.write("(Handicap Market)");
	} else if (result == "N") {
		document.write("(Continuous Win (See Market Screen))");
	} else {
		document.write("**Unknown**");
	}
}


function goSettle(id) {
	stl_url = "##TP_SettleUrl##?action=stl_seln&id=";
	loc = stl_url + id;

	if (confirm("** This operation is not reversible **\n\n" +
			"Please confirm that you want to settle this selection")) {
		alert("setting location to "+loc);
		this.location = loc;
	}
}
function fs(b,t)
{

	##TP_IF { [OT_CfgGet ENABLE_OVERROUND_WARNING  0 ] == 1 }##
	if (t == "SelnMod") {
		if (!checkOverround()) {
			return;
		}
	}
	##TP_ENDIF##

	b.disabled = true;
	b.value = "Busy...";
	b.form.SubmitName.value=t;
	b.form.submit();
	return true;
}
function TeamPlayerPopup()
{
	window.open("##TP_CGI_URL##?action=ADMIN::TEAMPLAYER::GoTeamPlayer&eventID=##TP_EvId##",
		"players",
		"toolbar=no,location=no,directories=no,menubar=no,resizable=yes,width=280,height=300");
}


function checkOverround() {

	//if adminuser is not allowed to modify price, do not warn if overround
	//drops below 100%
	//'cause then there's nothing they can do about it.
	##TP_IF {![op_allowed UpdEvOcPrice]}##
		return 1;
	##TP_ELSE##

		//if the selection is added, no need to warn for overround below 100%
	##TP_IF {[tpGetVar opAdd 0]}##
		return 1;
	##TP_ELSE##

	var price = document.forms['DoSel'].OcLP.value;
	
	// check current selection status
	// if Suspended then exclude the price from margin calculations
	var status = document.forms['DoSel'].OcStatus.value;
	if(status == 'S') {
		price = 0;
	} 
	
	var margin = calculateNewMargin(##TP_OcId##,price,mktOcs,mktOcInfos);

	if (parseFloat(margin) < 100 && market_active ) {
		var margin_disp = margin.toFixed(2);
		//QC 193 replace overround in the error msg by underround
		var bool = confirm( 'You are trying to modify a selection. That action will result in an underround of ' + margin_disp + '%. Do you wish to continue?');
		if (bool) {
			return 1;
		}
		else {
			document.forms['DoSel'].OcLP.value =  document.forms['DoSel'].OcLP.defaultValue;
			return 0;
		}
	} else {
		return 1;
	}

	##TP_ENDIF##

	##TP_ENDIF##

}

//
// UTILITY FUNCTION
//=============================================

function getObj(name)
{
  if (document.getElementById)
  {
        this.obj = document.getElementsByName(name).item(0);
  }
  else if (document.all)
  {
        this.obj = document.all[name];
  }
  else if (document.layers)
  {
        this.obj = getObjNN4(document,name);
  }
}

function go_form_feed ()
{
	var form_provider_id = document.DoSel.form_provider_id.value;

	if (form_provider_id == "") {
		return false;
	}

	document.location.href = '##TP_CGI_URL##?action=ADMIN::FORM::GoRunner&EvId=##TP_EvId##&OcId=##TP_OcId##&FormProviderId=' + form_provider_id;
}

</script>

##TP_IF {[tpGetVar opAdd 0]}##
	##TP_TCL {tpSetVar ResultSet 0}##
	##TP_TCL {tpSetVar Result    -}##
	##TP_TCL {tpSetVar Confirmed 0}##
##TP_ENDIF##

<body ##TP_IF {[tpGetVar MktSort] == "TG" || [tpGetVar MktSort] == "GC"}##onLoad="update_cs_fields();"##TP_ENDIF##>
##TP_PLAY error_rpt.html##
<form name="DoSel" method=get action="##TP_CGI_URL##" onSubmit="return validate(this);">
<input type="hidden" name="teamId" value="##TP_OcTeamId##">
<table border=0 cellspacing=0 cellpadding=3>
<tr>
	<th class=title colspan=2>
	##TP_IF {[tpGetVar Settled 0]}##
		Settled
	##TP_ELSE##
		##TP_IF {[tpGetVar ResultSet 0]}##
			##TP_IF {[tpGetVar Confirmed 0]}##
				<i>Selection has result confirmed, but is not settled.</i>
			##TP_ELSE##
				<i>Selection has result posted, but not confirmed.</i>
			##TP_ENDIF##
		##TP_ELSE##
			Modify Selection
		##TP_ENDIF##
	##TP_ENDIF##
	</th>
</tr>
##TP_IF {[tpGetVar FuncShowDDId 0] && ![tpGetVar opAdd 0]}##
	<tr>
		<td class="caption">Selection Identifier</td>
		<td>##TP_OcId##</td>
	</tr>
##TP_ENDIF##
<tr>
	<td class=caption>Description</td>
	<td>
	<input name="OcDesc" type="text" size="50" value="##TP_OcDesc##">
	##TP_IF {[OT_CfgGet FUNC_TEAM_PLAYER 0]}##
		##TP_IF {[tpGetVar ClassSort] == "FB" && [string first [tpGetVar MktSort] "FS/LS/CW/AG/HS"]>=0}##
			<input type=button class="btn_def" value="Players ..." onclick="TeamPlayerPopup()">
			<input type=hidden name="OcExtId" value="##TP_OcExtId##">
		##TP_ENDIF##
	##TP_ENDIF##
	<input type=button class="btn_def" value="Team ..." onclick="TeamEvOcPopup()">
	</td>
</tr>
##TP_IF {[string first SHORTCUT [OT_CfgGet FUNC_SELN_FIELDS ""]] >= 0}##
<tr>
	<td class=caption>Shortcut</td>
	<td>
		<input name="OcShortcut" type="text" size="2" value="##TP_OcShortcut##">
	</td>
</tr>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_GEN_OC_CODE 0] && ![tpGetVar opAdd 0]}##
<tr>
	<td class="caption">Code</td>
	<td><input name="OcCode" type="text" size="20" value="##TP_OcCode##"></td>
</tr>
##TP_ENDIF##

<tr>
	<td class=caption>Display order</td>
	<td align=left>
	<input name="OcDisporder" type="text" size=8 value="##TP_OcDisporder##">
	&nbsp;&nbsp;&nbsp;
	<b>Displayed</b>&nbsp;
	<select name="OcDisplayed">
	<script>
	write_select('##TP_OcDisplayed##','Y','Yes','N','No')
	</script>
	</select>
	##TP_IF {[string first [tpGetVar ClassSort] "GR"]>=0 || [string first [tpGetVar ClassSort] "HR"]>=0}##
		##TP_IF {[string first RUNNERNUM [OT_CfgGet FUNC_SELN_FIELDS ""]] >= 0}##
		&nbsp;&nbsp;&nbsp;
		<b>Runner Number</b>&nbsp;
		<input name="OcRunnerNum" type="text" size=2 value="##TP_OcRunnerNum##">
		##TP_ELSE##
		<input name="OcRunnerNum" type="hidden" value="##TP_OcRunnerNum##">
		##TP_ENDIF##
	##TP_ENDIF##
	</td>

</tr>
<tr>
	<td class=caption>Status</td>
	<td>
	##TP_IF {[tpGetVar ResultSet 0]}##
		Suspended (result set).
		<input type=hidden name=OcStatus value="##TP_OcStatus##">
	##TP_ELSE##
		<select name="OcStatus">
		<script>
		write_select('##TP_OcStatus##','A','Active','S','Suspended')
		</script>
		</select>
	##TP_ENDIF##
	##TP_IF {[string first EXTKEY [OT_CfgGet FUNC_SELN_FIELDS ""]] >= 0}##
		&nbsp;&nbsp;&nbsp;
		<b>External Link Key</b>&nbsp;
		##TP_IF {[tpGetVar ResultSet 0]}##
			##TP_OcExtKey##
			<input type=hidden name=OcExtKey size=10 value="##TP_OcExtKey##">
		##TP_ELSE##
			<input type=text name=OcExtKey size=10 value="##TP_OcExtKey##">
		##TP_ENDIF##
	##TP_ENDIF##
	##TP_IF {[string first RISKINFO [OT_CfgGet FUNC_SELN_FIELDS ""]] >= 0 && [tpGetVar NumRiskInfo] > 0}##
		&nbsp;&nbsp;&nbsp;
		<b>Risk Info</b>&nbsp;
		<select name="OcRiskInfo">
		<script>
		write_select('##TP_OcRiskInfo##'
				##TP_LOOP risk_idx {[tpGetVar NumRiskInfo]}##
					,"##TP_RiskVal##","##TP_RiskDesc##"
				##TP_ENDLOOP##
		)
		</script>
		</select>
	##TP_ELSE##
		<input type=hidden name=OcRiskInfo value="##TP_OcRiskInfo##">
	##TP_ENDIF##
	</td>
</tr>
<tr>
	<td class="caption">Accumulators</td>
	<td>
		<b>Min:</b>&nbsp;
		<input name="OcAccMin" type="text" size="2" value="##TP_OcAccMin##" />&nbsp;
		<i>(##TP_MktAccMin##)</i>
	</td>
</tr>
<tr>
	<td class=caption>Stake Limits</td>
	<td>
	<b><font color=#006666>Min:</font></b>&nbsp;
	##TP_IF {[tpGetVar ResultSet 0]}##
		##TP_OcMinBet##&nbsp;
		<input name=OcMinBet type=hidden value="##TP_OcMinBet##">
	##TP_ELSE##
		<input name=OcMinBet type=text size=12 value="##TP_OcMinBet##">
		##TP_IF {[OT_CfgGet DISPLAY_HIERARCHY_STAKE_LIMITS 0] == 1}##
			<i>&nbsp;(##TP_MinBet##)</i>
		##TP_ENDIF##
	##TP_ENDIF##
	&nbsp;&nbsp;&nbsp;&nbsp;
	##TP_IF {[OT_CfgGet FUNC_LAY_TO_LOSE] != 1}##
		<b><font color=#006666>##TP_IF {[OT_CfgGet FUNC_VARIABLE_MAX_STAKES_BY_TIME 0] && ([lsearch [OT_CfgGet VAR_MAX_STAKE_CLASSES ""] [tpGetVar ClassId]] != -1)}##Standard ##TP_ENDIF##Max:</font></b>&nbsp;
		##TP_IF {[tpGetVar ResultSet 0]}##
			##TP_OcMaxBet##&nbsp;
			<input name=OcMaxBet type=hidden value="##TP_OcMaxBet##">
		##TP_ELSE##
			<input name=OcMaxBet type=text size=12 value="##TP_OcMaxBet##">
			##TP_IF {[OT_CfgGet DISPLAY_HIERARCHY_STAKE_LIMITS 0] == 1}##
				<i>&nbsp;(##TP_MaxBet##)</i>
			##TP_ENDIF##
		##TP_ENDIF##
		<br />
		##TP_IF {[OT_CfgGet FUNC_VARIABLE_MAX_STAKES 0] && ([lsearch [OT_CfgGet VAR_MAX_STAKE_CLASSES ""] [tpGetVar ClassId]] != -1)}##
			<b><font color="#006666">##TP_IF {[OT_CfgGet FUNC_VARIABLE_MAX_STAKES_BY_TIME 0]}##Standard ##TP_ENDIF##Max SP:</font></b>&nbsp;
			##TP_IF {[tpGetVar ResultSet 0]}##
				##TP_OcSpMaxBet##&nbsp;
				<input name="OcSpMaxBet" type="hidden" value="##TP_OcSpMaxBet##" />
			##TP_ELSE##
				<input name="OcSpMaxBet" type="text" size="12" value="##TP_OcSpMaxBet##" />
			##TP_ENDIF##
			<br />
			##TP_IF { [lsearch [OT_CfgGet EP_AVAILABLE_CLASSES "GREYHOUNDS HORSE_RACING"] [tpGetVar Category]] != -1}##
				<b>Max EP:</b>&nbsp;
				##TP_IF {[tpGetVar ResultSet 0]}##
					##TP_OcEpMaxBet##&nbsp;
					<input name="OcEpMaxBet" type="hidden" value="##TP_OcEpMaxBet##" />
				##TP_ELSE##
					<input name="OcEpMaxBet" type="text" size="12" value="##TP_OcEpMaxBet##" />
				##TP_ENDIF##
				<br />
			##TP_ENDIF##
			##TP_IF {[OT_CfgGet FUNC_VARIABLE_MAX_STAKES_BY_TIME 0]}##
				NB: MAX STAKES FOR THIS EVENT WILL VARY ACCORDING TO TIME AND PRICE
			##TP_ENDIF##
		##TP_ENDIF##
	##TP_ENDIF##
	<br />
	##TP_IF {[OT_CfgGet FUNC_MAX_WIN_MULTIPLES 0]}##
		<font color=#006666>Max Multiple Bet:</font>&nbsp;
		<input name="OcMaxMultipleBet" type="text" value="##TP_OcMaxMultipleBet##" size=12>&nbsp;<i>##TP_FinalMaxMultipleBet##</i>
	##TP_ELSE##
		<input name="OcMaxMultipleBet" type="hidden" value="##TP_OcMaxMultipleBet##">
	##TP_ENDIF##
	</td>
</tr>
##TP_IF {[OT_CfgGet FUNC_LAY_TO_LOSE 0]}##
<tr><td class=caption>Max Bet (LP):</td>
	  <td>
	  ##TP_IF {[tpGetVar ResultSet 0]}##
        ##TP_OcMaxBetLP##&nbsp;
        <input name="OcMaxBet" type=hidden value="##TP_OcMaxBet##">
      ##TP_ELSE##
				##TP_IF {[tpBindGet DisableMaxWin] == "DISABLED"}##
					<input name="OcMaxBet" type=hidden value="##TP_OcMaxBet##">
				##TP_ENDIF##
        <input name="OcMaxBet" type=text size=12 value="##TP_OcMaxBet##" ##TP_DisableMaxWin##>
      ##TP_ENDIF##
      <b>Max Bet (SP):</b>&nbsp;
      ##TP_IF {[tpGetVar ResultSet 0]}##
        ##TP_OcSpMaxBet##&nbsp;
        <input name="OcSpMaxBet" type=hidden value="##TP_OcSpMaxBet##">
      ##TP_ELSE##
				##TP_IF {[tpBindGet DisableMaxWin] == "DISABLED"}##
					<input name="OcSpMaxBet" type=hidden value="##TP_OcSpMaxBet##">
				##TP_ENDIF##
        <input name="OcSpMaxBet" type=text size=12 value="##TP_OcSpMaxBet##" ##TP_DisableMaxWin##>
      ##TP_ENDIF##
      ##TP_IF { [lsearch [OT_CfgGet EP_AVAILABLE_CLASSES "GREYHOUNDS HORSE_RACING"] [tpGetVar Category]] != -1}##
      	<b>Max Bet (EP):</b>&nbsp;
      	##TP_IF {[tpGetVar ResultSet 0]}##
        	##TP_OcEpMaxBet##&nbsp;
        	<input name="OcEpMaxBet" type=hidden value="##TP_OcEpMaxBet##">
      	##TP_ELSE##
				##TP_IF {[tpBindGet DisableMaxWin] == "DISABLED"}##
					<input name="OcEpMaxBet" type=hidden value="##TP_OcEpMaxBet##">
				##TP_ENDIF##
        <input name="OcEpMaxBet" type=text size=12 value="##TP_OcEpMaxBet##" ##TP_DisableMaxWin##>
      	##TP_ENDIF##
      ##TP_ENDIF##
	  &nbsp;&nbsp; <b>Lock WIN:</b>&nbsp;<input type="checkbox" id="lock_win_stake_limits" name="lock_win_stake_limits" ##TP_LOCK_WIN_STAKE_LIMITS## ##TP_IF {[tpGetVar ResultSet 0]}##disabled##TP_ENDIF##>&nbsp;
      </td>
</tr>
<tr><td class=caption>Max Place (LP):</td>
	  <td>
	  ##TP_IF {[tpGetVar ResultSet 0]}##
        ##TP_OcMaxPlaceLP##&nbsp;
        <input name="OcMaxPlaceLP" type=hidden value="##TP_OcMaxPlaceLP##">
      ##TP_ELSE##
				##TP_IF {[tpBindGet DisableMaxPlace] == "DISABLED"}##
					<input name="OcMaxPlaceLP" type=hidden value="##TP_OcMaxPlaceLP##">
				##TP_ENDIF##
        <input name="OcMaxPlaceLP" type=text size=12 value="##TP_OcMaxPlaceLP##" ##TP_DisableMaxPlace##>
      ##TP_ENDIF##
      <b>Max Place (SP):</b>&nbsp;
      ##TP_IF {[tpGetVar ResultSet 0]}##
        ##TP_OcMaxPlaceSP##&nbsp;
        <input name="OcMaxPlaceSP" type=hidden value="##TP_OcMaxPlaceSP##">
      ##TP_ELSE##
				##TP_IF {[tpBindGet DisableMaxPlace] == "DISABLED"}##
					<input name="OcMaxPlaceSP" type=hidden value="##TP_OcMaxPlaceSP##">
				##TP_ENDIF##
        <input name="OcMaxPlaceSP" type=text size=12 value="##TP_OcMaxPlaceSP##" ##TP_DisableMaxPlace##>
      ##TP_ENDIF##
      ##TP_IF { [lsearch [OT_CfgGet EP_AVAILABLE_CLASSES "GREYHOUNDS HORSE_RACING"] [tpGetVar Category]] != -1}##
      	<b>Max Place (EP):</b>&nbsp;
      	##TP_IF {[tpGetVar ResultSet 0]}##
        	##TP_OcMaxPlaceEP##&nbsp;
        	<input name="OcMaxPlaceEP" type=hidden value="##TP_OcMaxPlaceEP##">
      	##TP_ELSE##
				##TP_IF {[tpBindGet DisableMaxPlace] == "DISABLED"}##
					<input name="OcMaxPlaceEP" type=hidden value="##TP_OcMaxPlaceEP##">
				##TP_ENDIF##
        	<input name="OcMaxPlaceEP" type=text size=12 value="##TP_OcMaxPlaceEP##" ##TP_DisableMaxPlace##>
      	##TP_ENDIF##
      ##TP_ENDIF##
	  &nbsp;&nbsp; <b>Lock PLACE:</b>&nbsp; <input type="checkbox" id="lock_place_stake_limits" name="lock_place_stake_limits" ##TP_LOCK_PLACE_STAKE_LIMITS## ##TP_IF {[tpGetVar ResultSet 0]}##disabled##TP_ENDIF##>&nbsp;
      </td>
</tr>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_FCTC_STK_LIMITS 0]}##
<tr>
    <td class=caption>Forecast Stake Limit</td>
    <td><input type=text size=4 name=fc_stk_limit value="##TP_FcStkLimit##">
	&nbsp;&nbsp;&nbsp;<b>Tricast Stake Limit</b>
	<input type=text size=8 name=tc_stk_limit value="##TP_TcStkLimit##"></td>
</tr>
##TP_ENDIF##
##TP_IF {[OT_CfgGet EW_FACTOR 0]}##
##TP_IF {[string first [tpGetVar ClassSort] "HR/GR"]>=0}##
<tr>
	<td class=caption>E/W Factor</td>
	<td>
	 ##TP_IF {[tpGetVar ResultSet 0]}##
			 ##TP_OcEWFactor##&nbsp;
			 <input name=OcEWFactor type=hidden value="##TP_OcEWFactor##">
	 ##TP_ELSE##
			 <input name=OcEWFactor type=text size=12 value="##TP_OcEWFactor##">
	 ##TP_ENDIF##
	</td>
</tr>
##TP_ENDIF##
##TP_ENDIF##
##TP_IF {[OT_CfgGet FUNC_MAX_WIN 0]}##
<tr>
	<td />
	<td>
	<b><font color=#006666>Max Potential Win:</font></b>&nbsp;
	##TP_IF {[tpGetVar ResultSet 0]}##
		##TP_OcMaxPotWin##&nbsp;
		<input name=OcMaxPotWin type=hidden value="##TP_OcMaxPotWin##">
	##TP_ELSE##
		<input name=OcMaxPotWin type=text size=12 value="##TP_OcMaxPotWin##">
	##TP_ENDIF##
	</td>
</tr>
##TP_ELSE##
  <input name="OcMaxPotWin" type="hidden" value="##TP_OcMaxPotWin##" />
##TP_ENDIF##


<tr>
	##TP_IF {[OT_CfgGet FUNC_EVOC_FIXED_STAKE_LMTS 0]}##
	<td class="caption">Fixed Stake Limits</td>
	<td>Stake Limits on the Internet will be independent from stake factors and bet type limits. Use with care!<input type="checkbox" name="fixed_stake_limits" ##TP_IF {[tpBindGet OcFixedStake] == "1"}## checked ##TP_ENDIF##></td>
	##TP_ENDIF##
</tr>

<!-- Non-handicap markets have option on flipping price at stake or -->
<!-- liability, handicap markets flip on liability -->
##TP_IF {[string first [tpGetVar MktType] "AHMSCULl"] < 0}##
	<tr>
		<td class=caption>Max total</td>
		<td>
		##TP_IF {[tpGetVar ResultSet 0]}##
			##TP_OcMaxTotal##  (current total ##TP_OcCurTotal##)
			<input type=hidden name=OcStkOrLbt value="##TP_OcStkOrLbt##">
			<input type=hidden name=OcMaxTotal value="##TP_OcMaxTotal##">
		##TP_ELSE##
			##TP_IF {[string first [tpGetVar MktType] "AHM"]<0}##
				##TP_IF {[tpGetVar opAdd 0]}##
					<select name="OcStkOrLbt">
					<script>
					write_select('L','S','Stake','L','Liability')
					</script>
					</select>
				##TP_ELSE##
					<script>
					write_which('##TP_OcStkOrLbt##','S','Stake','L','Liability')
					</script>
					<input type="hidden" name="OcStkOrLbt" value="##TP_OcStkOrLbt##">
				##TP_ENDIF##
			##TP_ELSE##
				<b>Liability</b>
				<input type=hidden name=OcStkOrLbt value=L>
			##TP_ENDIF##
			<input type=text name=OcMaxTotal size=12 value="##TP_OcMaxTotal##">
			##TP_IF {![tpGetVar opAdd 0]}##
				##TP_IF {[tpBindGet OcStkOrLbt] == "L"}##
					&nbsp;<b>(current liability ##TP_OcCurLiab##)</b>
				##TP_ELSE##
					&nbsp;<b>(current total ##TP_OcCurTotal##)</b>
				##TP_ENDIF##
			##TP_ENDIF##
		##TP_ENDIF##
		</td>
	</tr>
##TP_ELSE##
	<tr>
		<td class=caption>Price change at</td>
		<td align=left>
		<input type=hidden name=OcStkOrLbt value="L">&nbsp;<b>liability</b>
		##TP_IF {[tpGetVar ResultSet 0]}##
			##TP_IF {[tpBindGet OcStkOrLbt] == "L"}##
					&nbsp;<b>(current liability ##TP_OcCurLiab##)</b>
				##TP_ELSE##
					##TP_OcMaxTotal##  (current total ##TP_OcCurTotal##)
				##TP_ENDIF##
			<input type=hidden name=OcMaxTotal value="##TP_OcMaxTotal##">
		##TP_ELSE##
			<input type=text name=OcMaxTotal size=10 value="##TP_OcMaxTotal##">
			##TP_IF {![tpGetVar opAdd 0]}##
				##TP_IF {[tpBindGet OcStkOrLbt] == "L"}##
					&nbsp;<b>(current liability ##TP_OcCurLiab##)</b>
				##TP_ELSE##
					&nbsp;<b>(current total ##TP_OcCurTotal##)</b>
				##TP_ENDIF##
			##TP_ENDIF##
		##TP_ENDIF##
		</td>
	</tr>
##TP_ENDIF##

##TP_IF {[tpGetVar ResultSet 0] && [tpGetVar SP_Avail 0]}##
	<tr>
		<td class=caption>Starting Price</td>
		<td>
		##TP_IF {[string first [tpGetVar Result] "WP"] >= 0}##
			&nbsp;##TP_OcSP##
		##TP_ELSE##
			<i>(price only set for a win or a place)</i>
		##TP_ENDIF##
		</td>
	</tr>
##TP_ENDIF##

##TP_IF {[tpGetVar NumMktFlags 0]>0}##
	<tr>
		<td class=caption>&nbsp;</td>
		<td>
		##TP_IF {[tpGetVar ResultSet 0]}##
			<script>
			write_which('##TP_OcFlag##'
				,'-','unset'
				##TP_LOOP flag_idx {[tpGetVar NumMktFlags]}##
					,"##TP_FlagVal##","##TP_FlagDesc##"
				##TP_ENDLOOP##
			)
			</script>
			##TP_IF {[ADMIN::MKTPROPS::mkt_flag [tpGetVar ClassSort] [tpGetVar MktSort] use_cs 0]}##
				&nbsp;
				Score (H-A)
				##TP_OcCSHome##&nbsp;##TP_OcCSAway##
			##TP_ENDIF##
			<input type=hidden name=OcFlag   value="##TP_OcFlag##">
			<input type=hidden name OcCSHome value="##TP_OcCSHome##">
			<input type=hidden name OcCSHome value="##TP_OcCSAway##">
		##TP_ELSE##
			<select name="OcFlag" ##TP_IF {[tpGetVar MktSort] == "TG" || [tpGetVar MktSort] == "GC"}##onChange="update_cs_fields();"##TP_ENDIF##>
			<script>
			write_select('##TP_OcFlag##'
				##TP_LOOP flag_idx {[tpGetVar NumMktFlags]}##
					,"##TP_FlagVal##","##TP_FlagDesc##"
				##TP_ENDLOOP##
			)
			</script>
			</select>
			##TP_IF {[ADMIN::MKTPROPS::mkt_flag [tpGetVar ClassSort] [tpGetVar MktSort] use_cs 0]}##
				&nbsp;
				Score (H-A)
				<input type=text name=OcCSHome size=3 value="##TP_OcCSHome##">&nbsp;
				<input type=text name=OcCSAway size=3 value="##TP_OcCSAway##">
			##TP_ELSE##
				<input type="hidden" name="OcCSHome" value="##TP_OcCSHome##">
				<input type="hidden" name="OcCSAway" value="##TP_OcCSAway##">
			##TP_ENDIF##
		##TP_ENDIF##
		</td>
	</tr>
##TP_ENDIF##

<!-- no need to show MultKey for AH market - SGLs only -->

##TP_IF {[string first [tpGetVar MktType] "ASC"] < 0}##
	##TP_IF {[tpGetVar ResultSet 0]}##
		<input type=hidden name=OcMultKey value="##TP_OcMultKey##">
	##TP_ELSE##
		<tr>
			<td class=caption>Multiples key</td>
			<td>
			<input type="text" name="OcMultKey" value="##TP_OcMultKey##" size="16" maxlength="16">
			&nbsp;&nbsp;
			<i>(used to stop related outcomes in multiples)</i>
			</td>
		</tr>
	##TP_ENDIF##
##TP_ELSE##
	<input type=hidden name=OcMultKey value="">
	<input type=hidden name=APCPrcLo value="##TP_APCPrcLo##">
	<input type=hidden name=APCPrcHi value="##TP_APCPrcHi##">
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_DISPLAY_GROUPING 0]}##
<tr>
	<td class="caption">Selection Link Key</td>
	<td>
		<input type="text" name="OcSelLinkKey" value="##TP_OcSelLinkKey##" size="16" maxlength="16" \>
		<i>(used to indicate 2 selections can be displayed together on a webpage)</i>
		##TP_IF {[tpGetVar MktGrouped]=="N"}##
			<br><i><b>The market is currently not a multi-market</b></i>
		##TP_ENDIF##
	</td>
<tr>
##TP_ELSE##
	<input type=hidden name="OcSelLinkKey" value="##TP_OcSelLinkKey##">
##TP_ENDIF##

<tr>
	<td class=caption>Priced By Feed</td>
	<td>
		<select name="PricedByFeed">
		<script>
			write_select('##TP_PricedByFeed##','Y','Yes','N','No')
		</script>
		</select>
	</td>
</tr>
<tr>
	<td class=caption>Price</td>
	<td>
	##TP_IF {[tpGetVar LP_Avail 0]}##
		<b>Fixed:</b>
		##TP_IF {[tpGetVar ResultSet 0]}##
			##TP_OcLP##
			<input type=hidden name=OcLP value="##TP_OcLP##">
		##TP_ELSE##
			##TP_IF {[op_allowed UpdEvOcPrice]}##
				<input name=OcLP type=text size=8 value="##TP_OcLP##" id="OcLPField">
				&nbsp;&nbsp;
				<script type="text/javascript">
					function forceRemovalHandler(_element) {
						if (_element.checked == true) {
							confirmMessage = "Warning, this will remove the price from this selection.\n"
								+"This action must be performed both offshore and onshore.\n\n"
								+"Are you sure you want to do this?";
							if (confirm (confirmMessage) == false) {
								_element.checked = false;
							}
						}
						lpField = document.getElementById("OcLPField");
						lpField.disabled = _element.checked;
					}
				</script>
				Force removal of price: <input onclick="forceRemovalHandler(this);" type="checkbox" name="null_price">
			##TP_ELSE##
				##TP_OcLP##
			##TP_ENDIF##
		##TP_ENDIF##
		&nbsp;&nbsp;&nbsp;&nbsp;
	##TP_ELSE##
		<input type=hidden name=OcLP value="">
	##TP_ENDIF##
	##TP_IF {[tpGetVar SP_Avail 0]}##
		##TP_IF {[tpGetVar ResultSet 0]}##
			SP
			<input name=OcSPGuide type=hidden value="##TP_OcSPGuide##">
		##TP_ELSE##
			<b>SP Guide:</b>
			<input name=OcSPGuide type=text size=8 value="##TP_OcSPGuide##">
		##TP_ENDIF##
	##TP_ELSE##
		<input type=hidden name=OcSPGuide value="">
	##TP_ENDIF##
	##TP_IF {[string first [tpGetVar ClassSort] "HR/GR"] >= 0}##
		 &nbsp;&nbsp;&nbsp;<b>Feed updateable</b>
		<select name=OcFeedUpdateable>
		<script>
		write_select('##TP_OcFeedUpd##','-','N/A','Y','Yes','N','No')
		</script>
		</select>
	##TP_ELSE##
		<input type=hidden name=OcFeedUpdateable value="-">
	##TP_ENDIF##
	</td>
</tr>

##TP_IF {[OT_CfgGet FUNC_CHANNELS 0]}##
	<tr>
		<td class=caption>Channels</td>
		<td class="table">
		##TP_PLAY chan_sel.html##
		</td>
	</tr>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_TRAD_GUIDS 0]}##
	<tr>
		<td class="caption">Request GUID</td>
		##TP_IF {[tpBindGet ReqGUID] != ""}##
		<td>##TP_ReqGUID##</td>
		##TP_ELSE##
		<td>N/A</td>
		##TP_ENDIF##
	</tr>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_TEAM_TALK 0] && [tpGetVar ClassSort] == "HR" && ![tpGetVar opAdd 0]}##
	<tr>
		<td class=caption>Team Talk</td>
		<td>
			<a href="##TP_CGI_URL##?action=ADMIN::TEAMTALK::GoRide&EvId=##TP_EvId##&OcId=##TP_OcId##">Edit Ride Information</a>
		</td>
	</tr>
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_FORM_FEEDS 0] && [tpGetVar ClassSort] == "HR" && ![tpGetVar opAdd 0]}##
	<tr>
		<td class=caption>Form Feed Data</td>
		<td>
			<select name="form_provider_id">
				<script>
					write_select("",
						"","Select Form Feed provider"
						##TP_LOOP form_idx {[tpGetVar NumFormProviders]}##
						,"##TP_FORM_PROVIDER_ID##","##TP_FORM_PROVIDER_NAME##"
						##TP_ENDLOOP##
					);
				</script>
			</select>
			<input type="button" name="form_provider_button" value="Go" onClick="javascript:go_form_feed()">
		</td>
	</tr>
##TP_ENDIF##

##TP_IF {![tpGetVar opAdd 0] && [OT_CfgGet BF_ACTIVE 0]}##
	##TP_PLAY bf_selection.html##
##TP_ENDIF##

##TP_IF {[OT_CfgGet FUNC_SELECTION_MSG 0] && [op_allowed ManageSelectionMsg]}##
	<tr>
		<td class=caption>Message</td>
		<td>
			<textarea cols=50 rows=2 wrap=virtual name="OcSelMsg">##TP_OcSelMsg##</textarea><br>
			<i>(Only 100 characters are stored)</i>
			<br/>
		</td>
	</tr>
##TP_ENDIF##

<input type="hidden" name="EvId" value="##TP_EvId##">
<input type="hidden" name="MktId" value="##TP_MktId##">
<input type="hidden" name="OcId" value="##TP_OcId##">
<input type="hidden" name="MktType" value="##TP_MktType##">
<input type="hidden" name="MktSort" value="##TP_MktSort##">
<input type="hidden" name="ClassSort" value="##TP_ClassSort##">

<tr>
	<th colspan=2 class=buttons>
	<table border=0 cellspacing=0 cellpadding=0 width=100%>
	<tr>
		<th class=buttons colspan=2>
		##TP_IF {[op_allowed ManageEvOc]}##
			##TP_IF {[tpGetVar opAdd 0]}##
				##TP_IF {[tpGetVar AllowDDCreation 0]}##
				<input type=button class="btn_def" value="Add Selection" onClick="return fs(this,'SelnAdd')">
				##TP_ENDIF##
			##TP_ELSE##
				<input type=button class="btn_def" value="Modify Selection" onClick="fs(this,'SelnMod');">
				##TP_IF {[tpGetVar AllowDDDeletion 0]}##
				<input type=button class="btn_def" value="Delete Selection" onClick="return fs(this,'SelnDel')">
				##TP_ENDIF##
			##TP_ENDIF##
		##TP_ENDIF##

		<input type=hidden name=ClassId     value="##TP_ClassId##">
		<input type=hidden name=type_id     value="##TP_type_id##">
		<input type=hidden name=date_range  value="##TP_date_range##">
		<input type=hidden name=date_lo     value="##TP_date_lo##">
		<input type=hidden name=date_hi     value="##TP_date_hi##">
		<input type=hidden name=settled     value="##TP_settled##">
		<input type=hidden name=result_conf value="##TP_result_conf##">
		<input type=hidden name=status      value="##TP_status##">
		<input type=hidden name=allow_stl   value="##TP_allow_stl##">

		<input type=button class="btn_def" value="Back" onClick="return fs(this,'Back')">
		</th>
		##TP_IF {![tpGetVar opAdd 0]}##
			##TP_IF {[tpGetVar PERM_ViewAudit 0]}##

				<th class=goaudit width=25%>
				<input type=button class="btn_def" value="View Audit History" onClick="return fs(this,'GoAudit')">
				<input type=hidden name=AuditInfo value="EvOc" id="AuditInfo">
				##TP_IF {[tpBindGet OcHasVariant] == "Y"}##
					<br/>
					<input type="button" class="btn_def" value="View Teaser History" onClick="document.getElementById('AuditInfo').value='EvOcVariantByOc';return fs(this,'GoAudit')">
				##TP_ENDIF##
				</th>
			##TP_ENDIF##
		##TP_ENDIF##
	</tr>
	</table>
	</th>
</tr>
</table>

##TP_IF {![tpGetVar opAdd 0]}##
	##TP_IF {[tpGetVar DblResNum] == 2}##
		<input type="hidden" name="DblResForce" value="1">
	##TP_ENDIF##
	<table border="0" cellspacing="1" cellpadding="1">
		<tr>
			<th class="title" colspan="##TP_ResColSpan##">
				Result/Settlement
			</th>
		</tr>

		##TP_IF {![tpGetVar Settled 0] && ![tpGetVar Confirmed 0] && ([tpGetVar MktType] == "N")}##
			<tr class="caption">
				<td>
					<b>Set results for BIR markets on the market screen</b>
				</td>
			</tr>
		##TP_ELSE##
			<tr>
				##TP_IF {[tpBindGet DblRes] == "Y"}##
					<th class="colhead" colspan="2">Double Resulting</th>
				##TP_ENDIF##
				<th class="colhead" rowspan="##TP_ResRowSpan##">
					Result
				</th>
				##TP_IF {[string first [tpGetVar MktType] "AHM"] >= 0 &&  [tpGetVar Flag] != "L"}##
					<th class="colhead" rowspan="##TP_ResRowSpan##">
						Score
					</th>
				##TP_ELSEIF {[string first [tpGetVar MktType] "LUSC"] == -1 && [tpGetVar MktCanPlace 1]}##
					<th class="colhead" rowspan="##TP_ResRowSpan##">
						Place Number
					</th>
				##TP_ENDIF##
				##TP_IF {![tpGetVar Settled 0] && ![tpGetVar Confirmed 0]}##
					##TP_IF {[tpGetVar SP_Avail 0]}##
						<th class="colhead" rowspan="##TP_ResRowSpan##">
							Starting Price
						</th>
					##TP_ENDIF##
				##TP_ENDIF##
			</tr>
			##TP_IF {[tpBindGet DblRes] == "Y"}##
				<tr>
					<th class="colhead">Type</th>
					<th class="colhead">By</th>
				</tr>
			##TP_ENDIF##

			##TP_IF {[tpGetVar Settled 0] || [tpGetVar Confirmed 0]}##
				##TP_IF {[tpGetVar Settled 0]}##
					<tr class="settled">
				##TP_ELSE##
					<tr class="confirmed">
				##TP_ENDIF##
				##TP_IF {[tpBindGet DblRes] == "Y"}##
					<td>
						##TP_DblType##
					</td>
					<td>
						##TP_DblUser##
					</td>
				##TP_ENDIF##
				<td>
					<script>
						write_oc_result("##TP_OcResult##");
					</script>
				</td>
				##TP_IF {[string first [tpGetVar MktType] "AHM"] >= 0 &&  [tpGetVar Flag] != "L"}##
					<td>
						##TP_OcHcapScore##
					</td>
				##TP_ELSEIF {[string first [tpGetVar MktType] "LUSC"] == -1 && [tpGetVar MktCanPlace 1]}##
					<td>
						##TP_OcPlace##
					</td>
				##TP_ENDIF##
				</tr>
			##TP_ELSE##
				<tr>
					##TP_IF {[tpBindGet DblRes] == "Y"}##
						<td>
							##TP_DblType##
						</td>
						<td>
							##TP_DblUser##
						</td>
					##TP_ENDIF##
					<td>
						<!-- Show results on offer -->
						<select name="OcResult">
							<script>
								write_select('##TP_OcResult##'
									##TP_LOOP result_idx {[tpGetVar NumMktResults]}##
										,"##TP_ResultVal##","##TP_ResultDesc##"
									##TP_ENDLOOP##
								);
							</script>
						</select>
					</td>
					##TP_IF {[string first [tpGetVar MktType] "AHM"] >= 0 &&  [tpGetVar Flag] != "L"}##
						<td>
							<input type="text" name="OcHcapScore" value="##TP_OcHcapScore##" size="5">
						</td>
					##TP_ELSEIF {[string first [tpGetVar MktType] "LUSC"] == -1 && [tpGetVar MktCanPlace 1]}##
						<td>
							<input type="text" name="OcPlace" value="##TP_OcPlace##" size="3">
						</td>
					##TP_ENDIF##
					##TP_IF {[tpGetVar SP_Avail 0]}##
						<td>
							<input type=text name="OcSP" size=4 value="##TP_OcSP##">
						</td>
					##TP_ELSE##
						<input type=hidden name=OcSP value="##TP_OcSP##">
					##TP_ENDIF##
				</tr>
			##TP_ENDIF##

			##TP_LOOP dbl_idx {[tpGetVar DblResNum]}##
				<tr>
					<td>
						##TP_DBL_dbl_type##
					</td>
					<td>
						##TP_DBL_dbl_user##
					</td>
					<td ##TP_IF {[tpGetVar DBL_highlight_result]}## class="dbl_res_mismatch" ##TP_ENDIF##>
						##TP_IF {[tpBindGet DBL_dbl_mask] == 1}##
							##TP_DBL_result##
						##TP_ELSE##
							<script>
								write_oc_result("##TP_DBL_result##");
							</script>
						##TP_ENDIF##
					</td>
					##TP_IF {[string first [tpGetVar MktType] "AHM"] >= 0 &&  [tpGetVar Flag] != "L"}##
						<td ##TP_IF {[tpGetVar DBL_highlight_hcap_score]}## class="dbl_res_mismatch" ##TP_ENDIF##>
							##TP_IF {[tpBindGet DBL_hcap_score] == ""}##
								-
							##TP_ELSE##
								##TP_DBL_hcap_score##
							##TP_ENDIF##
						</td>
					##TP_ELSEIF {[string first [tpGetVar MktType] "LUSC"] == -1 && [tpGetVar MktCanPlace 1]}##
						<td ##TP_IF {[tpGetVar DBL_highlight_place]}## class="dbl_res_mismatch" ##TP_ENDIF##>
							##TP_IF {[tpBindGet DBL_place] == ""}##
								-
							##TP_ELSE##
								##TP_DBL_place##
							##TP_ENDIF##
						</td>
					##TP_ENDIF##
					##TP_IF {![tpGetVar Settled 0] && ![tpGetVar Confirmed 0]}##
						##TP_IF {[tpGetVar SP_Avail 0]}##
							<td ##TP_IF {[tpGetVar DBL_highlight_sp]}## class="dbl_res_mismatch" ##TP_ENDIF##>
								##TP_DBL_sp##
							</td>
						##TP_ENDIF##
					##TP_ENDIF##
				</tr>
			##TP_ENDLOOP##

			##TP_IF {[tpGetVar Settled 0]}## <!-- Settled -->
				##TP_IF {[OT_CfgGet FUNC_STL_CHK 0] && [op_allowed SettleCheck]}##
					<tr>
						<th class="title" colspan="##TP_ResColSpan##">
							<input type="button" class="btn_def" value="Mark Selection for Settle Check" onClick="return fs(this,'SelnSettleChk')">
						</th>
					</tr>
				##TP_ENDIF##
				##TP_IF {[tpGetVar UseDHRedn] == "Y"}##
					<tr>
						<th class="title" colspan="##TP_ResColSpan##">
							<input type="button" class="btn_def" value="View Deadheat Redns" onClick="return fs(this,'ViewDHRedns')">
						</th>
					</tr>
				##TP_ENDIF##
				##TP_IF {[op_allowed ReSettle]}##
					##TP_IF {[tpGetVar EvAllowSettle]=="Y"} ##
						<tr>
						<th class="title" colspan="##TP_ResColSpan##">
							<input type="button" class="btn_def" value="Re-Settle Selection" onClick="return fs(this,'SelnReStl')">
							<input type="hidden" name="DoSettle" value=Y>
						</th>
						</tr>
					##TP_ENDIF##
				##TP_ENDIF##

			##TP_ELSEIF {[tpGetVar Confirmed 0]}##<!-- Confirmed -->
				<tr class="confirmed">
					<th align="left" colspan="##TP_ResColSpan##">
					##TP_IF {![op_allowed ConfirmResults Settle]}##
						<i>Selection is not settled</i>
					##TP_ELSE##
						##TP_IF {[op_allowed Settle]}##
							##TP_IF {[tpGetVar EvAllowSettle]=="Y"} ##
								<input type="button" class="btn_def"  value="Settle Selection" onClick="return fs(this,'SelnStl')">
								<input type="hidden" name="DoSettle" value="Y">
							##TP_ENDIF##
						##TP_ENDIF##
						##TP_IF {([op_allowed ConfirmResults]) && ([tpGetVar MktType] != "N")}##
							<input type="button" class="btn_def"  value="Unconfirm Selection Result" onClick="return fs(this,'SelnUnconf')">
						##TP_ENDIF##
					##TP_ENDIF##
					</th>
				</tr>
			##TP_ELSE## <!-- Unconfirmed -->
				<tr>
					<th class="buttons" colspan="##TP_ResColSpan##">
					##TP_IF {![op_allowed SetResults ConfirmResults]}##
						##TP_IF {[tpGetVar ResultSet]}##
							<i>Result not confirmed</i>
						##TP_ELSE##
							<i>Result not set</i>
						##TP_ENDIF##
					##TP_ELSE##
						##TP_IF {[op_allowed SetResults]}##
							<input type="button" class="btn_def" value="Set Selection Result" onClick="return fs(this,'SelnSetRes')">
						##TP_ENDIF##
						&nbsp;&nbsp;&nbsp;
						##TP_IF {[op_allowed ConfirmResults]}##
							##TP_IF {[tpGetVar Result -] != "-"}##
								<input type="button" class="btn_def" value="Confirm Selection Result" onClick="return fs(this,'SelnConf')">
							##TP_ENDIF##
						##TP_ENDIF## <!-- result != "-" -->
					##TP_ENDIF##
					##TP_IF {[tpGetVar UseDHRedn] == "Y"}##
							<input type=button class="btn_def" value="View Deadheat Redns" onClick="return fs(this,'ViewDHRedns')">
					##TP_ENDIF##
					</th>
				</tr>
			##TP_ENDIF##
		##TP_ENDIF##
	</table>
##TP_ENDIF## <!-- opAdd -->


<input type=hidden name=SubmitName value="">
<input type=hidden name=action value=ADMIN::SELN::DoOc>
</form>


##TP_IF {[tpGetVar ShowPriceSet "N"] == "Y"}##
<table cellpadding=2 cellspacing=1 border=0>
        <tr>
			<th class=infono colspan=3>
			Please check that the appropriate show prices are set.
			</th>
		</tr>
        <br>
</table>
##TP_ENDIF##

##TP_IF {![tpGetVar opAdd 0]}##
	##TP_IF {[tpGetVar LP_Avail 0]}##
		<br>
		<table cellpadding=2 cellspacing=1 border=0>
		<tr>
			<th class=title colspan=3>
			Price History.
			</th>
		</tr>
		<tr>
			<th class=colhead>Created</th>
			<th class=colhead>Price</th>
			<th class=colhead>Status</th>
		</tr>
		##TP_LOOP price_idx {[tpGetVar NumPrices]}##
		<tr>
			##TP_IF {[op_allowed ManageEvOc]}##
				<td><a href="##TP_CGI_URL##?action=ADMIN::SELN::GoOcPrice&OcPriceId=##TP_OcPrId##">##TP_OcPrDate##</a></td>
			##TP_ELSE##
				<td>##TP_OcPrDate##</td>
			##TP_ENDIF##
			<td>##TP_OcPr##</td>
			<td>
			<script>
			write_which("##TP_OcPrStatus##",'A','OK','X','Deleted','1','First Show','2','Second Show');
			</script>
			</td>
		</tr>
		##TP_ENDLOOP##
		</table>
	##TP_ENDIF##
##TP_ENDIF##
</body>
</html>

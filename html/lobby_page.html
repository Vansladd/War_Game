<!DOCTYPE html>
<html>
	<head>
		<title>Lobby Page</title>
	</head>
    <body>
        <div id="lobbies"></div>
    </body>

</html>

<script>
    async function display_lobbies(json){
        //var json = {"roomid": ["3","4"], "starting_money": [50,78], "user": ["Ben","Paul"]}; //this function will get and display all lobbies from a json file

        document.getElementById("lobbies").innerHTML = ""; //refresh the lobbies
        for(i = 0; i < json["roomid"].length; i++){
            document.getElementById("lobbies").innerHTML+= "<p>Room " + json["roomid"][i] + "</p>"; //displays the room number
            document.getElementById("lobbies").innerHTML+= "<p>User: " + json["user"][i] + "</p>"; //displays the user in the room
            document.getElementById("lobbies").innerHTML+= "<p>Starting Money: " + json["starting_money"][i].toString() + "</p>"; //adds the starting money in the room
            document.getElementById("lobbies").innerHTML+= '<a href="##TP_CGI_URL##?action=WAR_GAME_waiting_room&userid=##TP_userid##&roomid=' + json["roomid"][i] + '">Join<a>'; //creates link to lobby
            document.getElementById("lobbies").innerHTML+= "<br><br>"
        }
    }

    //get_lobbies();

    function get_lobbies(){
        fetch('##TP_CGI_URL##?action=WAR_GAME_lobby_rooms') //gets json from url
        .then(response => response.text())
        .then(text => display_lobbies(JSON.parse(text)))
    }

    get_lobbies()
    setInterval(get_lobbies(), 1000); //updates data every one second

</script>